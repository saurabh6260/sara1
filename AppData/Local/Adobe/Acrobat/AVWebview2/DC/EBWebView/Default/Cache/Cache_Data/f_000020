(()=>{"use strict";var e={673:function(e,t){var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ProblemTypes=void 0,(i=t.ProblemTypes||(t.ProblemTypes={})).ACCESS_DENIED="http://ns.adobe.com/adobecloud/problem/accessdenied",i.ASSET_LOCKED="http://ns.adobe.com/adobecloud/problem/assetlocked",i.ASSET_MOVED="http://ns.adobe.com/adobecloud/problem/assetmoved",i.ASSET_NAME_CONFLICT="http://ns.adobe.com/adobecloud/problem/assetnameconflict",i.ASSET_NAME_INVALID="http://ns.adobe.com/adobecloud/problem/assetnamenotvalid",i.ASSET_NOT_FOUND="http://ns.adobe.com/adobecloud/problem/assetnotfound",i.ASSET_STATE_NOT_ALLOWED="http://ns.adobe.com/adobecloud/problem/assetstatenotallowed",i.BAD_REQUEST="http://ns.adobe.com/adobecloud/problem/badrequest",i.BULK_REQUEST_NOT_ATTEMPTED="http://ns.adobe.com/adobecloud/problem/bulkrequestnotattempted",i.COMPOSITE_INTEGRITY="http://ns.adobe.com/adobecloud/problem/compositeintegrity",i.DCX_VALIDATION="http://ns.adobe.com/adobecloud/problem/dcxvalidation",i.DIRECTORY_NOT_EMPTY="http://ns.adobe.com/adobecloud/problem/directorynotempty",i.EMBED_INVALID="http://ns.adobe.com/adobecloud/problem/embedinvalid",i.EMBED_TOO_LARGE="http://ns.adobe.com/adobecloud/problem/embedtoolarge",i.ENCRYPTION_KEY_INACCESSIBLE="http://ns.adobe.com/adobecloud/problem/encryptionkeyinaccessible",i.INVALID_FRAGMENT="http://ns.adobe.com/adobecloud/problem/invalidfragment",i.LIMIT_CHILDREN_COUNT="http://ns.adobe.com/adobecloud/problem/limit/childrencount",i.LIMIT_COMPONENT_COUNT="http://ns.adobe.com/adobecloud/problem/limit/componentcount",i.LIMIT_EMBED_SELECTOR_COUNT="http://ns.adobe.com/adobecloud/problem/limit/embedspecifierselectorcount",i.LIMIT_MILESTONE_COUNT="http://ns.adobe.com/adobecloud/problem/limit/milestonecount",i.LIMIT_MILESTONE_LABEL_LENGTH="http://ns.adobe.com/adobecloud/problem/limit/milestonelabellength",i.LIMIT_NAME_LENGTH="http://ns.adobe.com/adobecloud/problem/limit/namelength",i.LIMIT_OPERATION_COUNT="http://ns.adobe.com/adobecloud/problem/limit/operationcount",i.LIMIT_PATH_SEGMENT_COUNT="http://ns.adobe.com/adobecloud/problem/limit/pathsegmentcount",i.LIMIT_RESOURCE_COUNT="http://ns.adobe.com/adobecloud/problem/limit/resourcecount",i.LIMIT_RESOURCE_SIZE="http://ns.adobe.com/adobecloud/problem/limit/resourcesize",i.NOT_ENTITLED="http://ns.adobe.com/adobecloud/problem/notentitled",i.OPERATION_FAILED="http://ns.adobe.com/adobecloud/problem/operationfailed",i.OPERATION_TARGET_CONFLICT="http://ns.adobe.com/adobecloud/problem/operation/targetconflict",i.QUOTA_EXCEEDED="http://ns.adobe.com/adobecloud/problem/quotaexceeded",i.REPOSITORY_NOT_FOUND="http://ns.adobe.com/adobecloud/problem/repositorynotfound",i.RESOURCE_BLOCKED="http://ns.adobe.com/adobecloud/problem/resourceblocked",i.RESOURCE_NOT_ALLOWED="http://ns.adobe.com/adobecloud/problem/resourcenotallowed",i.RESOURCE_NOT_FOUND="http://ns.adobe.com/adobecloud/problem/resourcenotfound",i.RESOURCE_NOT_READY="http://ns.adobe.com/adobecloud/problem/resourcenotready",i.RESPONSE_TOO_LARGE="http://ns.adobe.com/adobecloud/problem/responsetoolarge",i.USER_BLOCKED="http://ns.adobe.com/adobecloud/problem/userblocked",i.VERSION_NOT_FOUND="http://ns.adobe.com/adobecloud/problem/versionnotfound",i.PARTIAL_ASSET="http://ns.adobe.com/adobecloud/problem/partialasset";let r={ASSET_MOVED:"ASSET_MOVED",INVALID_JSON:"INVALID_JSON",READ_ONLY:"READ_ONLY",INVALID_PARAMS:"",INVALID_LINKS:"INVALID_LINKS",PRECONDITION_FAILED:"PRECONDITION_FAILED",INVALID_DATA:"INVALID_DATA",DUPLICATE_VALUE:"DUPLICATE_VALUE",NO_BASE_BRANCH_DATA:"NO_BASE_BRANCH_DATA",INVALID_STATE:"INVALID_STATE",DELETED_COMPOSITE:"DELETED_COMPOSITE",INCOMPLETE_COMPOSITE:"INCOMPLETE_COMPOSITE",UNEXPECTED_RESPONSE:"UNEXPECTED_RESPONSE",NETWORK_ERROR:"NETWORK_ERROR",COMPONENT_DOWNLOAD_ERROR:"COMPONENT_DOWNLOAD_ERROR",COMPONENT_UPLOAD_ERROR:"COMPONENT_UPLOAD_ERROR",COMPONENT_MODIFIED_ERROR:"COMPONENT_MODIFIED_ERROR",UPDATE_CONFLICT:"UPDATE_CONFLICT",NO_COMPOSITE:"NO_COMPOSITE",ALREADY_EXISTS:"ALREADY_EXISTS",SERVICE_IS_INACTIVE:"SERVICE_IS_INACTIVE",EXCEEDS_QUOTA:"EXCEEDS_QUOTA",NOT_IMPLEMENTED:"NOT_IMPLEMENTED",RETRYABLE_SERVER_ERROR:"RETRYABLE_SERVER_ERROR",TIMED_OUT:"TIMED_OUT",UNEXPECTED:"UNEXPECTED",TERMINATED_INPUTSTREAM:"TERMINATED_INPUTSTREAM",WRONG_ENDPOINT:"WRONG_ENDPOINT",OUT_OF_SPACE:"ENOSPC",FILE_EXISTS_IN_CLOUD:"FILE_EXISTS_IN_CLOUD",ASSET_NOT_FOUND:"ASSET_NOT_FOUND",COMPOSITE_NOT_FOUND:"COMPOSITE_NOT_FOUND",NOT_FOUND:"NOT_FOUND",UNAUTHORIZED:"UNAUTHORIZED",FORBIDDEN:"FORBIDDEN",METHOD_NOT_ALLOWED:"METHOD_NOT_ALLOWED",NOT_ACCEPTABLE:"NOT_ACCEPTABLE",BANDWIDTH_LIMIT_EXCEEDED:"BANDWIDTH_LIMIT_EXCEEDED",ABORTED:"ABORTED",TOO_MANY_REDIRECTS:"TOO_MANY_REDIRECTS",INSECURE_REDIRECT:"INSECURE_REDIRECT",RESOURCE_NOT_READY:"RESOURCE_NOT_READY"},s={[r.SERVICE_IS_INACTIVE]:!0,[r.ABORTED]:!0,[r.INSECURE_REDIRECT]:!0,[r.TOO_MANY_REDIRECTS]:!0,[r.NOT_IMPLEMENTED]:!0,[r.EXCEEDS_QUOTA]:!0,[r.RETRYABLE_SERVER_ERROR]:!0,[r.TIMED_OUT]:!0,[r.TERMINATED_INPUTSTREAM]:!0,[r.WRONG_ENDPOINT]:!0,[r.OUT_OF_SPACE]:!0,[r.INVALID_PARAMS]:!0,[r.INVALID_STATE]:!0};class o extends Error{constructor(e,t,i,r,s){var a;if(super(),this.code=e,this.name="AdobeDCXError",this._additionalData={},"application/problem+json"===(null==(a=null==r?void 0:r.headers)?void 0:a["content-type"])&&r.response&&"object"==typeof r.response&&"function"==typeof r.response.slice)try{let e=JSON.parse(new TextDecoder("utf-8").decode(r.response));r.response=e}catch(t){let e=r.response;r.response={originalBody:e,message:"Failed to parse JSON problem type response body.",parseError:t}}if(i instanceof Error&&(this._underlyingError=i),this._response=r||(n(i)?i.response:void 0),this._additionalData=s,this._message=t,this.message=("string"==typeof e&&""!==e?"["+e+"] ":"")+(this._message||""),Object.setPrototypeOf(this,o.prototype),Error.captureStackTrace)Error.captureStackTrace(this,o);else try{let e=Error();if(e.name=this.name,e.stack){let t=e.stack.split("\n");t.length>0&&t.splice(1,1),this.stack=t.join("\n")}}catch(e){}}get response(){return this._response}get problemType(){var e;if("application/problem+json"===(null==(e=this._response)?void 0:e.headers["content-type"]))return this._response.response.type}get underlyingError(){return this._underlyingError}get additionalData(){return this._additionalData}set additionalData(e){this._additionalData=e}get failedComponents(){return this._additionalData.failedComponents}static wrapError(e,i,n,a){var l,c,u,d;if(n&&s[n.code])return n;if(a&&"object"==typeof a){let s=a.statusCode,h=403===s&&("403.1"===(null==(u=null==(c=null==(l=a.response)?void 0:l.message)?void 0:c.match(/code=(\d+.\d+)/))?void 0:u[1])||(null==(d=a.response)?void 0:d.type)===t.ProblemTypes.QUOTA_EXCEEDED);if(s>=500&&s<600||h)501===s?(e=r.NOT_IMPLEMENTED,i="Unimplemented request"):507===s||h?(e=r.EXCEEDS_QUOTA,i="Quota exceeded"):(e=r.RETRYABLE_SERVER_ERROR,i="Server error");else if(n instanceof o&&e===n.code&&n.code===this.UNEXPECTED_RESPONSE)return n}return new o(e,i,n,a)}toString(){return`${this.name}: ${this.message}`}static networkError(e,t,i){return o.wrapError(r.NETWORK_ERROR,e,t,i)}static unexpectedResponse(e,t,i){return o.wrapError(r.UNEXPECTED_RESPONSE,e,t,i)}}function n(e){return!(!e||"object"!=typeof e)&&"AdobeDCXError"===e.name}o.ABORTED=r.ABORTED,o.INSECURE_REDIRECT=r.INSECURE_REDIRECT,o.TOO_MANY_REDIRECTS=r.TOO_MANY_REDIRECTS,o.INVALID_JSON=r.INVALID_JSON,o.READ_ONLY=r.READ_ONLY,o.INVALID_PARAMS=r.INVALID_PARAMS,o.INVALID_DATA=r.INVALID_DATA,o.DUPLICATE_VALUE=r.DUPLICATE_VALUE,o.NO_BASE_BRANCH_DATA=r.NO_BASE_BRANCH_DATA,o.INVALID_STATE=r.INVALID_STATE,o.DELETED_COMPOSITE=r.DELETED_COMPOSITE,o.INCOMPLETE_COMPOSITE=r.INCOMPLETE_COMPOSITE,o.UNEXPECTED_RESPONSE=r.UNEXPECTED_RESPONSE,o.NETWORK_ERROR=r.NETWORK_ERROR,o.COMPONENT_DOWNLOAD_ERROR=r.COMPONENT_DOWNLOAD_ERROR,o.COMPONENT_UPLOAD_ERROR=r.COMPONENT_UPLOAD_ERROR,o.COMPONENT_MODIFIED_ERROR=r.COMPONENT_MODIFIED_ERROR,o.UPDATE_CONFLICT=r.UPDATE_CONFLICT,o.NO_COMPOSITE=r.NO_COMPOSITE,o.ALREADY_EXISTS=r.ALREADY_EXISTS,o.SERVICE_IS_INACTIVE=r.SERVICE_IS_INACTIVE,o.EXCEEDS_QUOTA=r.EXCEEDS_QUOTA,o.NOT_IMPLEMENTED=r.NOT_IMPLEMENTED,o.RETRYABLE_SERVER_ERROR=r.RETRYABLE_SERVER_ERROR,o.TIMED_OUT=r.TIMED_OUT,o.UNEXPECTED=r.UNEXPECTED,o.TERMINATED_INPUTSTREAM=r.TERMINATED_INPUTSTREAM,o.WRONG_ENDPOINT=r.WRONG_ENDPOINT,o.OUT_OF_SPACE=r.OUT_OF_SPACE,o.FILE_EXISTS_IN_CLOUD=r.FILE_EXISTS_IN_CLOUD,o.ASSET_NOT_FOUND=r.ASSET_NOT_FOUND,o.COMPOSITE_NOT_FOUND=r.COMPOSITE_NOT_FOUND,o.NOT_FOUND=r.NOT_FOUND,o.UNAUTHORIZED=r.UNAUTHORIZED,o.FORBIDDEN=r.FORBIDDEN,o.PRECONDITION_FAILED=r.PRECONDITION_FAILED,o.RESOURCE_NOT_READY=r.RESOURCE_NOT_READY;let a=new Map([[400,{code:r.UNEXPECTED_RESPONSE,message:"Bad request"}],[401,{code:r.UNAUTHORIZED,message:"Unauthorized"}],[403,{code:r.FORBIDDEN,message:"Forbidden"}],[404,{code:r.NOT_FOUND,message:"Not found"}],[405,{code:r.METHOD_NOT_ALLOWED,message:"The user is authorized to act on this resource, but cannot use the specified method."}],[406,{code:r.NOT_ACCEPTABLE,message:"Unable to obtain resource in a content type matching the Accept header or rendition type parameter."}],[409,{code:r.ALREADY_EXISTS,message:"Already exists"}],[412,{code:r.PRECONDITION_FAILED,message:"Precondition failed"}],[501,{code:r.NOT_IMPLEMENTED,message:"Not implemented"}],[507,{code:r.EXCEEDS_QUOTA,message:"Exceeds quota"}],[509,{code:r.BANDWIDTH_LIMIT_EXCEEDED,message:"Bandwidth limit exceeded"}]]),l=new Map(Object.entries({[t.ProblemTypes.ASSET_MOVED]:{code:r.ASSET_MOVED,message:"Asset moved to a different region while operation was in progress"},[t.ProblemTypes.COMPOSITE_INTEGRITY]:{code:r.INCOMPLETE_COMPOSITE,message:"Incomplete composite. invoke missingComponentsFromError with this error for more information."},[t.ProblemTypes.PARTIAL_ASSET]:{code:r.NO_COMPOSITE,message:"Asset is partially created. No Manifest found"}})),c=e=>{var t,i;let r=l.get(null!=(i=null==(t=e.response)?void 0:t.type)?i:"")||a.get(e.statusCode);return r?new o(r.code,r.message,void 0,e,e.response):void 0},u=(e,t)=>e&&t?e<300&&e>199||c(t)||!1:new o(r.NETWORK_ERROR,"Invalid or missing status code or response",void 0,t);t.AdobeDCXError=o,t.DCXError=o,t.ErrorCodes=r,t.HTTP_STATUS_ERROR_MAP=a,t._defaultStatusValidator=u,t._handleErrorResponsePayload=function(e){let t=Array.isArray(e.response)?e.response.reduce((e,t)=>e||t.error,void 0):e.response.error;if(!t)return e;let i=u(t.status,e);if(i instanceof o)throw i;throw new o(t.type||o.UNEXPECTED_RESPONSE,t.title||"Unexpected Error",t,e)},t._responseToError=c,t.default=o,t.isAdobeDCXError=n,t.networkError=function(e,t,i){return o.networkError(e,t,i)},t.unexpectedResponse=function(e,t,i){return o.unexpectedResponse(e,t,i)}},311:function(){try{self["workbox:core:6.5.3"]&&_()}catch(e){}},955:function(){try{self["workbox:precaching:6.5.3"]&&_()}catch(e){}},91:function(){try{self["workbox:routing:6.5.3"]&&_()}catch(e){}},63:function(){try{self["workbox:strategies:6.5.3"]&&_()}catch(e){}}},t={};function i(r){var s=t[r];if(void 0!==s)return s.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,i),o.exports}i.g=(()=>{if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}})(),(()=>{let e,t,r;i(311);class s extends Error{constructor(e,t){super(((e,...t)=>{let i=e;return t.length>0&&(i+=` :: ${JSON.stringify(t)}`),i})(e,t)),this.name=e,this.details=t}}let o=new Set,n={googleAnalytics:"googleAnalytics",precache:"precache-v2",prefix:"workbox",runtime:"runtime",suffix:"undefined"!=typeof registration?registration.scope:""},a=e=>[n.prefix,e,n.suffix].filter(e=>e&&e.length>0).join("-"),l={updateDetails:e=>{var t=t=>{"string"==typeof e[t]&&(n[t]=e[t])};for(let e of Object.keys(n))t(e)},getPrecacheName:e=>e||a(n.precache),getRuntimeName:e=>e||a(n.runtime)};function c(e,t){let i=new URL(e);for(let e of t)i.searchParams.delete(e);return i.href}async function u(e,t,i,r){let s=c(t.url,i);if(t.url===s)return e.match(t,r);let o=Object.assign(Object.assign({},r),{ignoreSearch:!0});for(let n of(await e.keys(t,o)))if(s===c(n.url,i))return e.match(n,r)}class d{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}async function h(){for(let e of o)await e()}function g(e,t){let i=t();return e.waitUntil(i),i}async function E(t,i){let r=null;if(t.url&&(r=new URL(t.url).origin),r!==self.location.origin)throw new s("cross-origin-copy-response",{origin:r});let o=t.clone(),n={headers:new Headers(o.headers),status:o.status,statusText:o.statusText},a=i?i(n):n,l=!function(){if(void 0===e){let t=new Response("");if("body"in t)try{new Response(t.body),e=!0}catch(t){e=!1}e=!1}return e}()?await o.blob():o.body;return new Response(l,a)}i(955);class p{constructor(){this.updatedURLs=[],this.notUpdatedURLs=[],this.handlerWillStart=async({request:e,state:t})=>{t&&(t.originalRequest=e)},this.cachedResponseWillBeUsed=async({event:e,state:t,cachedResponse:i})=>{if("install"===e.type&&t&&t.originalRequest&&t.originalRequest instanceof Request){let e=t.originalRequest.url;i?this.notUpdatedURLs.push(e):this.updatedURLs.push(e)}return i}}}class f{constructor({precacheController:e}){this.cacheKeyWillBeUsed=async({request:e,params:t})=>{let i=(null==t?void 0:t.cacheKey)||this._precacheController.getCacheKeyForURL(e.url);return i?new Request(i,{headers:e.headers}):e},this._precacheController=e}}function m(e){return"string"==typeof e?new Request(e):e}i(63);class T{constructor(e,t){for(let i of(this._cacheKeys={},Object.assign(this,t),this.event=t.event,this._strategy=e,this._handlerDeferred=new d,this._extendLifetimePromises=[],this._plugins=[...e.plugins],this._pluginStateMap=new Map,this._plugins))this._pluginStateMap.set(i,{});this.event.waitUntil(this._handlerDeferred.promise)}async fetch(e){let{event:t}=this,i=m(e);if("navigate"===i.mode&&t instanceof FetchEvent&&t.preloadResponse){let e=await t.preloadResponse;if(e)return e}let r=this.hasCallback("fetchDidFail")?i.clone():null;try{for(let e of this.iterateCallbacks("requestWillFetch"))i=await e({request:i.clone(),event:t})}catch(e){if(e instanceof Error)throw new s("plugin-error-request-will-fetch",{thrownErrorMessage:e.message})}let o=i.clone();try{let e;for(let r of(e=await fetch(i,"navigate"===i.mode?void 0:this._strategy.fetchOptions),this.iterateCallbacks("fetchDidSucceed")))e=await r({event:t,request:o,response:e});return e}catch(e){throw r&&await this.runCallbacks("fetchDidFail",{error:e,event:t,originalRequest:r.clone(),request:o.clone()}),e}}async fetchAndCachePut(e){let t=await this.fetch(e),i=t.clone();return this.waitUntil(this.cachePut(e,i)),t}async cacheMatch(e){let t,i=m(e),{cacheName:r,matchOptions:s}=this._strategy,o=await this.getCacheKey(i,"read"),n=Object.assign(Object.assign({},s),{cacheName:r});for(let e of(t=await caches.match(o,n),this.iterateCallbacks("cachedResponseWillBeUsed")))t=await e({cacheName:r,matchOptions:s,cachedResponse:t,request:o,event:this.event})||void 0;return t}async cachePut(e,t){let i=m(e);await new Promise(e=>setTimeout(e,0));let r=await this.getCacheKey(i,"write");if(!t)throw new s("cache-put-with-no-response",{url:new URL(String(r.url),location.href).href.replace(RegExp(`^${location.origin}`),"")});let o=await this._ensureResponseSafeToCache(t);if(!o)return!1;let{cacheName:n,matchOptions:a}=this._strategy,l=await self.caches.open(n),c=this.hasCallback("cacheDidUpdate"),d=c?await u(l,r.clone(),["__WB_REVISION__"],a):null;try{await l.put(r,c?o.clone():o)}catch(e){if(e instanceof Error)throw"QuotaExceededError"===e.name&&await h(),e}for(let e of this.iterateCallbacks("cacheDidUpdate"))await e({cacheName:n,oldResponse:d,newResponse:o.clone(),request:r,event:this.event});return!0}async getCacheKey(e,t){let i=`${e.url} | ${t}`;if(!this._cacheKeys[i]){let r=e;for(let e of this.iterateCallbacks("cacheKeyWillBeUsed"))r=m(await e({mode:t,request:r,event:this.event,params:this.params}));this._cacheKeys[i]=r}return this._cacheKeys[i]}hasCallback(e){for(let t of this._strategy.plugins)if(e in t)return!0;return!1}async runCallbacks(e,t){for(let i of this.iterateCallbacks(e))await i(t)}*iterateCallbacks(e){for(let t of this._strategy.plugins)if("function"==typeof t[e]){let i=this._pluginStateMap.get(t),r=r=>{let s=Object.assign(Object.assign({},r),{state:i});return t[e](s)};yield r}}waitUntil(e){return this._extendLifetimePromises.push(e),e}async doneWaiting(){let e;for(;e=this._extendLifetimePromises.shift();)await e}destroy(){this._handlerDeferred.resolve(null)}async _ensureResponseSafeToCache(e){let t=e,i=!1;for(let e of this.iterateCallbacks("cacheWillUpdate"))if(t=await e({request:this.request,response:t,event:this.event})||void 0,i=!0,!t)break;return!i&&t&&200!==t.status&&(t=void 0),t}}class O{constructor(e={}){this.cacheName=l.getRuntimeName(e.cacheName),this.plugins=e.plugins||[],this.fetchOptions=e.fetchOptions,this.matchOptions=e.matchOptions}handle(e){let[t]=this.handleAll(e);return t}handleAll(e){e instanceof FetchEvent&&(e={event:e,request:e.request});let t=e.event,i="string"==typeof e.request?new Request(e.request):e.request,r=new T(this,{event:t,request:i,params:"params"in e?e.params:void 0}),s=this._getResponse(r,i,t),o=this._awaitComplete(s,r,i,t);return[s,o]}async _getResponse(e,t,i){let r;await e.runCallbacks("handlerWillStart",{event:i,request:t});try{if(!(r=await this._handle(t,e))||"error"===r.type)throw new s("no-response",{url:t.url})}catch(s){if(s instanceof Error){for(let o of e.iterateCallbacks("handlerDidError"))if(r=await o({error:s,event:i,request:t}))break}if(r);else throw s}for(let s of e.iterateCallbacks("handlerWillRespond"))r=await s({event:i,request:t,response:r});return r}async _awaitComplete(e,t,i,r){let s,o;try{s=await e}catch(e){}try{await t.runCallbacks("handlerDidRespond",{event:r,request:i,response:s}),await t.doneWaiting()}catch(e){e instanceof Error&&(o=e)}if(await t.runCallbacks("handlerDidComplete",{event:r,request:i,response:s,error:o}),t.destroy(),o)throw o}}class S extends O{constructor(e={}){e.cacheName=l.getPrecacheName(e.cacheName),super(e),this._fallbackToNetwork=!1!==e.fallbackToNetwork,this.plugins.push(S.copyRedirectedCacheableResponsesPlugin)}async _handle(e,t){let i=await t.cacheMatch(e);return i||(t.event&&"install"===t.event.type?await this._handleInstall(e,t):await this._handleFetch(e,t))}async _handleFetch(e,t){let i,r=t.params||{};if(this._fallbackToNetwork){let s=r.integrity,o=e.integrity,n=!o||o===s;i=await t.fetch(new Request(e,{integrity:"no-cors"!==e.mode?o||s:void 0})),s&&n&&"no-cors"!==e.mode&&(this._useDefaultCacheabilityPluginIfNeeded(),await t.cachePut(e,i.clone()))}else throw new s("missing-precache-entry",{cacheName:this.cacheName,url:e.url});return i}async _handleInstall(e,t){this._useDefaultCacheabilityPluginIfNeeded();let i=await t.fetch(e);if(!await t.cachePut(e,i.clone()))throw new s("bad-precaching-response",{url:e.url,status:i.status});return i}_useDefaultCacheabilityPluginIfNeeded(){let e=null,t=0;for(let[i,r]of this.plugins.entries())r!==S.copyRedirectedCacheableResponsesPlugin&&(r===S.defaultPrecacheCacheabilityPlugin&&(e=i),r.cacheWillUpdate&&t++);0===t?this.plugins.push(S.defaultPrecacheCacheabilityPlugin):t>1&&null!==e&&this.plugins.splice(e,1)}}S.defaultPrecacheCacheabilityPlugin={cacheWillUpdate:async({response:e})=>!e||e.status>=400?null:e},S.copyRedirectedCacheableResponsesPlugin={cacheWillUpdate:async({response:e})=>e.redirected?await E(e):e};class C{constructor({cacheName:e,plugins:t=[],fallbackToNetwork:i=!0}={}){this._urlsToCacheKeys=new Map,this._urlsToCacheModes=new Map,this._cacheKeysToIntegrities=new Map,this._strategy=new S({cacheName:l.getPrecacheName(e),plugins:[...t,new f({precacheController:this})],fallbackToNetwork:i}),this.install=this.install.bind(this),this.activate=this.activate.bind(this)}get strategy(){return this._strategy}precache(e){this.addToCacheList(e),this._installAndActiveListenersAdded||(self.addEventListener("install",this.install),self.addEventListener("activate",this.activate),this._installAndActiveListenersAdded=!0)}addToCacheList(e){let t=[];for(let i of e){"string"==typeof i?t.push(i):i&&void 0===i.revision&&t.push(i.url);let{cacheKey:e,url:r}=function(e){if(!e)throw new s("add-to-cache-list-unexpected-type",{entry:e});if("string"==typeof e){let t=new URL(e,location.href);return{cacheKey:t.href,url:t.href}}let{revision:t,url:i}=e;if(!i)throw new s("add-to-cache-list-unexpected-type",{entry:e});if(!t){let e=new URL(i,location.href);return{cacheKey:e.href,url:e.href}}let r=new URL(i,location.href),o=new URL(i,location.href);return r.searchParams.set("__WB_REVISION__",t),{cacheKey:r.href,url:o.href}}(i),o="string"!=typeof i&&i.revision?"reload":"default";if(this._urlsToCacheKeys.has(r)&&this._urlsToCacheKeys.get(r)!==e)throw new s("add-to-cache-list-conflicting-entries",{firstEntry:this._urlsToCacheKeys.get(r),secondEntry:e});if("string"!=typeof i&&i.integrity){if(this._cacheKeysToIntegrities.has(e)&&this._cacheKeysToIntegrities.get(e)!==i.integrity)throw new s("add-to-cache-list-conflicting-integrities",{url:r});this._cacheKeysToIntegrities.set(e,i.integrity)}this._urlsToCacheKeys.set(r,e),this._urlsToCacheModes.set(r,o),t.length>0&&console.warn(`Workbox is precaching URLs without revision info: ${t.join(", ")}
This is generally NOT safe. Learn more at https://bit.ly/wb-precache`)}}install(e){return g(e,async()=>{let t=new p;for(let[i,r]of(this.strategy.plugins.push(t),this._urlsToCacheKeys)){let t=this._cacheKeysToIntegrities.get(r),s=this._urlsToCacheModes.get(i),o=new Request(i,{integrity:t,cache:s,credentials:"same-origin"});await Promise.all(this.strategy.handleAll({params:{cacheKey:r},request:o,event:e}))}let{updatedURLs:i,notUpdatedURLs:r}=t;return{updatedURLs:i,notUpdatedURLs:r}})}activate(e){return g(e,async()=>{let e=await self.caches.open(this.strategy.cacheName),t=await e.keys(),i=new Set(this._urlsToCacheKeys.values()),r=[];for(let s of t)i.has(s.url)||(await e.delete(s),r.push(s.url));return{deletedURLs:r}})}getURLsToCacheKeys(){return this._urlsToCacheKeys}getCachedURLs(){return[...this._urlsToCacheKeys.keys()]}getCacheKeyForURL(e){let t=new URL(e,location.href);return this._urlsToCacheKeys.get(t.href)}getIntegrityForCacheKey(e){return this._cacheKeysToIntegrities.get(e)}async matchPrecache(e){let t=e instanceof Request?e.url:e,i=this.getCacheKeyForURL(t);if(i)return(await self.caches.open(this.strategy.cacheName)).match(i)}createHandlerBoundToURL(e){let t=this.getCacheKeyForURL(e);if(!t)throw new s("non-precached-url",{url:e});return i=>(i.request=new Request(e),i.params=Object.assign({cacheKey:t},i.params),this.strategy.handle(i))}}let v=()=>(t||(t=new C),t);i(91);let y=e=>e&&"object"==typeof e?e:{handle:e};class R{constructor(e,t,i="GET"){this.handler=y(t),this.match=e,this.method=i}setCatchHandler(e){this.catchHandler=y(e)}}class A extends R{constructor(e,t,i){super(({url:t})=>{let i=e.exec(t.href);if(i)return t.origin!==location.origin&&0!==i.index?void 0:i.slice(1)},t,i)}}class w{constructor(){this._routes=new Map,this._defaultHandlerMap=new Map}get routes(){return this._routes}addFetchListener(){self.addEventListener("fetch",e=>{let{request:t}=e,i=this.handleRequest({request:t,event:e});i&&e.respondWith(i)})}addCacheListener(){self.addEventListener("message",e=>{if(e.data&&"CACHE_URLS"===e.data.type){let{payload:t}=e.data,i=Promise.all(t.urlsToCache.map(t=>{"string"==typeof t&&(t=[t]);let i=new Request(...t);return this.handleRequest({request:i,event:e})}));e.waitUntil(i),e.ports&&e.ports[0]&&i.then(()=>e.ports[0].postMessage(!0))}})}handleRequest({request:e,event:t}){let i,r=new URL(e.url,location.href);if(!r.protocol.startsWith("http"))return;let s=r.origin===location.origin,{params:o,route:n}=this.findMatchingRoute({event:t,request:e,sameOrigin:s,url:r}),a=n&&n.handler,l=e.method;if(!a&&this._defaultHandlerMap.has(l)&&(a=this._defaultHandlerMap.get(l)),!a)return;try{i=a.handle({url:r,request:e,event:t,params:o})}catch(e){i=Promise.reject(e)}let c=n&&n.catchHandler;return i instanceof Promise&&(this._catchHandler||c)&&(i=i.catch(async i=>{if(c)try{return await c.handle({url:r,request:e,event:t,params:o})}catch(e){e instanceof Error&&(i=e)}if(this._catchHandler)return this._catchHandler.handle({url:r,request:e,event:t});throw i})),i}findMatchingRoute({url:e,sameOrigin:t,request:i,event:r}){for(let s of this._routes.get(i.method)||[]){let o,n=s.match({url:e,sameOrigin:t,request:i,event:r});if(n)return Array.isArray(o=n)&&0===o.length||n.constructor===Object&&0===Object.keys(n).length?o=void 0:"boolean"==typeof n&&(o=void 0),{route:s,params:o}}return{}}setDefaultHandler(e,t="GET"){this._defaultHandlerMap.set(t,y(e))}setCatchHandler(e){this._catchHandler=y(e)}registerRoute(e){this._routes.has(e.method)||this._routes.set(e.method,[]),this._routes.get(e.method).push(e)}unregisterRoute(e){if(!this._routes.has(e.method))throw new s("unregister-route-but-not-found-with-method",{method:e.method});let t=this._routes.get(e.method).indexOf(e);if(t>-1)this._routes.get(e.method).splice(t,1);else throw new s("unregister-route-route-not-registered")}}class I extends R{constructor(e,t){super(({request:i})=>{let r=e.getURLsToCacheKeys();for(let s of function*(e,{ignoreURLParametersMatching:t=[/^utm_/,/^fbclid$/],directoryIndex:i="index.html",cleanURLs:r=!0,urlManipulation:s}={}){let o=new URL(e,location.href);o.hash="",yield o.href;let n=function(e,t=[]){for(let i of[...e.searchParams.keys()])t.some(e=>e.test(i))&&e.searchParams.delete(i);return e}(o,t);if(yield n.href,i&&n.pathname.endsWith("/")){let e=new URL(n.href);e.pathname+=i,yield e.href}if(r){let e=new URL(n.href);e.pathname+=".html",yield e.href}if(s)for(let e of s({url:o}))yield e.href}(i.url,t)){let t=r.get(s);if(t){let i=e.getIntegrityForCacheKey(t);return{cacheKey:t,integrity:i}}}},e.strategy)}}let N="-precache-",b=async(e,t=N)=>{let i=(await self.caches.keys()).filter(i=>i.includes(t)&&i.includes(self.registration.scope)&&i!==e);return await Promise.all(i.map(e=>self.caches.delete(e))),i};var U,D,L=function(e){return e.FORCE_RELOAD_CLIENTS="force-reload-clients",e.RELOAD_CLIENT="reload-client",e.RESOURCE_INFO_REQUEST="RESOURCE_INFO_REQUEST",e.RESOURCE_INFO_REPLY="RESOURCE_INFO_REPLY",e}({});let P=[/ds.*\.adobe\.io/,/.*\.adobelivecreate\.com/,/cchome.*\.adobe\.io/,/.*\.adobe\.com\/service\/cctypekit/,/.*\.adobe\.com\/service\/faster-typekit/,/.*\.adobe\.com\/service\/use-fonts/,/.*\.adobe\.com\/service\/font-services/,/.*\.adobe\.com\/service\/font/,/.*\.adobe\.com\/service\/byof/,/.*\.adobe\.com\/service\/api-cdn/],M="not_in_ape_session",F={INGEST_TYPE:"dunamis",ENVIRONMENT_PROD:"prod",WORKFLOW_DEBUG:"Debug",PAYLOAD_FROM_WORKER:"payloadFromWorker",LOG_LEVEL_ERROR:"error",NOT_SPECIFIED:"Not Specified"},x={TIME_START:"timeStart",TIME_END:"timeEnd",IS_FAILURE:"isFailure"};var k=function(e){return e.USER_SERVICE_CODE="user.service_code",e.USER_SERVICE_LEVEL="user.service_level",e.USER_ACCOUNT_TYPE="hz.user.account_type",e.EVENT_PKG_INGEST_TYPE="ingesttype",e.EVENT_PKG_PROJECT="project",e.EVENT_PKG_TIME="time",e.EVENT_PKG_ENVIRONMENT="environment",e.EVENT_PKG_DATA="data",e.OVERRIDE_PKG_PROJECT="override.ingest.project",e.EVENT_PAGENAME="event.pagename",e.EVENT_GUID="event.guid",e.EVENT_USER_AGENT="event.user_agent",e.EVENT_URL="event.url",e.EVENT_THREAD="custom.thread",e.EVENT_SOURCE="custom.source",e.EVENT_STATUS="custom.eventStatus",e.EVENT_INSTRUMENTATION_TYPE="custom.instrumentationType",e.EVENT_INSTRUMENTATION_FLAG="custom.instrumentationFlag",e.EVENT_FEATURE_NAME="custom.eventFeatureName",e.EVENT_FEATURE_FLOW_STATE="custom.eventFeatureFlowState",e.EVENT_MODIFIERS="custom.modifiers",e.EVENT_SOURCE_CLIENT_ID="source.client_id",e.EVENT_SOURCE_NAME="source.name",e.EVENT_SOURCE_VERSION="source.version",e.EVENT_MOBILE_APP_VERSION="hz.mobile_app_version",e.EVENT_NETWORK_TYPE="hz.network_type",e.EVENT_BUILD="event.build",e.EVENT_BUILD_BRANCH="custom.buildBranch",e.EVENT_BUNDLE_HASH="hz.event.bundle_hash",e.EVENT_OVERRIDES_CONFIGURATION_HASH="hz.event.overrides_configuration_hash",e.APP_CONFIG_OVERRIDES="custom.app_config_overrides",e.EVENT_ENVIRONMENT="custom.envName",e.EVENT_ENVIRONMENT_TYPE="custom.env",e.ENV_FW_NAME="env.fw.name",e.CUSTOM_EDITOR_IS_FOCUS_MODE="custom.editor.is_focus_mode",e.EVENT_CATEGORY="event.category",e.EVENT_SUBCATEGORY="event.subcategory",e.EVENT_TYPE="event.type",e.EVENT_SUBTYPE="event.subtype",e.EVENT_COUNT="event.count",e.EVENT_ACTION_CATEGORY="custom.actionCategory",e.EVENT_ACTION_NAME="custom.actionName",e.EVENT_WORKFLOW="event.workflow",e.EVENT_TIME_START="event.dts_start",e.EVENT_TIME_END="event.dts_end",e.EVENT_VALUE="event.value",e.EVENT_DURATION="custom.duration",e.EVENT_AVG_FRAME_DURATION="custom.averageFrameDuration",e.EVENT_AVG_RENDER_DURATION="custom.averageRenderDuration",e.EVENT_AVG_AUTHORING_DURATION="custom.averageAuthoringDuration",e.EVENT_USER_GUID="event.user_guid",e.EVENT_PROFILE_GUID="event.profile_guid",e.EVENT_SESSION_ID="event.session_guid",e.EVENT_MCID_GUID="event.mcid_guid",e.EVENT_CONTEXT_GUID="event.context_guid",e.EVENT_LOCALE="event.language",e.DISPLAYED_LANGUAGE="custom.displayedLanguage",e.PROFILE_COUNTRY="hz.user.profile_country",e.ACCESS_COUNTRY="hz.user.access_country",e.PWA_INSTALLATION_SOURCE="custom.pwa.installation_source",e.EVENT_APE_STATUS="hz.event.ape_status",e.EVENT_APE_DURATION="hz.event.ape_duration",e.EVENT_APE_TIME_SINCE_LAST_EVENT="hz.event.ape_time_since_last_event",e.EVENT_APE_GUID="hz.event.ape_guid",e.APE_START_TIME="ape_start_time",e.APE_LAST_EVENT_TIME="ape_last_event_time",e.ENTITLEMENT_TYPE="custom.user.entitlement_type_express",e.GEN_AI_TOTAL_CREDITS="custom.user.gen_ai.total_credits",e.USER_COMPLIMENTARY_PREMIUM="custom.user.complimentary_premium",e.SESSION_RECORDING_URL="hz.session.recording_url",e.CONTEXT_USER_ROLE="custom.userRole",e.CONTEXT_WEBVIEW_ROLE="custom.webviewRole",e.CONTEXT_INIT="context.init",e.CONTEXT_GUID="context.guid",e.CONTEXT_PARAMS="context.params",e.EVENT_REFERRER="event.referrer",e.EVENT_ERROR_CODE="event.error_code",e.EVENT_ERROR_DESC="event.error_desc",e.EVENT_ERROR_TYPE="event.error_type",e.UI_VIEW_TYPE="ui.view_type",e.UI_SEARCH_KEYWORD="ui.search_keyword",e.CONTENT_ID="content.id",e.CONTENT_IS_REPLACED_WITH_LINKED_ASSET="content.is.replaced.with.linked.asset",e.CONTENT_NAME="content.name",e.CONTENT_TYPE="content.type",e.CONTENT_STATUS="content.status",e.CONTENT_DIMENSION="content.dimension",e.CONTENT_SIZE="content.size",e.CONTENT_MIMETYPE="content.mimetype",e.CONTENT_EXTENSION="content.extension",e.CONTENT_AUTHOR="content.author",e.CONTENT_CATEGORY="content.category",e.CONTENT_UI_TRIGGER="content.ui.trigger",e.CONTENT_COLLECTION="custom.ui.collection",e.CONTENT_COLLECTION_PATH="custom.ui.collection_path",e.CONTENT_SCHEMA_VERSION="custom.contentSchemaVersion",e.CONTENT_IS_NEW="custom.contentIsNew",e.CONTENT_PHOTO_CATEGORY="content.photo_category",e.LOG_TRACEFLOW_CATEGORY="custom.traceflow",e.LOG_TRACE_ID="custom.traceId",e.LOG_SPAN_ID="custom.spanId",e.LOG_MESSAGE="custom.message",e.LOG_LEVEL="custom.level",e.LOG_METADATA="custom.meta",e.ERROR_UUID="custom.errorUUID",e.ERROR_MESSAGE="custom.errorMessage",e.ERROR_CODE="custom.errorCode",e.ERROR_FULL_STACK="custom.fullStack",e.ERROR_FULL_MESSAGE_WITH_CODE="custom.fullMessageWithCode",e.ERROR_CATEGORY="custom.errorCategory",e.ERROR_IS_EXPECTED="custom.errorIsExpected",e.ERROR_LOG_METADATA="custom.errorLogMetadata",e.ERROR_CLIENT_FATAL="custom.clientFatal",e.CONTENT_LOCATION="custom.content.location",e.CONTENT_UPDATED_LOCATION="custom.content.updated_location",e.CONTENT_SELECTION_COUNT="custom.content.selection_count",e.CUSTOM_HAS_PREMIUM_CONTENT="custom.has_premium_content",e.CUSTOM_GRID_OPERATION_LEVEL="custom.grid.operation_level",e.CUSTOM_FIREFLY_MODAL="custom.firefly.modal",e.CUSTOM_CONTENT_DURATION="custom.content.duration",e.CUSTOM_ASSET_COUNT="custom.asset.count",e.CUSTOM_CONTENT_MIMETYPE="custom.content.mimetype",e.CUSTOM_CONTENT_DROP_LOCATION="custom.content.drop_location",e.CUSTOM_CONTENT_TEXT_SCRIPTS="custom.content.text_scripts",e.CUSTOM_ASSET_CLASS="custom.asset_class",e.CUSTOM_RECOMMENDATION_RANK="custom.recommendation.rank",e.CUSTOM_TAB_NAME="custom.ui.tab_name",e.DOCUMENT_ADDED_SCENE_NO="custom.document.addedSceneNo",e.DOCUMENT_DUPLICATED_SCENE_NO="custom.document.duplicatedSceneNo",e.DOCUMENT_SCENE="custom.document.scene",e.DOCUMENT_SCENE_NO="custom.document.sceneNo",e.DOCUMENT_SOURCE_SCENE_NO="custom.document.sourceSceneNo",e.DOCUMENT_PASTED_SCENE_NO="custom.document.pastedSceneNo",e.DOCUMENT_COPIED_SCENE_NO="custom.document.copiedSceneNo",e.DOCUMENT_UPDATED_SCENE_NO="custom.document.updatedSceneNo",e.DOCUMENT_DURATION="custom.document.duration",e.DOCUMENT_UPDATED_DURATION="custom.document.updatedDuration",e.DOCUMENT_PAGE_ID="custom.document.pageId",e.DOCUMENT_PAGE_NO="custom.document.pageNo",e.DOCUMENT_ZOOM_LEVEL="custom.document.zoomLevel",e.DOCUMENT_UPDATED_ZOOM_LEVEL="custom.document.updatedZoomLevel",e.DOCUMENT_OBJECT_TYPE="custom.document.objectType",e.DOCUMENT_OFFSET="custom.document.offset",e.DOCUMENT_UPDATED_OFFSET="custom.document.updatedOffset",e.DOCUMENT_VIDEO_WINDOW="custom.document.videoWindow",e.DOCUMENT_UPDATED_WINDOW="custom.document.updatedWindow",e.DOCUMENT_SIZE="custom.document.size",e.DOCUMENT_UPDATED_SIZE="custom.document.updatedSize",e.OBJECT_VOLUME="custom.content.volume",e.OBJECT_UPDATED_VOLUME="custom.content.updatedVolume",e.OBJECT_SIZE="custom.object.size",e.OBJECT_UPDATED_SIZE="custom.object.updatedSize",e.OBJECT_ARTBOARD_SIZE="custom.object.artboardSize",e.CONTENT_OPACITY_VALUE="custom.content.opacity_value",e.CONTENT_BLEND_MODE="custom.content.blend_mode",e.UI_TRIM_DIRECTION="custom.ui.trimDirection",e.OBJECT_PREVIOUS_OFFSET="custom.document.offset",e.OBJECT_UPDATED_OFFSET="custom.document.updatedOffset",e.UI_METHOD="custom.ui.method",e.CONTENT_ADJUSTMENT_MAP="custom.content.adjustment_map",e.DOCUMENT_SCENE_COUNT="custom.document.scene_count",e.DOCUMENT_CONTENT_LIST="custom.document.content_list",e.CONTEXTUAL_TRACK_STATUS="custom.contextual_track.status",e.CONTENT_FILTER_NAME="custom.content.effect_name",e.CONTENT_FILTER_CATEGORY="custom.content.effect_category",e.CONTENT_FILTER_INTENSITY_VALUE="custom.content.effect_intensity_value",e.CONTENT_FILTER_DUOTONE_MAP="custom.content.effect_duotone_map",e.DOCUMENT_APPLIED_DURATION_SCENE_COUNT="custom.scene.applied_duration_scene_count",e.DOCUMENT_UPDATED_SCENE_COUNT="custom.document.num_scene_applied",e.CUSTOM_UI_LOCATION="custom.ui.location",e.CUSTOM_CONTENT_MULTISELECT="custom.content.multiselect",e.CUSTOM_CONTENT_SELECTION_COUNT="custom.content.selection_count",e.CUSTOM_IMAGE_SELECTION_COUNT="custom.image.selection_count",e.CUSTOM_VIDEO_SELECTION_COUNT="custom.video.selection_count",e.CUSTOM_TEXT_SELECTION_COUNT="custom.text.selection_count",e.CUSTOM_SHAPE_SELECTION_COUNT="custom.shape.selection_count",e.CUSTOM_ICON_SELECTION_COUNT="custom.icon.selection_count",e.CUSTOM_GIF_SELECTION_COUNT="custom.gif.selection_count",e.CUSTOM_UI_FILTER="custom.ui.filter",e.UI_SORT_TYPE="custom.ui.sort_type",e.UI_FILTER="ui.filter",e.UI_SORT_ORDER="ui.sort_order",e.CUSTOM_EDITOR_IS_DRAWING="custom.editor.is_drawing",e.CUSTOM_DELETE_TYPE="custom.delete_type",e.CUSTOM_DOCUMENT_NUMPAGESTOTAL="custom.document.numPagesTotal",e.CUSTOM_MOVE_ORIGIN="custom.move.origin",e.CUSTOM_MOVE_DESTINATION="custom.move.destination",e.CUSTOM_MOVE_ASSET_COUNT="custom.move.asset_count",e.CUSTOM_MULTIPLE_UPLOADS="custom.asset.multiple_uploads",e.CUSTOM_CONTENT_RESOLUTION="custom.content.resolution",e.CUSTOM_FILE_COUNT="custom.file_count",e.CUSTOM_UI_METHOD="custom.ui.method",e.CUSTOM_COLLAB_REVIEW_MODEL="custom.collab.review_model",e.CUSTOM_COLLAB_REVIEW_STATUS="custom.collab.review_status",e.CUSTOM_CONTENT_SETTING="custom.content.setting",e.CUSTOM_MIGRATION_STATUS="custom.migration.status",e.CUSTOM_PLAYBOOK_COLLECTION_NAME="custom.playbook.collection_name",e.CUSTOM_AUDIO_EFFECT_ID="custom.audio.effect_id",e.CUSTOM_AUDIO_ADJUSTMENT_MAP="custom.audio.adjustment_map",e.CUSTOM_AUDIO_TRACK_NO="custom.audio.track_no",e.CUSTOM_AUDIO_FILE_SEQUENCE="custom.audio.file_sequence",e.CUSTOM_AUDIO_TRACK_TYPE="custom.audio.track_type",e.CUSTOM_AUDIO_ID="custom.audio.id",e.CUSTOM_AUDIO_DURATION="custom.audio.duration",e.CUSTOM_ENHANCE_SPEECH_ADJUST_PARAMS="custom.audio.enhance_speech_adjust_param",e.CUSTOM_UI_TRIGGER="custom.ui.trigger",e.IS_NEW_USER="hz.is_new_to_projectx",e.USER_FIRST_ACCESS_TIME="hz.user.first_access_time",e.CUSTOM_USER_ADMIN_ROLE="custom.user.admin_role",e.CUSTOM_EDU_USER_TYPE="custom.user.edu.profile_role",e.CUSTOM_EDU_CLASS_ID="custom.edu.class_id",e.CUSTOM_EDU_ACTION_TYPE="custom.edu.action_type",e.CUSTOM_EDU_LESSON_NAME="custom.edu.lesson_name",e.CUSTOM_EDU_COURSE_NAME="custom.edu.course_name",e.CUSTOM_EDU_BLOG_NAME="custom.edu.blog_name",e.CUSTOM_EDU_TEMPLATE_TITLE="custom.edu.template_title",e.CUSTOM_EDU_CTA_TARGET_PAGE="custom.edu.cta_target_page",e.CUSTOM_EDU_TEMPLATE_ID="custom.template.id",e.IS_K12="is_k12",e.IS_EDU_USER="hz.user.is_edu",e.CUSTOM_USER_ID_TYPE="custom.user.entitlement_feature_set_type_express",e.CUSTOM_USER_OFFERING="custom.user.offering_express",e.CUSTOM_LEARN_CATEGORY="custom.learn.category",e.ORG_ID="hz.user.org_id",e.NUM_RESOURCES="custom.numResources",e.RESOLUTION="custom.resolution",e.SELECT_GUID="custom.selectGuid",e.SELECT_TYPE="custom.selectType",e.SVG_TAG="custom.svgTag",e.PLATFORM_TYPE="hz.source_platform_type",e.MOBILE_ID="hz.mobile_id",e.DEVICE_NAME="hz.device_name",e.DEVICE_HEIGHT="hz.user.device_screen_height",e.DEVICE_WIDTH="hz.user.device_screen_width",e.MOBILE_INSTALL_DATE="hz.mobile_install_date",e.EXPERIMENTS_ASSIGNED="hz.assigned_experiment_variants",e.EXPERIMENTS_EXPOSED="hz.experiment_exposed_variants",e.EXPERIMENT_ID="hz.experiment_id",e.EXPERIMENT_VARIANT_NAME="hz.experiment_variant_name",e.EXPERIMENT_TRIGGERED_PROPERTY_VALUE="hz.experiment_triggered_property_value",e.EXPERIMENT_TRIGGERED_EXPOSURE_EVENT="hz.experiment_triggered_exposure_event",e.FEATURE_ROLLOUTS_ASSIGNED="hz.user.pfr_assigned",e.CONTENT_REPLACE_TYPE="custom.content.replace_type",e.CUSTOM_UI_SEARCH_TYPE="custom.ui.search_type",e.CUSTOM_UI_KEYWORK_RANK="custom.ui.keyword_rank",e.CUSTOM_SEARCH_PREFIX_QUERY="custom.search.prefix_query",e.CUSTOM_SEARCH_SUGGESTION_LIST_SHOWN="custom.search.suggestion_list_shown",e.CUSTOM_TASK_NAME="custom.task.name",e.CUSTOM_TASK_TYPE="custom.task.type",e.CUSTOM_TASK_IS_WEBPAGE="custom.task.is_webpage",e.CUSTOM_SEARCH_SUGGESTED_TASK_AND_QUICKACTION="custom.search.suggested_task_and_quickaction",e.CUSTOM_QA_GROUP="custom.qa.group",e.CUSTOM_QA_TYPE="custom.qa.type",e.CUSTOM_QA_LOCATION="custom.qa.location",e.CUSTOM_SEARCH_ID="custom.search.id",e.CUSTOM_SEARCH_RESULT_COUNT="custom.search.result_count",e.CUSTOM_CONTENT_IMPRESSION_LIST="custom.content.impression_list",e.CUSTOM_TEMPLATES_TASK_NAME="custom.templates.task",e.CUSTOM_SEARCH_TOOL_NAME="custom.tool.name",e.CUSTOM_SEARCH_SUGGESTED_TOOL="custom.search.suggested_tool",e.CUSTOM_RECOMMENDED_SEARCH_CLICK="custom.recommended_search_click",e.CUSTOM_RECOMMENDATION_SOURCE="custom.recommendation.source",e.CUSTOM_QUICK_ASSIGN_BUTTON="custom.quick_assign.location",e.CUSTOM_SEARCH_RANK="custom.search.rank",e.CUSTOM_TEMPLATES_PAGE_COUNT="custom.templates.page_count",e.CUSTOM_MOBILE_DOWNLOAD_TRIGGER="custom.mobile.download_trigger",e.CUSTOM_UI_STYLE_FILTER="custom.ui.style_filter",e.CUSTOM_UI_MOOD_FILTER="custom.ui.mood_filter",e.CUSTOM_UI_TYPE_FILTER="custom.ui.type_filter",e.CUSTOM_UI_REGION_FILTER_ALL="custom.ui.region_filter_all",e.CUSTOM_UI_REGION_FILTER_DEFAULT="custom.ui.region_filter_default",e.CUSTOM_UI_REGION_FILTER_ADDED="custom.ui.region_filter_added",e.CUSTOM_UI_STATUS_FILTER="custom.ui.status_filter",e.CUSTOM_UI_CATEGORY_FILTER="custom.ui.category_filter",e.CUSTOM_UI_SUBJECT_FILTER="custom.ui.subject_filter",e.CUSTOM_UI_GRADE_FILTER="custom.ui.grade_filter",e.CUSTOM_UI_ACTIVITY_TYPE_FILTER="custom.ui.activity_type_filter",e.CUSTOM_UI_SIZE_FILTER="custom.ui.size_filter",e.CUSTOM_UI_TARGET_RESOURCE_FILTER="custom.ui.target_resource_filter",e.CUSTOM_UI_KEYWORD_FILTER="custom.ui.keyword_filter",e.CUSTOM_UI_TASK_FILTER="custom.ui.task_filter",e.CUSTOM_UI_PEOPLE_FILTER="custom.ui.people_filter",e.CUSTOM_UI_COLOR_FILTER="custom.ui.color_filter",e.CUSTOM_UI_GENRE_FILTER="custom.ui.genre_filter",e.CUSTOM_UI_VOCAL_FILTER="custom.ui.vocal_filter",e.CUSTOM_UI_ORIENTATION_FILTER="custom.ui.orientation_filter",e.CUSTOM_UI_GENERATIVE_AI_FILTER="custom.ui.generative_ai_filter",e.CUSTOM_UI_SEARCH_KEYWORD_LENGTH="custom.ui.search_keyword_length",e.CUSTOM_UI_SEARCH_KEYWORD_TOKEN_COUNT="custom.ui.search_keyword_token_count",e.USS_TRACKING_NULL_RECOVERY="uss_tracking.null_recovery",e.USS_TRACKING_QUERY_RECALL="uss_tracking.original_query_recall",e.USS_TRACKING_ADOBE_ONE_RECALL="uss_tracking.adobe_one_recall",e.USS_TRACKING_ADOBE_ONE_RESCORE="uss_tracking.adobe_one_rescore",e.USS_TRACKING_DESIGN_TYPE_BOOST="uss_tracking.design_type_boost",e.USS_TRACKING_VIDEO_T20_RESULT_COUNT="uss_tracking.video_t20_result_count",e.USS_TRACKING_VIDEO_T100_RESULT_COUNT="uss_tracking.video_t100_result_count",e.USS_TRACKING_QUERY_INTENT="uss_tracking.query_intent",e.USS_TRACKING_SPELLCHECK_IS_CORRECTED="uss_tracking.spellcheck_is_corrected",e.USS_TRACKING_CONTENT_INTERLEAVING_EXECUTED="uss_tracking.content_interleaving_executed",e.USS_TRACKING_IS_VALID_RECALL_SET_FOR_CONTENT_INTERLEAVING="uss_tracking.is_valid_recall_set_for_content_interleaving",e.USS_TRACKING_NO_OF_LONG_PROMPT_AC_SUGGEST="uss_tracking.no_of_longprompt_ac_suggest",e.CUSTOM_SEARCH_LONG_PROMPT_QUERY="custom.search.long_prompt_query",e.CUSTOM_SCREEN_LOAD_TYPE="custom.screen_load_time",e.CUSTOM_SESSION_RESTORE_REASON="custom.session_restore_reason",e.CUSTOM_PAGE_TASK_ID="custom.page.task_id",e.CUSTOM_PAGE_UPDATED_TASK_ID="custom.page.updated_task_id",e.CUSTOM_TASK_GROUP="custom.task.group",e.CUSTOM_TASK_SUBGROUP="custom.task.subgroup",e.CUSTOM_PANEL_NAME="custom.panel.name",e.CUSTOM_PRINT_WORKFLOW="custom.print.workflow",e.CUSTOM_PRINT_SIZE="custom.print.size",e.CUSTOM_ADDON_IS_AUTHENTICATED="custom.addon.is_authenticated",e.CUSTOM_LINK_DETAILS="custom.link.details",e.CUSTOM_UI_CTA_MESSAGE="custom.ui.cta_message",e.CUSTOM_UI_CARD_MESSAGE="custom.ui.card_message",e.CUSTOM_ANIMATION_EFFECT_CATEGORY="custom.animation.effect_category",e.CUSTOM_ANIMATION_EFFECT_ID="custom.animation.effect_id",e.CUSTOM_ANIMATION_ADJUSTMENT_MAP="custom.animation.adjustment_map",e.CUSTOM_ANIMATION_IS_MULTISELECT="custom.animation.is_multiselect",e.CUSTOM_ANIMATION_SCENE_PRESET_CATEGORY="custom.animation.scene_preset_category",e.CUSTOM_ANIMATION_SCENE_PRESET_ID="custom.animation.scene_preset_id",e.CUSTOM_TRANSITION_ADJUSTMENT_MAP="custom.transition.adjustment_map",e.CUSTOM_TRANSITION_DURATION="custom.transition.duration",e.CUSTOM_TRANSITION_EFFECT_NAME="custom.transition.effect_name",e.CUSTOM_TRANSITION_EFFECT_ID="custom.transition.effect_id",e.CUSTOM_TRANSITION_NUM_PAGES_APPLIED="custom.transition.num_pages_applied",e.CUSTOM_TRANSITION_NUM_APPLIED="custom.transition.num_transition_applied",e.CUSTOM_PROJECT_ID="custom.project.id",e.CUSTOM_PROJECTS_OPEN_FROM="custom.projects.open_from",e.CUSTOM_COLLAB_WORKFLOW="custom.collab.workflow",e.CUSTOM_LIBRARY_FILTER="custom.library.filter",e.CUSTOM_LIBRARY_TYPE="custom.library.type",e.CUSTOM_COLLAB_ACCESS_LEVEL="custom.collab.access_level",e.CUSTOM_COLLAB_USER_TYPE="custom.collab.user_type",e.CUSTOM_LIBRARY_ASSET_TYPES="custom.library.asset_types",e.CUSTOM_GENERAL_TOGGLE_MODE="custom.general.toggle_mode",e.CUSTOM_LIBRARY_COUNT="custom.library.count",e.CUSTOM_PROJECT_COUNT="custom.project.count",e.CUSTOM_REFERRER_APP="custom.referrer.app",e.CUSTOM_REFERRER_LANDING_TAB="custom.referrer.app_landing_tab",e.CUSTOM_REFERRER_ASSET_ID="custom.referrer.app_integration_asset_id",e.CUSTOM_REFERRER_INTENT="custom.referrer.app_intent",e.CUSTOM_REFERRER_ACTION="custom.referrer.app_action",e.CUSTOM_REFERRER_NBA_ACTION="custom.referrer.nba_action",e.CUSTOM_CONTENT_LOCK_STATUS="custom.content.lock_status",e.CUSTOM_DOCUMENT_LOCK_STATUS="custom.document.lock_status",e.CUSTOM_CONTENT_LOCK_SETTING="custom.content.lock_setting",e.EVENT_SOURCE_OS_VERSION="hz.user.os_version",e.EVENT_SOURCE_OS_NAME="hz.user.os_name",e.EVENT_SOURCE_DEVICE_MODEL="hz.user.device_model",e.EVENT_SOURCE_BROWSER_NAME="hz.user.browser_name",e.EVENT_SOURCE_BROWSER_VERSION="hz.user.browser_version",e.EVENT_SOURCE_PLATFORM_TYPE_DETAIL="hz.user.platform_type_detail",e.CUSTOM_DOCUMENT_NAVIGATION_METHOD="custom.document.navigation_method",e.CUSTOM_DOCUMENT_PREVIOUS_NAVIGATION_METHOD="custom.document.previous_navigation_method",e.CUSTOM_CONTENT_PAGE_COUNT="custom.content.page_count",e.CUSTOM_DOCUMENT_RESOLUTION="custom.document.resolution",e.CUSTOM_UI_ADD_PAGE_OPTION="custom.ui.add_page_option",e.CUSTOM_TEXT_AUTO_STYLE="custom.text.auto_style",e.CUSTOM_TEXT_FLOW_FLAG="custom.text.text_flow_flag",e.CUSTOM_OPERATION_NAME="custom.operation.name",e.CUSTOM_OPERATION_PREVIEW="custom.operation.preview",e.CUSTOM_OPERATION_RESULT_STATUS="custom.operation.result_status",e.CUSTOM_OPERATION_TARGET_ACTION="custom.operation.target_action",e.CUSTOM_OPERATION_TARGET_NAME="custom.operation.target_name",e.CUSTOM_OPERATION_TARGET_NORMALIZED_VALUE="custom.operation.target_normalized_value",e.CUSTOM_OPERATION_TARGET_VALUE="custom.operation.target_value",e.CUSTOM_OPERATION_TARGET_VALUE_ORIGINAL="custom.operation.target_value_original",e.CUSTOM_TEXT_SELECTION_SPAN="custom.text.selection_span",e.CUSTOM_OPERATION_TYPE="custom.operation.type",e.CUSTOM_TEXT_SELECTION_METHOD="custom.text.selection_method",e.CUSTOM_FONT_TYPE="custom.font.type",e.CUSTOM_TEXT_ORIGINAL_FONT="custom.text.original_font",e.CUSTOM_TEXT_FALLBACK_FONT="custom.text.fallback_font",e.CUSTOM_TEXT_FALLBACK_TYPE="custom.text.fallback_type",e.CUSTOM_TEXT_SCRIPT_CODE="custom.text.script_code",e.CUSTOM_TEXT_COUNT="custom.text.count",e.CUSTOM_DOCUMENT_SPELLCHECKER_STATUS="custom.document.spellchecker_status",e.CUSTOM_TEXT_SPELLCHECKER_LANGUAGE="custom.text.spellchecker_language",e.CUSTOM_TEXT_SPELLCHECKER_ACTION="custom.text.spellchecker_action",e.CUSTOM_TEXT_SPELLCHECKER_RECOMMENDATION_RANK="custom.text.spellchecker_recommendation_rank",e.CUSTOM_TEXT_SPELLCHECKER_IGNORED_WORD="custom.text.spellchecker_ignored_word",e.EVENT_MOBILE_EXPERIENCE_TYPE="hz.event.mobile_experience_type",e.CUSTOM_GIF_LOOP_TYPE="custom.gif.loop_type",e.CUSTOM_CONTENT_LOOP_TYPE="custom.content.loop_type",e.CUSTOM_CONTENT_COMPLETE_LOOP="custom.content.complete_loop",e.EVENT_MOBILE_BUILD_TYPE="hz.event.mobile_build_type",e.NUM_PAGES_ADDED="custom.document.num_pages_added_using_copy_paste",e.ADDED_PAGE_PREVIOUS_TASK="custom.added_page.previous_task",e.CUSTOM_FEEDBACK_SATISFACTION_RESPONSE="custom.feedback.satisfaction_response",e.CUSTOM_GEN_AI_EXPAND="custom.gen_ai.expand",e.CUSTOM_RESIZE_MODEL_ID="custom.resize.model_id",e.CUSTOM_RESIZE_RECENT_ENABLED="custom.resize.recent_enabled",e.CUSTOM_RESIZE_TYPE="custom.resize.type",e.CUSTOM_RESIZE_ORIGINAL_ASPECT_RATIO="custom.resize.original_aspect_ratio",e.CUSTOM_RESIZE_RESIZED_ASPECT_RATIO="custom.resize.resized_aspect_ratio",e.CUSTOM_RESIZE_DESIGN_TOKEN_COUNT="custom.resize.design_token_count",e.CUSTOM_PAGE_TASK_GROUP="custom.page.task_group",e.CUSTOM_PRINT_ADDON_PAGE_TYPE="custom.print_addon.page_type",e.CUSTOM_PRINT_ADDON_EXPERIENCE_TYPE="custom.print_addon.experience_type",e.CUSTOM_INPUT_WIDTH="custom.input_width",e.CUSTOM_INPUT_HEIGHT="custom.input_height",e.CUSTOM_INPUT_UNIT="custom.input_unit",e.CUSTOM_LAYER_SELECTION_METHOD="custom.layer.selection_method",e.CUSTOM_LAYER_SELECTION_TYPE="custom.layer.selection_type",e.CUSTOM_LAYER_COACHMARK_SELECTION="custom.layer.coachmark_selection",e.CUSTOM_SHARE_MENU_TYPE="custom.share.menu_type",e.CUSTOM_OUTLINE_TO_PRESENTATION_FLAG="custom.presentation.outline_to_presentation_flag",e.CUSTOM_DOCUMENT_ACROBAT_ORIGIN_FLAG="custom.document.acrobat_origin_flag",e.CUSTOM_PRESENTATION_AUDIENCE="custom.outline_to_presentation.presentation_audience",e.CUSTOM_PRESENTATION_TONE="custom.outline_to_presentation.presentation_tone",e.CUSTOM_PRESENTATION_LENGTH="custom.outline_to_presentation.presentation_length",e.CUSTOM_PRESENTATION_LEVEL_OF_DETAIL="custom.outline_to_presentation.level_of_detail",e.CUSTOM_PRESENTATION_IMAGE_SOURCES="custom.outline_to_presentation.presentation_image_sources",e.CUSTOM_USE_DOC_IMAGES_TOGGLE_STATUS="custom.outline_to_presentation.use_doc_images_toggle_status",e.CUSTOM_PRESENTATION_NUM_LAYOUTS="custom.presentation.num_layouts",e.CUSTOM_PRESENTATION_LAYOUTS_DETAILS="custom.presentation.layouts_details",e.CUSTOM_DOCUMENT_RULERS_STATUS="custom.document.rulers_status",e.CUSTOM_ACTION_NAME="custom.action.name",e.CUSTOM_GEN_AI_HAS_3P_MODELS="custom.gen_ai.has_3p_models",e.IS_FOCUS_MODE="is_focus_mode",e.CUSTOM_FOCUS_MODE_ENTRY="custom.focusmode.entry",e.CUSTOM_FOCUS_MODE_TYPE="custom.focusmode.type",e.CUSTOM_ICON_NUM_COLORS="custom.icon.num_colors",e.CUSTOM_ICON_CUSTOMIZATION_TYPE="custom.icon.customization_type",e.IS_IN_GROUP="custom.content.grouped_element_flag",e.IS_GROUP="custom.content.is_group",e.GROUP_ELEMENTS="custom.group.grouped_elements_count",e.GROUP_ACTION_AREA="custom.group.action_area",e.NUM_GROUPS="custom.document.num_groups",e.CUSTOM_FEEDBACK_TRIGGER="custom.feedback.trigger",e.CUSTOM_CLIP_LENGTH="custom.clip.length",e.CUSTOM_RECOMMENDATION_LIST="custom.recommendation.list",e.CUSTOM_VIDEOS_ID="custom.videos.id",e.CUSTOM_UPLOADED_VIDEO_COUNT="custom.video.uploaded_video_count",e.CUSTOM_AUDIO_CHUNK="custom.audio.chunk",e.CUSTOM_ADDON_ID="custom.addon.id",e.CUSTOM_ADDON_NAME="custom.addon.name",e.CUSTOM_TEMPLATE_ID="custom.template.id",e.CUSTOM_SERVICE_TYPE="custom.service.type",e.CUSTOM_FEEDBACK_SCORE="custom.feedback.score",e.CUSTOM_TEMPLATES_TASK="custom.templates.task",e.CUSTOM_TEMPLATE_TOPICS="custom.template.topics",e.CUSTOM_FEEDBACK_CONSENT="custom.feedback.consent",e.CUSTOM_PARENT_TEMPLATE_ID="custom.parent_template.id",e.CUSTOM_TEMPLATE_VARIANT_TYPE="custom.template_variant.type",e.CUSTOM_FEEDBACK_FOLLOWUP_RESPONSE="custom.feedback.followup_response",e.CUSTOM_FEEDBACK_CATEGORY_FOLLOWUP="custom.feedback.category_followup",e.CUSTOM_FEEDBACK_DETAIL_RESPONSE="custom.feedback.detail_response",e.CUSTOM_FEEDBACK_CATEGORY_RESPONSE="custom.feedback.category_response",e.CUSTOM_DOCUMENT_ID="custom.document.id",e.CUSTOM_TIMELINE_ID="custom.timeline.id",e.CUSTOM_EXPORT_REMAINING_LIMIT="custom.export.remaining_limit",e}({}),V=function(e){return e.PROMO_ID="custom.campaign.promo_id",e.CGEN="custom.campaign.cgen_code",e.TRACKING_ID="custom.campaign.tracking_id",e.SDID="custom.campaign.sdid",e.MV="custom.campaign.mv",e.MV2="custom.campaign.mv2",e.RECENT_CAMPAIGN="custom.campaign.recent",e.RECENT_MV="custom.campaign.recent_mv",e.RECENT_MV2="custom.campaign.recent_mv2",e.REFERRER="custom.referrer.app",e}({}),B=function(e){return e.event="event",e.content="content",e.source="source",e.user="user",e.custom="custom",e}({}),G=function(e){return e.UNINITIALIZED="uninitialized",e.ALLOWED="allowed",e.DENIED="denied",e}({});let W="can not get ECID";var z="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),j=new Uint8Array(16);let H=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,K=function(e){return"string"==typeof e&&H.test(e)};for(var Y=[],X=0;X<256;++X)Y.push((X+256).toString(16).substr(1));let q=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(Y[e[t+0]]+Y[e[t+1]]+Y[e[t+2]]+Y[e[t+3]]+"-"+Y[e[t+4]]+Y[e[t+5]]+"-"+Y[e[t+6]]+Y[e[t+7]]+"-"+Y[e[t+8]]+Y[e[t+9]]+"-"+Y[e[t+10]]+Y[e[t+11]]+Y[e[t+12]]+Y[e[t+13]]+Y[e[t+14]]+Y[e[t+15]]).toLowerCase();if(!K(i))throw TypeError("Stringified UUID is invalid");return i},$=function(e,t,i){var r=(e=e||{}).random||(e.rng||function(){if(!z)throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return z(j)})();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){i=i||0;for(var s=0;s<16;++s)t[i+s]=r[s];return t}return q(r)},Q=["authorization","authtoken","servicetoken"];function J(e){if(!e)return e;try{let t=Z(e);if(!t)return{};return JSON.parse(t)}catch(e){return console.error("safeCopy() - Failed to copy",e),{}}}function Z(e){try{let t=new Set;return JSON.stringify(e,(e,i)=>{if("string"==typeof e&&Q.includes(e.toLowerCase()))return"xxxxx";if(null!==i){if(i instanceof Date)return i.toISOString();let e=typeof i;if("object"===e||i instanceof Array){if(t.has(i))return"--visited--";t.add(i)}else if("bigint"===e)return i.toString();else if("number"===e&&!Number.isFinite(i))return i.toString()}return i})}catch(e){return console.error("safeStringify() - Failed to stringify",e),""}}var ee=i(673);Error.stackTraceLimit=50;class et extends Error{get code(){return this._code}get uuid(){return this._uuid||(this._uuid=$()),this._uuid}set uuid(e){this._uuid=e}get isExpected(){return!!this._isExpected||this.previousError instanceof et&&this.previousError.isExpected}set isExpected(e){this._isExpected=e}hasErrorCode(e){return this.code===e||this.previousError instanceof et&&this.previousError.hasErrorCode(e)}findErrorBy(e){return e(this)?this:this.previousError instanceof et?this.previousError.findErrorBy(e):void 0}getDataRepresentation(e={skipStack:!1}){let t={kind:"HzError",code:this.code,message:this.message,stack:e.skipStack?void 0:this.stack,uuid:this.uuid,category:this.category,isExpected:this.isExpected,logMetadata:this.logMetadata};return this.previousError&&(this.previousError instanceof et?t.previousErrorData=this.previousError.getDataRepresentation(e):t.previousErrorData={kind:"Error",name:this.previousError.name,message:this.previousError.message,stack:e.skipStack?void 0:this.previousError.stack}),J(t)}_getErrorMessageWithCode(e){return(0,ee.isAdobeDCXError)(e)?`${e.name}: ${e.code}: ${e.message}`:`${e.name}: ${e.message}`}_getDCXUnderlyingErrorMessage(e){let t=this._getErrorMessageWithCode(e);return(0,ee.isAdobeDCXError)(e)&&e.underlyingError&&(t+=`
From underlying error: ${this._getDCXUnderlyingErrorMessage(e.underlyingError)}`),t}_getDCXErrorFullStack(e){let t=e.stack;return(0,ee.isAdobeDCXError)(e)&&e.underlyingError&&(t+=`
From underlying error: ${this._getDCXErrorFullStack(e.underlyingError)}`),t}get fullStack(){let e=this.stack||"";return this.previousError&&(e+="\nFrom previous error: ",this.previousError instanceof et?e+=this.previousError.fullStack:(0,ee.isAdobeDCXError)(this.previousError)?e+=this._getDCXErrorFullStack(this.previousError):e+=this.previousError.stack),e.replace(/access_token=[0-9A-Za-z-._%=]+/,"")}get messageWithCode(){return this.category?`${this.category}: ${this.code}: ${this.message}`:`${this.code}: ${this.message}`}get fullMessageWithCode(){let e=this.messageWithCode;return this.previousError&&(e+="\nFrom previous error: ",this.previousError instanceof et?e+=this.previousError.fullMessageWithCode:(0,ee.isAdobeDCXError)(this.previousError)?e+=this._getDCXUnderlyingErrorMessage(this.previousError):e+=this.previousError),e}get fullLogMetadata(){let e=this.logMetadata;if(this.previousError instanceof et){let t=this.previousError.fullLogMetadata;t&&((e=Object.assign({},this.logMetadata)).previousLogMetadata=t)}return e}constructor(e,t,i){super(t),this._code=e,this._isExpected=!1,this.name=e+"Error",i&&(i instanceof Error?this.previousError=i:(this.previousError=i.previousError,this.category=i.category,this.logMetadata=i.logMetadata,this.isExpected=!!i.isExpected))}}let ei={maxAttempts:5,delay:100,shouldUseServiceDelay:!1};function er(e,t,i){let r={...ei,...t};if("number"!=typeof r.maxAttempts||r.maxAttempts<1||Math.floor(r.maxAttempts)!==r.maxAttempts)throw Error(`retry: maxAttempts must be an integer, at least 1, found ${r.maxAttempts}`);let s=0,o=0,n=r.progressMessagePrefix||e.name,a=(...t)=>((...t)=>{if(!r.timeoutInterval)return e(...t);{let o,a=0,l=new Promise((e,t)=>{let l={...{timedOutOperation:n,attemptNumber:s,maxAttempts:r.maxAttempts,timeoutInterval:r.timeoutInterval},...i};a=setTimeout(()=>{t(new et("OperationTimeout","Operation Timeout",{logMetadata:l}))},r.timeoutInterval),o=e});return Promise.race([e(...t),l]).then(e=>(o(),e)).finally(()=>{clearTimeout(a)})}})(...t).then(e=>(r.progressCallback&&s>0&&r.progressCallback(`${n} succeeded after retries`,{failedAttempts:s,totalDelay:o}),e)).catch(async e=>{var i;if(++s===r.maxAttempts)return r.progressCallback&&r.progressCallback(`${n} failed after retries, giving up.`,{failedAttempts:s,totalDelay:o},e),Promise.reject(e);if("function"==typeof r.shouldRetry)try{if(!await r.shouldRetry(e))return Promise.reject(e)}catch(e){return r.progressCallback&&r.progressCallback(`shouldRetry of ${n} failed`,{failedAttempts:s,totalDelay:o},e),Promise.reject(e)}let l=0;if(r.shouldUseServiceDelay){let t=e.response;t&&(l=function(e){let t=e.get("retry-after"),i=0;if(t){if(isNaN(t)){let e=Date.parse(t)-Date.now();e>0&&(i=e)}else i=Number(t);i=Math.floor((i+(Math.random()+1))*1e3)}return i}(t.headers))}if(0===l&&(l=Math.floor(2**(s-1)*r.delay*(Math.random()+1))),"function"==typeof r.affectDelayHook){let t=r.affectDelayHook(e);t&&(0===t.type&&(l=t.value),1===t.type&&l<t.value&&(l=Math.floor(t.value*(Math.random()+1))))}if(o+=l,"function"==typeof r.preRetryHook)try{await r.preRetryHook(e)}catch(e){return r.progressCallback&&r.progressCallback(`preRetryHook of ${n} failed`,{failedAttempts:s,totalDelay:o,nextRetry:l},e),Promise.reject(e)}return r.progressCallback&&r.progressCallback(`${n} failed, trying again after delay.`,{failedAttempts:s,totalDelay:o,nextRetry:l},e),(i=l,new Promise(e=>{setTimeout(e,i)})).then(()=>a(...t))});return a}var es=function(e){return e.default="default",e.noStore="no-store",e.reload="reload",e.noCache="no-cache",e.forceCache="force-cache",e.onlyIfCached="only-if-cached",e}({}),eo=function(e){return e.omit="omit",e.sameOrigin="same-origin",e.include="include",e}({}),en=function(e){return e.follow="follow",e.error="error",e.manual="manual",e}({}),ea=function(e){return e.noReferrer="no-referrer",e.noReferrerWhenDowngrade="no-referrer-when-downgrade",e.origin="origin",e.originWhenCrossOrigin="origin-when-cross-origin",e.sameOrigin="same-origin",e.strictOrigin="strict-origin",e.strictOriginWhenCrossOrigin="strict-origin-when-cross-origin",e.unsafeURL="unsafe-url",e}({}),el=function(e){return e[e.Browser=0]="Browser",e[e.Node=1]="Node",e[e.Worker=2]="Worker",e}({});function ec(e){return Symbol.for(e)}var eu=new function e(t){var i=this;i._currentContext=t?new Map(t):new Map,i.getValue=function(e){return i._currentContext.get(e)},i.setValue=function(t,r){var s=new e(i._currentContext);return s._currentContext.set(t,r),s},i.deleteValue=function(t){var r=new e(i._currentContext);return r._currentContext.delete(t),r}},e_=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,s,o=i.call(e),n=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)n.push(r.value)}catch(e){s={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(s)throw s.error}}return n},ed=function(e,t,i){if(i||2==arguments.length)for(var r,s=0,o=t.length;s<o;s++)!r&&s in t||(r||(r=Array.prototype.slice.call(t,0,s)),r[s]=t[s]);return e.concat(r||Array.prototype.slice.call(t))},eh=function(){function e(){}return e.prototype.active=function(){return eu},e.prototype.with=function(e,t,i){for(var r=[],s=3;s<arguments.length;s++)r[s-3]=arguments[s];return t.call.apply(t,ed([i],e_(r),!1))},e.prototype.bind=function(e,t){return t},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),eg="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof i.g?i.g:{},eE="1.7.0",ep=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/,ef=function(e){var t=new Set([e]),i=new Set,r=e.match(ep);if(!r)return function(){return!1};var s={major:+r[1],minor:+r[2],patch:+r[3],prerelease:r[4]};if(null!=s.prerelease)return function(t){return t===e};function o(e){return i.add(e),!1}return function(e){if(t.has(e))return!0;if(i.has(e))return!1;var r=e.match(ep);if(!r)return o(e);var n={major:+r[1],minor:+r[2],patch:+r[3],prerelease:r[4]};if(null!=n.prerelease||s.major!==n.major)return o(e);if(0===s.major)return s.minor===n.minor&&s.patch<=n.patch?(t.add(e),!0):o(e);return s.minor<=n.minor?(t.add(e),!0):o(e)}}(eE),em=Symbol.for("opentelemetry.js.api."+eE.split(".")[0]);function eT(e,t,i,r){void 0===r&&(r=!1);var s,o=eg[em]=null!=(s=eg[em])?s:{version:eE};if(!r&&o[e]){var n=Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return i.error(n.stack||n.message),!1}if(o.version!==eE){var n=Error("@opentelemetry/api: Registration of version v"+o.version+" for "+e+" does not match previously registered API v"+eE);return i.error(n.stack||n.message),!1}return o[e]=t,i.debug("@opentelemetry/api: Registered a global for "+e+" v"+eE+"."),!0}function eO(e){var t,i,r=null==(t=eg[em])?void 0:t.version;if(r&&ef(r))return null==(i=eg[em])?void 0:i[e]}function eS(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+eE+".");var i=eg[em];i&&delete i[e]}var eC=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,s,o=i.call(e),n=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)n.push(r.value)}catch(e){s={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(s)throw s.error}}return n},ev=function(e,t,i){if(i||2==arguments.length)for(var r,s=0,o=t.length;s<o;s++)!r&&s in t||(r||(r=Array.prototype.slice.call(t,0,s)),r[s]=t[s]);return e.concat(r||Array.prototype.slice.call(t))},ey=function(){function e(e){this._namespace=e.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return eR("debug",this._namespace,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return eR("error",this._namespace,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return eR("info",this._namespace,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return eR("warn",this._namespace,e)},e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return eR("verbose",this._namespace,e)},e}();function eR(e,t,i){var r=eO("diag");if(r)return i.unshift(t),r[e].apply(r,ev([],eC(i),!1))}!function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"}(U||(U={}));var eA=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,s,o=i.call(e),n=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)n.push(r.value)}catch(e){s={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(s)throw s.error}}return n},ew=function(e,t,i){if(i||2==arguments.length)for(var r,s=0,o=t.length;s<o;s++)!r&&s in t||(r||(r=Array.prototype.slice.call(t,0,s)),r[s]=t[s]);return e.concat(r||Array.prototype.slice.call(t))},eI=function(){function e(){function e(e){return function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r=eO("diag");if(r)return r[e].apply(r,ew([],eA(t),!1))}}var t=this;t.setLogger=function(e,i){if(void 0===i&&(i={logLevel:U.INFO}),e===t){var r,s,o,n=Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!=(r=n.stack)?r:n.message),!1}"number"==typeof i&&(i={logLevel:i});var a=eO("diag"),l=function(e,t){function i(i,r){var s=t[i];return"function"==typeof s&&e>=r?s.bind(t):function(){}}return e<U.NONE?e=U.NONE:e>U.ALL&&(e=U.ALL),t=t||{},{error:i("error",U.ERROR),warn:i("warn",U.WARN),info:i("info",U.INFO),debug:i("debug",U.DEBUG),verbose:i("verbose",U.VERBOSE)}}(null!=(s=i.logLevel)?s:U.INFO,e);if(a&&!i.suppressOverrideMessage){var c=null!=(o=Error().stack)?o:"<failed to generate stacktrace>";a.warn("Current logger will be overwritten from "+c),l.warn("Current logger will overwrite one already registered from "+c)}return eT("diag",l,t,!0)},t.disable=function(){eS("diag",t)},t.createComponentLogger=function(e){return new ey(e)},t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}(),eN=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,s,o=i.call(e),n=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)n.push(r.value)}catch(e){s={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(s)throw s.error}}return n},eb=function(e,t,i){if(i||2==arguments.length)for(var r,s=0,o=t.length;s<o;s++)!r&&s in t||(r||(r=Array.prototype.slice.call(t,0,s)),r[s]=t[s]);return e.concat(r||Array.prototype.slice.call(t))},eU="context",eD=new eh,eL=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(e){return eT(eU,e,eI.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(e,t,i){for(var r,s=[],o=3;o<arguments.length;o++)s[o-3]=arguments[o];return(r=this._getContextManager()).with.apply(r,eb([e,t,i],eN(s),!1))},e.prototype.bind=function(e,t){return this._getContextManager().bind(e,t)},e.prototype._getContextManager=function(){return eO(eU)||eD},e.prototype.disable=function(){this._getContextManager().disable(),eS(eU,eI.instance())},e}(),eP=eL.getInstance(),eM=(eI.instance(),function(){var e=function(t,i){return(e=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}()),eF=function(){function e(){}return e.prototype.createHistogram=function(e,t){return eY},e.prototype.createCounter=function(e,t){return eK},e.prototype.createUpDownCounter=function(e,t){return eX},e.prototype.createObservableGauge=function(e,t){return e$},e.prototype.createObservableCounter=function(e,t){return eq},e.prototype.createObservableUpDownCounter=function(e,t){return eQ},e.prototype.addBatchObservableCallback=function(e,t){},e.prototype.removeBatchObservableCallback=function(e){},e}(),ex=function(){},ek=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return eM(t,e),t.prototype.add=function(e,t){},t}(ex),eV=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return eM(t,e),t.prototype.add=function(e,t){},t}(ex),eB=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return eM(t,e),t.prototype.record=function(e,t){},t}(ex),eG=function(){function e(){}return e.prototype.addCallback=function(e){},e.prototype.removeCallback=function(e){},e}(),eW=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return eM(t,e),t}(eG),ez=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return eM(t,e),t}(eG),ej=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return eM(t,e),t}(eG),eH=new eF,eK=new ek,eY=new eB,eX=new eV,eq=new eW,e$=new ez,eQ=new ej,eJ=new(function(){function e(){}return e.prototype.getMeter=function(e,t,i){return eH},e}()),eZ="metrics",e0=(function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalMeterProvider=function(e){return eT(eZ,e,eI.instance())},e.prototype.getMeterProvider=function(){return eO(eZ)||eJ},e.prototype.getMeter=function(e,t,i){return this.getMeterProvider().getMeter(e,t,i)},e.prototype.disable=function(){eS(eZ,eI.instance())},e})().getInstance(),e1=function(){function e(){}return e.prototype.inject=function(e,t){},e.prototype.extract=function(e,t){return e},e.prototype.fields=function(){return[]},e}(),e3={get:function(e,t){if(null!=e)return e[t]},keys:function(e){return null==e?[]:Object.keys(e)}},e2={set:function(e,t,i){null!=e&&(e[t]=i)}},e5=ec("OpenTelemetry Baggage Key");function e4(e){return e.getValue(e5)||void 0}function e9(){return e4(eL.getInstance().active())}function e6(e,t){return e.setValue(e5,t)}function e7(e){return e.deleteValue(e5)}var e8=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,s,o=i.call(e),n=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)n.push(r.value)}catch(e){s={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(s)throw s.error}}return n},te=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},tt=function(){function e(e){this._entries=e?new Map(e):new Map}return e.prototype.getEntry=function(e){var t=this._entries.get(e);if(t)return Object.assign({},t)},e.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(e){var t=e8(e,2);return[t[0],t[1]]})},e.prototype.setEntry=function(t,i){var r=new e(this._entries);return r._entries.set(t,i),r},e.prototype.removeEntry=function(t){var i=new e(this._entries);return i._entries.delete(t),i},e.prototype.removeEntries=function(){for(var t,i,r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];var o=new e(this._entries);try{for(var n=te(r),a=n.next();!a.done;a=n.next()){var l=a.value;o._entries.delete(l)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(i=n.return)&&i.call(n)}finally{if(t)throw t.error}}return o},e.prototype.clear=function(){return new e},e}();function ti(e){return void 0===e&&(e={}),new tt(new Map(Object.entries(e)))}eI.instance();var tr="propagation",ts=new e1;(function(){function e(){this.createBaggage=ti,this.getBaggage=e4,this.getActiveBaggage=e9,this.setBaggage=e6,this.deleteBaggage=e7}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalPropagator=function(e){return eT(tr,e,eI.instance())},e.prototype.inject=function(e,t,i){return void 0===i&&(i=e2),this._getGlobalPropagator().inject(e,t,i)},e.prototype.extract=function(e,t,i){return void 0===i&&(i=e3),this._getGlobalPropagator().extract(e,t,i)},e.prototype.fields=function(){return this._getGlobalPropagator().fields()},e.prototype.disable=function(){eS(tr,eI.instance())},e.prototype._getGlobalPropagator=function(){return eO(tr)||ts},e})().getInstance(),!function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(D||(D={}));var to="0000000000000000",tn="00000000000000000000000000000000",ta={traceId:tn,spanId:to,traceFlags:D.NONE},tl=function(){function e(e){void 0===e&&(e=ta),this._spanContext=e}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.end=function(e){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(e,t){},e}(),tc=ec("OpenTelemetry Context Key SPAN");function tu(e){return e.getValue(tc)||void 0}function t_(){return tu(eL.getInstance().active())}function td(e,t){return e.setValue(tc,t)}function th(e){return e.deleteValue(tc)}function tg(e,t){return td(e,new tl(t))}function tE(e){var t;return null==(t=tu(e))?void 0:t.spanContext()}var tp=/^([0-9a-f]{32})$/i,tf=/^[0-9a-f]{16}$/i;function tm(e){var t,i;return t=e.traceId,tp.test(t)&&t!==tn&&(i=e.spanId,tf.test(i)&&i!==to)}function tT(e){return new tl(e)}var tO=eL.getInstance(),tS=function(){function e(){}return e.prototype.startSpan=function(e,t,i){if(void 0===i&&(i=tO.active()),null==t?void 0:t.root)return new tl;var r,s=i&&tE(i);return"object"==typeof(r=s)&&"string"==typeof r.spanId&&"string"==typeof r.traceId&&"number"==typeof r.traceFlags&&tm(s)?new tl(s):new tl},e.prototype.startActiveSpan=function(e,t,i,r){if(!(arguments.length<2)){2==arguments.length?n=t:3==arguments.length?(s=t,n=i):(s=t,o=i,n=r);var s,o,n,a=null!=o?o:tO.active(),l=this.startSpan(e,s,a),c=td(a,l);return tO.with(c,n,void 0,l)}},e}(),tC=new tS,tv=function(){function e(e,t,i,r){this._provider=e,this.name=t,this.version=i,this.options=r}return e.prototype.startSpan=function(e,t,i){return this._getTracer().startSpan(e,t,i)},e.prototype.startActiveSpan=function(e,t,i,r){var s=this._getTracer();return Reflect.apply(s.startActiveSpan,s,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):tC},e}(),ty=new(function(){function e(){}return e.prototype.getTracer=function(e,t,i){return new tS},e}()),tR=function(){function e(){}return e.prototype.getTracer=function(e,t,i){var r;return null!=(r=this.getDelegateTracer(e,t,i))?r:new tv(this,e,t,i)},e.prototype.getDelegate=function(){var e;return null!=(e=this._delegate)?e:ty},e.prototype.setDelegate=function(e){this._delegate=e},e.prototype.getDelegateTracer=function(e,t,i){var r;return null==(r=this._delegate)?void 0:r.getTracer(e,t,i)},e}(),tA="trace";let tw={context:eP,metrics:e0,trace:(function(){function e(){this._proxyTracerProvider=new tR,this.wrapSpanContext=tT,this.isSpanContextValid=tm,this.deleteSpan=th,this.getSpan=tu,this.getActiveSpan=t_,this.getSpanContext=tE,this.setSpan=td,this.setSpanContext=tg}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(e){var t=eT(tA,this._proxyTracerProvider,eI.instance());return t&&this._proxyTracerProvider.setDelegate(e),t},e.prototype.getTracerProvider=function(){return eO(tA)||this._proxyTracerProvider},e.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},e.prototype.disable=function(){eS(tA,eI.instance()),this._proxyTracerProvider=new tR},e})().getInstance()},tI=[k.ERROR_FULL_STACK,k.ERROR_LOG_METADATA,k.EVENT_URL],tN=[k.LOG_METADATA,k.ERROR_LOG_METADATA],tb=class extends Error{constructor(e,{network:t,retryable:i}={}){super(e),this.name="IngestAPIError",this.retryable=i??!0,this.network=t??!1}},tU=class e{_setVisibilityChangePromise(){this._windowVisibilityChangeHiddenPromise=new Promise(e=>{document.addEventListener("visibilitychange",()=>{this._useKeepaliveForFetch="visible"!==document.visibilityState,e()})})}static createInstance(t,i){return new e(t,i)}async initialized(){await this._initPromise}async shutdown(e=5e3){let t=Array.from(this._pendingRequests);0!==t.length&&(await Promise.race([Promise.allSettled(t),new Promise(t=>setTimeout(t,e))]),this._pendingRequests.clear())}_getHeaders(){return{"Content-Type":"application/json","x-api-key":this._config.ingestApiKey}}_adornSDMEvent(e){e[k.EVENT_GUID]=e[k.EVENT_GUID]||$(),e[k.EVENT_CATEGORY]=this._config.ingestAppCategory}_redactTokens(e){let t=/access_token=ey[0-9A-Za-z-._%=]+/g,i=/accessToken=ey[0-9A-Za-z-._%=]+/g,r=/Bearer ey[0-9A-Za-z-._%=]+/g;for(let i of tI)this._redactSingleToken(e,i,t,"access_token=XXaccess_token_redactedXX");for(let t of tN)this._redactSingleToken(e,t,r,"XXbearer_token_redactedXX"),this._redactSingleToken(e,t,i,"accessToken=XXaccess_token_redactedXX")}_redactSingleToken(e,t,i,r){if(e[t]){if("string"==typeof e[t]){e[t]=e[t].replace(i,r);return}for(let s in e[t])this._redactSingleToken(e[t],s,i,r)}}_wrapSDMData(e){let t={};return t[k.EVENT_PKG_INGEST_TYPE]=F.INGEST_TYPE,e[k.OVERRIDE_PKG_PROJECT]?(t[k.EVENT_PKG_PROJECT]=e[k.OVERRIDE_PKG_PROJECT],delete e[k.OVERRIDE_PKG_PROJECT]):t[k.EVENT_PKG_PROJECT]=this._config.ingestProject,t[k.EVENT_PKG_TIME]=e[k.EVENT_TIME_START]||new Date().toISOString(),t[k.EVENT_PKG_ENVIRONMENT]=this._config.envName,t[k.EVENT_PKG_DATA]=e,t}_addPromiseToArrayIfDefined(e,t){void 0!==t&&e.push(t)}sendEventData(e,t=!0){let i={headers:this._getHeaders(),body:{events:[]}};for(let t of e)this._adornSDMEvent(t),this._redactTokens(t),i.body.events.push(this._wrapSDMData(t));if(0===i.body.events.length)return Promise.resolve();let r="";try{r=JSON.stringify(i.body)}catch(e){return Promise.reject(new tb("JSON parsing an Ingest event body failed!",{retryable:!1}))}if(!1!==this._appStartupHasCompleted)return this._sendRequest(r,i,t);{let e=[new Promise(e=>{setTimeout(()=>{e()},this._appStartupCompleteTimeout)})];return this._addPromiseToArrayIfDefined(e,this._windowOnloadPromise),this._addPromiseToArrayIfDefined(e,this._windowBeforeUnloadPromise),this._addPromiseToArrayIfDefined(e,this._windowVisibilityChangeHiddenPromise),Promise.race(e).then(()=>(this._appStartupHasCompleted=!0,this._sendRequest(r,i,t)))}}_sendRequest(e,t,i=!0){let r=Date.now(),s=this._host.fetch(this._url.href,{method:"POST",keepalive:this._useKeepaliveForFetch,cache:es.default,credentials:eo.omit,headers:t.headers,redirect:en.follow,referrerPolicy:ea.noReferrer,body:e}).catch(e=>{throw new tb(`Network request failed: ${e}`,{network:!0})}).then(e=>{let t=Date.now()-r;if(this._ingestResponseCodesHistogram||(this._ingestResponseCodesHistogram=tw.metrics.getMeter(`${this._config?.ingestProject}_ingest_responses`).createHistogram("hz_ingest_response_duration",{advice:{explicitBucketBoundaries:[250,500,1e3,5e3,1e4,15e3,2e4,25e3,3e4]}})),this._ingestResponseCodesHistogram.record(t,{status:e.status}),!e.ok)throw new tb(`Network response was not ok: ${e.status}`,{network:!0})});return i&&(this._pendingRequests.add(s),s.then(()=>{this._pendingRequests.delete(s)},()=>{this._pendingRequests.delete(s)})),s}constructor(e,t){this._appStartupHasCompleted=!1,this._appStartupCompleteTimeout=3e3,this._useKeepaliveForFetch=!1,this._pendingRequests=new Set,this.sendEventData=this.sendEventData.bind(this),this._initPromise=Promise.all([t,e]).then(([e,t])=>{if(this._host=t,this._config=e,this._url=new URL("/ingest",this._config.ingestHost),!0===this._config.ingestWaitForAppStartup){if(this._host.executionEnvironment()!==el.Browser){this._useKeepaliveForFetch=!0;return}this._windowBeforeUnloadPromise=new Promise(e=>{window.addEventListener("beforeunload",()=>{this._useKeepaliveForFetch=!0,e()})}),"hidden"===document.visibilityState&&(this._appStartupHasCompleted=!0,this._useKeepaliveForFetch=!0),this._setVisibilityChangePromise(),"complete"===document.readyState?this._appStartupHasCompleted=!0:this._windowOnloadPromise=new Promise(e=>{window.addEventListener("load",()=>{e()})})}else this._appStartupHasCompleted=!0})}};var tD=function(e){return e.EXPERIMENTAL="experiments-resolution",e.BASELINE="baseline-resolution",e}({}),tL=function(e){return e.local="local",e.dev="dev",e.stage="stage",e.prod="prod",e}(tL||{}),tP=function(e){return e._example="_example-draft-1",e._test="_test-draft-1",e.debugComponentTransform="debug-component-transform-draft-1",e.interactions="interactions",e.variants="variants",e.stickyLayoutGrid="sticky-layout-grid-draft-1",e.filterFacelab="filter-facelab-draft-3",e.graphApiFilters="graph-api-filters-draft-1",e.neuralShapeEffects="neural-shape-effects-draft-1",e.charts="charts-draft-9",e.effectGraph="effect-graph-draft-2",e.animationClickSequences="animation-click-sequences-draft-3",e.catalyze="catalyze-draft-2",e.docInstructions="doc-instructions-draft-1",e}({});Object.values(tP);let tM=new Set(globalThis&&globalThis._hzTempDDMS||[]);var tF=function(e){return e.latest="latest",e.nonCurrent="non-current",e.rolledBack="rolled-back",e.expired="expired",e.invalidated="invalidated",e.unknown="unknown",e}({});class tx{get promise(){return this._promiseInUse=!0,this._promise}get isSettled(){return this._isFulfilled||this._isRejected}get isFulfilled(){return this._isFulfilled}get isRejected(){return this._isRejected}adopt(e){return this._promiseInUse=!0,e.then(this._resolvePromise).catch(this._rejectPromise),this.promise}adoptOnce(e){return this._promiseInUse=!0,this._hasAdoptedOnce||(this.adopt(e()),this._hasAdoptedOnce=!0),this.promise}resolve(e){this._resolvePromise(e)}reject(e){this._rejectPromise(e)}reset(){!this._isFulfilled&&!this._isRejected&&this._promiseInUse&&this._rejectPromise&&this._rejectPromise(new et("DeferredPromiseReset","Deferred was reset before result arrived")),this._isFulfilled=!1,this._isRejected=!1,this._hasAdoptedOnce=!1,this._promiseInUse=!1,this._promise=new Promise((e,t)=>{this._resolvePromise=t=>{this._isFulfilled=!0,this._isRejected=!1,e(t)},this._rejectPromise=e=>{this._isRejected=!0,this._isFulfilled=!1,t(e)}})}constructor(){this._isFulfilled=!1,this._isRejected=!1,this._hasAdoptedOnce=!1,this._promiseInUse=!1,this.reset()}}let tk=class{attach(e){this._appConfig instanceof tx&&this._appConfig.resolve(e),e.isLazySetting(this.name)&&(this._deferred=new tx),this._appConfig=e}get value(){if(this._appConfig instanceof tx){let e=`Setting not attached to appConfig: ${this.name}`;throw console.error("AppConfig","Setting",e),new et("Uninitialized",e,{logMetadata:{"custom.clientFatal":!0}})}if(this._deferred){let e=`This setting doesn't have a value yet, you should use getValue to wait for it: ${this.name}`;throw console.error("AppConfig","Setting",e),new et("Uninitialized",e,{logMetadata:{"custom.clientFatal":!0}})}return this._appConfig._getSettingValue(this.name)}async getValue(){return(this._appConfig instanceof tx&&await this._appConfig.promise,this._deferred&&this._valueProvider)?(this._deferred.adoptOnce(this._valueProvider),this._deferred.promise.then(e=>{delete this._deferred,this._appConfig._setSettingValue(this.name,e)}),this._deferred.promise):this.value}async initialized(){this._appConfig instanceof tx&&await this._appConfig.promise}constructor(e){this.name=e.name,this._appConfig=new tx}},tV=class extends tk{constructor(e,t){super({name:e,valueDefault:t})}},tB=class extends tk{constructor(e,t,i){super({name:e,valueDefault:t,envOverrides:i})}},tG=class extends tk{constructor(e){super({name:e})}},tW=new tV("floodgateApiKey",""),tz=new tV("floodgateClientId","horizon-platform"),tj=new tB("floodgateFeaturesUrl","https://p13n-stage.adobe.io/fg/api/v3/feature",{prod:"https://p13n.adobe.io/fg/api/v3/feature"}),tH=new tB("floodgateSandbox","xlg-stage",{prod:"xlg-prod"}),tK=new tV("floodgateOrgId","9E1005A551ED61CA0A490D45@AdobeOrg"),tY=new tV("rrEntryName",""),tX=new tV("rrEntryConfigName",""),tq=new tV("rrTrafficTargetName",""),t$=new tV("rrBuildSha",""),tQ=new tV("rrConfigSyncInterval",10),tJ=new tV("consoleLogLevel-AppConfig","info"),tZ=new tV("enabledLogLevel-AppConfig","info"),t0=new tV("enabledLogLevel-FloodgateConnector","info"),t1=new tV("consoleLogLevel-FloodgateConnector","info"),t3=new tV("max-age",3600),t2=new tV("s-maxage",60),t5={enabledLogLevelAppConfig:tZ,consoleLogLevelAppConfig:tJ,floodgateApiKey:tW,floodgateOrgId:tK,floodgateSandbox:tH,floodgateClientId:tz,floodgateFeaturesUrl:tj,rrEntryName:tY,rrEntryConfigName:tX,rrTrafficTargetName:tq,rrBuildSha:t$,rrConfigSyncInterval:tQ,enabledLogLevelFloodgateConnector:t0,consoleLogLevelFloodgateConnector:t1,cdnCacheMaxAge:t3,cdnCacheSMaxAge:t2,cdnCacheStaleWhileRevalidate:new tV("stale-while-revalidate",60),cdnCacheStaleIfError:new tV("stale-if-error",86400)};class t4{}t4.UI="ui",t4.AUTHORING="authoring",t4.RENDERING="rendering",t4.DEFAULT="default";class t9{static markBegin(e){let t=`${e.measureName}:begin`;performance.mark(t)}static markEndAndMeasure(e){let t=`${e.measureName}:end`;return performance.mark(t),performance.measure(e.measureName,t9._getMeasureDetail(e))}static _getMeasureDetail(e){let t={start:`${e.measureName}:begin`,end:`${e.measureName}:end`};return t.detail={devtools:{track:e.trackName||t9._getTrackName(),dataType:"track-entry",tooltipText:e.tooltipText||e.measureName}},t}static _getTrackName(){if(t9._isMainThread())return t4.UI;let e=t9._getThreadName();return e.includes("authoring")?t4.AUTHORING:e.includes("rendering")||e.includes("renderer")?t4.RENDERING:(console.warn("No track name found"),t4.DEFAULT)}static _isMainThread(){return"undefined"!=typeof window&&"undefined"!=typeof self&&self===window}static _getThreadName(){return"undefined"!=typeof self&&self.name?self.name:"undefined"!=typeof globalThis&&globalThis.threadName?globalThis.threadName:(console.warn("No thread name found"),"unknown")}}let t6=class{async getEnabledFeatures(e){return(await this._initPromise,this._apiKey&&0!==this._apiKey.length)?this._getAllEnabledFeatures(e):(this._categoryLogger?.warn("Not calling the Floodgate API because the API key is missing!"),{})}async _init(){this._host=await this._appConfig.getHost(),this._apiKey=t5.floodgateApiKey.value,this._clientId=t5.floodgateClientId.value,this._featuresUrl=t5.floodgateFeaturesUrl.value,this._fgOrgId=t5.floodgateOrgId.value,this._fgSandbox=t5.floodgateSandbox.value}async _getAllEnabledFeatures(e){try{let t=await this._callFeaturesApi(e);return this._extractFeaturesFromApiResponse(t)}catch(e){return this._categoryLogger?.warn("Caught error while trying to obtain FloodGate features",e),{}}}_extractFeaturesFromApiResponse(e){if(void 0===e.releases)return{};let t={};return e.releases.forEach(e=>{e.features.forEach(e=>t[e]=!0)}),t}async _callFeaturesApi(e){let t=this._getFeaturesUrl(),i=await this._getRequestHeaders(e),r={measureName:"floodgate-features-api"};t9.markBegin(r);let s=performance.now(),o=er(()=>this._host.fetch(t,{method:"GET",headers:i}),{maxAttempts:3,timeoutInterval:5e3,shouldRetry:e=>e.message.includes("Failed to fetch")}),n=await o();this._recordDuration(performance.now()-s);let a=t9.markEndAndMeasure(r);return this._categoryLogger?.debug("Floodgate API call duration: ",a?.duration,"ms"),await n.json()}_recordDuration(e){let t=this._appConfig.getOtelServiceName();t&&(this._histogramMeter||(this._histogramMeter=tw.metrics.getMeter(t).createHistogram("hz_prx_floodgate_api_duration_ms")),this._histogramMeter.record(e))}_getFeaturesUrl(){return`${this._featuresUrl}?clientId=${this._clientId}`}async _getRequestHeaders(e){let t={"x-api-key":this._apiKey,"Content-Type":"application/json","x-gw-ims-org-id":this._fgOrgId,"x-sandbox-name":this._fgSandbox};return void 0!==e&&(t.Authorization=`Bearer ${e}`),t}constructor(e){this._appConfig=e,this._appConfig.attach(t5),this._categoryLogger=this._appConfig.categoryLogger(),this._initPromise=this._init()}};class t7{static getInstance(e){return void 0===t7._instance&&(t7._instance=new t7(e)),t7._instance}_createFloodgateConnector(){return new t6(this._appConfig)}async syncNow(){return void 0===this._onDemandSyncPromise&&(this._onDemandSyncPromise=new Promise((e,t)=>{setTimeout(async()=>{try{await this._resyncFeatures(!1),e()}catch(e){t(e)}finally{this._onDemandSyncPromise=void 0}})})),this._onDemandSyncPromise}async getFeatureState(e){return(await this._initFloodgatePromise)[e]??!1}registerForUpdates(e,t){if(!0!==e.floodgateData.dynamic)throw Error(`Cannot register feature "${e.name}" for updates because it is not dynamic.`);this._updateListeners[e.name]=t,this._resyncScheduled||this._scheduleResync()}async _initEnabledFeatures(){let e=await this._getAccessToken(),t=await this._floodgateConnector.getEnabledFeatures(e);this._resolveFloodgateFeatures(t)}async _resyncFeatures(e=!0){let t=await this._getAccessToken();void 0===t&&this._appConfig?.categoryLogger()?.warn("AppConfig: Floodgate API will be called without an access token.");let i=await this._floodgateConnector.getEnabledFeatures(t);for(let e of Object.keys(this._updateListeners)){let t=i[e]??!1;try{this._updateListeners[e](t)}catch(i){this._appConfig?.categoryLogger()?.warn(`An error was caught when trying to update feature "${e}" with state "${t}":`,i)}}e&&this._scheduleResync()}_scheduleResync(){setTimeout(async()=>{this._resyncFeatures()},t7.RESYNC_INTERVAL),this._resyncScheduled=!0}async _getAccessToken(e=5e3){let t=new Promise((t,i)=>{setTimeout(()=>t(void 0),e)}),i=await Promise.race([t,this._appConfig.getAccessTokenProvider()]);if(void 0!==i){let e=await i.getAccessTokenValue();if(void 0===e)return e;let t=e.split(".");if(t&&3===t.length)try{let i=atob(t[1]),r=JSON.parse(i);return"guest"===r.atp?void 0:e}catch(e){}return e}this._appConfig?.categoryLogger()?.warn(`AppConfig: No IMS access token provider received in ${e} ms`)}constructor(e){this._resyncScheduled=!1,this._updateListeners={},this._appConfig=e,this._initFloodgatePromise=new Promise((e,t)=>{this._resolveFloodgateFeatures=e}),this._floodgateConnector=this._createFloodgateConnector(),this._initEnabledFeatures()}}t7.RESYNC_INTERVAL=3e5;var t8=function(e){return e.floodgate="Floodgate",e.override="Release Plane Override",e.code="config-interface.ts",e.experiment="Experiment",e.rollout="Progressive Feature Rollout",e}({});let ie=class{attach(e){if(this._appConfig instanceof tx&&this._appConfig.resolve(e),void 0!==this._cachedValue&&this.resetCachedValue(),this._appConfig=e,void 0===this._delayFeatureDetails){let e=this._appConfig.getUrlParams();e&&(this._delayFeatureDetails={logConsole:"true"===e.get("log-floodgate-to-console"),delayAllFloodgateFlags:"true"===e.get("delay-all-floodgate-flags"),delayedFlag:e.get("delay-flag")??""})}let t=(e.isPendingExperimentResolution(this.name)||e.isPendingRolloutResolution(this.name))&&void 0===this._pendingInitialization,i=e._getBrowserFlag(this.name);t&&void 0===i?(this._pendingInitialization=new tx,e.registerListener(this.name,e=>{void 0!==e&&this._featureUpdated()})):this._pendingInitialization?.isSettled&&delete this._pendingInitialization,this.initialized()}async isEnabled(){return await this.initialized(),this.enabled}get enabled(){if(this._pendingInitialization){let e=`The feature flag ${this.name} is not initialized yet, please check it asynchronously by using "initialized()"`;throw console.error("AppConfig","Feature",e),this._increaseErrorMetric(),new et("Uninitialized",e,{logMetadata:{"custom.clientFatal":!0}})}return this._getEnabled()}resetCachedValue(){this._cachedValue=void 0}_increaseErrorMetric(){if(!this._appConfig||this._appConfig instanceof tx)return;let e=this._appConfig.getOtelServiceName();if(!e)return;let t=this._appConfig.getSettingUnsafe("envName")??"unknown";tw.metrics.getMeter(e).createCounter("hz_prx_feature_flag_error_count").add(1,{featureFlagName:this.name,envName:t})}_getEnabled(){if(void 0!==this._cachedValue)return this._cachedValue;if(this._appConfig instanceof tx){let e="Feature not attached to appConfig: "+this.name;throw console.error("AppConfig","Feature",e),new et("Uninitialized",e,{logMetadata:{"custom.clientFatal":!0}})}let e=()=>void 0;this.floodgateData&&(e=()=>{if(!this.floodgateData.syncedWithFloodgate){let e="Floodgate features can not be checked before feature.initialized(), or await feature.isEnabled()";throw console.error("AppConfig","Feature",e),new et("Uninitialized",e,{logMetadata:{"custom.clientFatal":!0}})}return this.floodgateData.valueFromFloodgate});let t=this._appConfig._getFeatureEnabled(this.name,e);return this.floodgateData&&this.floodgateData.dynamic||(this._cachedValue=t),t}async initialized(){let e=[];return this._pendingInitialization&&e.push(this._pendingInitialization.promise),this.floodgateData&&(void 0===this.floodgateData.initFromFloodgatePromise&&(this.floodgateData.initFromFloodgatePromise=this._initializeFromFloodgate()),e.push(this._delayFeatureIfNeeded()),e.push(this.floodgateData.initFromFloodgatePromise)),Promise.all(e)}async _initializeFromFloodgate(){this._appConfig instanceof tx&&await this._appConfig.promise,this.floodgateData&&await this._syncWithFloodgate()}_featureUpdated(){this._pendingInitialization instanceof tx&&(this._pendingInitialization.resolve(!0),delete this._pendingInitialization),this._callbacks&&this._callbacks.forEach(e=>{e(this.enabled)})}onUpdate(e){this._callbacks=this._callbacks??[],this._callbacks.push(e)}get _floodgateSyncer(){return t7.getInstance(this._appConfig)}async _syncWithFloodgate(){this._appConfig instanceof tx&&await this._appConfig.promise;let e=this.floodgateData.floodgateKey??this.name;this.floodgateData.valueFromFloodgate=await this._floodgateSyncer.getFeatureState(e),this.floodgateData.syncedWithFloodgate=!0,this.floodgateData.dynamic&&(this._featureUpdated(),this._floodgateSyncer.registerForUpdates(this,e=>{this._updateFloodgateState(e)}))}_updateFloodgateState(e){let t=this.enabled;this.floodgateData.valueFromFloodgate=e,this.enabled!==t&&this._featureUpdated()}async _delayFeatureIfNeeded(){this._delayFeatureDetails&&(this._delayFeatureDetails.logConsole?console.log(`FloodgateFeature check ${this.name}`):(this._delayFeatureDetails.delayAllFloodgateFlags||this._delayFeatureDetails.delayedFlag===this.name)&&await new Promise(e=>setTimeout(e,5e3)))}constructor(e){this.name=e.name,e.checkFloodgate&&(this.floodgateData={syncedWithFloodgate:!1},e.floodgateKey&&(this.floodgateData.floodgateKey=e.floodgateKey),e.dynamic&&(this.floodgateData.dynamic=e.dynamic)),this._appConfig=new tx}},it=class extends ie{constructor(e,t){super({name:e,enabledDefault:!!t})}},ii=class{getFeatureFlagInformation(e){for(let{source:t,valueSource:i}of[{source:this._featuresFromExperiments,valueSource:t8.experiment},{source:this._featuresFromRollouts,valueSource:t8.rollout},{source:this.featureOverrides,valueSource:t8.override},{source:this._compiledAppConfig.floodgateFeatureNames,valueSource:t8.floodgate},{source:this._compiledAppConfig.featureValues,valueSource:t8.code}])if(void 0!==t[e])return{name:e,valueSource:i}}setStaticSettings(e){for(let t of Object.keys(e))this.settingOverrides[t]=e[t];this.initResolveSettingOverrides(this.settingOverrides)}setStaticFeatureFlags(e){for(let t of Object.keys(e))this.featureOverrides[t]=e[t];this.initResolveFeatureOverrides(this.featureOverrides)}initializeWithDataTransfer(e,t){this.sessionId=t.sessionId,t.ENABLED_DRAFT_FEATURE_FLAGS&&t.ENABLED_DRAFT_FEATURE_FLAGS.forEach(e=>{tM.has(e)||tM.add(e)}),this.initialize(t.buildInfo,e,t.compiledConfig,t.releasePlaneConfig,t.localConfig,t.featuresFromExperiments||{},void 0,t.featuresFromRollouts||{},!1)}setLoggerFactory(e){e().then(e=>{this.loggerInstance=e,this.categoryLoggerInstance=e.get("AppConfig")}).catch(console.error)}logger(){return this.loggerInstance}categoryLogger(){return this.categoryLoggerInstance}tryToLogFeatureFlag(e,t,i){this.categoryLoggerInstance?.trace("[AppConfig] Feature flag evaluated",{feature_flag:{key:e,provider_name:t,value:i}})}_notifyFeatureFlagListeners(e,t){t&&t.forEach(t=>t(e))}constructor(){this.featureOverrides={},this.settingOverrides={},this.experimentFeatureOverrides={},this.rolloutFeatureOverrides={},this._featuresFromExperiments={},this._featuresFromRollouts={},this._isExperimentationEnabled=!1,this._isPersonalizationEnabled=!1,this.sessionId=$(),this._initialized=!1,this.initPromiseSettingOverrides=new Promise(e=>{this.initResolveSettingOverrides=e}),this.initPromiseFeatureOverrides=new Promise(e=>{this.initResolveFeatureOverrides=e}),this.initPromiseExperimentFeatureOverrides=new Promise(e=>{this.initResolveExperimentFeatureOverrides=e}),this.initPromiseRolloutFeatureOverrides=new Promise(e=>{this.initResolveRolloutFeatureOverrides=e})}},ir="setting-",is="_hz_browser_flags",io="_hz_browser_settings";class ia{get localConfig(){return{features:{...this._localFeatures,...this._sessionFeatures},settings:{...this._localSettings,...this._sessionSettings}}}_extractFlagsAndSessionSettingsFromURLParams(e){try{e.has("feature-reset")&&(this._sessionFeatures={},this._sessionStorage?.removeItem(is)),this._setFeaturesFromUrlParam(e,"feature-enable",!0),this._setFeaturesFromUrlParam(e,"feature-disable",!1);let t={};e.forEach((e,i)=>{if(i.startsWith(ir)){let r=i.substring(ir.length),s=t[r];void 0===s||Array.isArray(s)?Array.isArray(s)?s.push(e):t[r]=this._parseSettingParam(e):t[r]=[String(s),e]}}),Object.keys(t).forEach(e=>{this._sessionSettings[e]=t[e]})}catch(e){console.warn("AppConfig","BrowserLocalConfig","error extracting feature flags and/or session settings overrides from URL params",e)}}_setFeaturesFromUrlParam(e,t,i){for(let r of e.getAll(t))for(let e of r.split(",")){let t=e.trim();t&&(this._sessionFeatures[t]=i)}}_parseSettingParam(e){let t=e.toLowerCase();return"true"===t||"false"!==t&&(isNaN(Number(e))?e:Number(e))}persistURLConfigToSessionStorage(){try{this._sessionStorage?.setItem(is,JSON.stringify(this._sessionFeatures)),this._sessionStorage?.setItem(io,JSON.stringify(this._sessionSettings))}catch(e){console.warn("AppConfig","BrowserLocalConfig","error persisting session config to session storage",e)}}clearSessionStorage(){try{this._sessionFeatures={},this._sessionSettings={},this._sessionStorage?.removeItem(is),this._sessionStorage?.removeItem(io)}catch(e){console.warn("AppConfig","BrowserLocalConfig","error clearing session storage",e)}}clearLocalStorage(){try{this._localFeatures={},this._localSettings={},this._localStorage?.removeItem(is),this._localStorage?.removeItem(io)}catch(e){console.warn("AppConfig","BrowserLocalConfig","error clearing local storage",e)}}clear(){this.clearSessionStorage(),this.clearLocalStorage()}setFeature(e,t,i){this.setFeatures({[e]:t},i)}setFeaturesToValue(e,t,i){let r={};e.forEach(e=>{r[e]=t}),this.setFeatures(r,i)}setFeatures(e,t){try{let i="session"===t?this._sessionFeatures:this._localFeatures;Object.assign(i,e);let r="session"===t?this._sessionStorage:this._localStorage;if(!r)return void console.warn("AppConfig","BrowserLocalConfig",`${t} storage is required to use setFeatures. in-memory setting only`);r.setItem(is,JSON.stringify(i))}catch(e){console.warn("AppConfig","BrowserLocalConfig",`error setting features in ${t} storage. in-memory setting only`,e)}}setSetting(e,t,i="session"){this.setSettings({[e]:t},i)}setSettings(e,t="session"){try{let i="session"===t?this._sessionSettings:this._localSettings;Object.assign(i,e);let r="session"===t?this._sessionStorage:this._localStorage;if(!r)return void console.warn("AppConfig","BrowserLocalConfig",`${t} storage is required to use setSettings. in-memory setting only`);r.setItem(io,JSON.stringify(i))}catch(e){console.warn("AppConfig","BrowserLocalConfig",`error setting settings in ${t} storage. in-memory setting only`,e)}}removeSettings(e,t="session"){try{let i="session"===t?this._sessionSettings:this._localSettings;e.forEach(e=>{delete i[e]});let r="session"===t?this._sessionStorage:this._localStorage;if(!r)return void console.warn("AppConfig","BrowserLocalConfig",`${t} storage is required to use removeSettings. in-memory removing only`);r.setItem(io,JSON.stringify(i))}catch(e){console.warn("AppConfig","BrowserLocalConfig",`error removing settings in ${t} storage`,e)}}get _localStorage(){try{return window.localStorage}catch(e){return}}get _sessionStorage(){try{return window.sessionStorage}catch(e){return}}_loadFromBrowserStorage(){this._localFeatures=this._loadFeaturesFromStorage("local"),this._localSettings=this._loadSettingsFromStorage("local"),this._sessionFeatures=this._loadFeaturesFromStorage("session"),this._sessionSettings=this._loadSettingsFromStorage("session");let e=this.localConfig;for(let t of Object.keys(e.features)){let i=this._sessionFeatures[t]?"session":"local";console.info("AppConfig","BrowserLocalConfig",`feature[${t}] = ${e.features[t]} (${i} storage)`)}for(let t of Object.keys(e.settings)){let i=this._sessionSettings[t]?"session":"local";console.info("AppConfig","BrowserLocalConfig",`setting[${t}] = ${e.settings[t]} (${i} storage)`)}}_loadFeaturesFromStorage(e){try{let t="session"===e?this._sessionStorage:this._localStorage;if(!t)return console.warn("AppConfig","BrowserLocalConfig",`${e} storage not available. Cannot load features`),{};let i=t.getItem(is);if(!i)return{};return JSON.parse(i)}catch(t){return console.warn("AppConfig","BrowserLocalConfig",`error loading features from ${e} storage`,t),{}}}_loadSettingsFromStorage(e){try{let t="session"===e?this._sessionStorage:this._localStorage;if(!t)return console.warn("AppConfig","BrowserLocalConfig",`${e} storage not available. Cannot load settings`),{};let i=t.getItem(io);if(!i)return{};return JSON.parse(i)}catch(t){return console.warn("AppConfig","BrowserLocalConfig",`error loading settings from ${e} storage`,t),{}}}constructor(e=new URLSearchParams(window.location.search)){this._localFeatures={},this._localSettings={},this._sessionFeatures={},this._sessionSettings={},this._loadFromBrowserStorage(),this._extractFlagsAndSessionSettingsFromURLParams(e)}}var il=function(e){return e.appConfig="app_config",e.browserFlags="browser_flags",e.expClient="exp_client",e.floodgate="floodgate",e.moduleConfig="module_config",e.releasePlane="release_plane",e.rollout="rollout",e}({});let ic=class extends ii{async initialize(e,t,i,r){this.buildInfo=e,this._setModuleOverrides(i),this.setStaticFeatureFlags({...i.featureValues,...r.features}),this.setStaticSettings({...i.settingValues,...r.settings}),this._isExperimentationEnabled=this.moduleSpecificFeatures["enable-experimentation"]||r.features["enable-experimentation"],this._isPersonalizationEnabled=this.moduleSpecificFeatures["enable-personalization"]||r.features["enable-personalization"],await this.initialized()}createModuleConfig(){throw Error("Method not implemented.")}_setModuleOverrides(e){for(let t of Object.keys(e.moduleSpecificFeatures))this.moduleSpecificFeatures[t]=e.moduleSpecificFeatures[t];for(let t of Object.keys(e.moduleSpecificSettings))this.moduleSpecificSettings[t]=e.moduleSpecificSettings[t];for(let t of Object.keys(e.moduleSpecificEnvSettings))this.moduleSpecificEnvSettings[t]=e.moduleSpecificEnvSettings[t]}async initialized(){await Promise.all([this.initPromiseFeatureOverrides,this.initPromiseSettingOverrides]),this._initialized=!0}async getWorkerDataTransfer(){await this.initialized();let{sessionId:e,buildInfo:t,compiledConfig:i,localConfig:r}=await this._appConfig.getWorkerDataTransfer();return{sessionId:e,buildInfo:t,featuresFromExperiments:{},featuresFromRollouts:{},compiledConfig:{settingValues:{...i.settingValues,...this.settingOverrides,...this.moduleSpecificSettings},featureValues:{...i.featureValues,...this.featureOverrides,...this.moduleSpecificFeatures},moduleSpecificSettings:this.moduleSpecificSettings,moduleSpecificEnvSettings:this.moduleSpecificEnvSettings,moduleSpecificFeatures:this.moduleSpecificFeatures,envSettings:i.envSettings,floodgateFeatureNames:i.floodgateFeatureNames,draftDocModelFeatureNames:i.draftDocModelFeatureNames,lazySettings:i.lazySettings},releasePlaneConfig:{features:{...this.featureOverrides,...this._appConfig.getRolloutFeatureOverrides(),...this._appConfig.getExperimentsFeatureOverrides(),...this.moduleSpecificFeatures},settings:{...this.settingOverrides,...this.moduleSpecificSettings}},localConfig:r,ENABLED_DRAFT_FEATURE_FLAGS:tM}}async getBasicWorkerDataTransfer(){await this.initialized();let{sessionId:e,buildInfo:t,compiledConfig:i,localConfig:r,featuresFromExperiments:s,featuresFromRollouts:o}=await this._appConfig.getBasicWorkerDataTransfer();return{sessionId:e,buildInfo:t,featuresFromExperiments:s,featuresFromRollouts:o,compiledConfig:{settingValues:{...i.settingValues,...this.settingOverrides,...this.moduleSpecificSettings},featureValues:{...i.featureValues,...this.featureOverrides,...this.moduleSpecificFeatures},moduleSpecificSettings:this.moduleSpecificSettings,moduleSpecificEnvSettings:this.moduleSpecificEnvSettings,moduleSpecificFeatures:this.moduleSpecificFeatures,envSettings:i.envSettings,floodgateFeatureNames:i.floodgateFeatureNames,draftDocModelFeatureNames:i.draftDocModelFeatureNames,lazySettings:i.lazySettings},releasePlaneConfig:{features:{...this.featureOverrides,...this.moduleSpecificFeatures},settings:{...this.settingOverrides,...this.moduleSpecificSettings}},localConfig:r,ENABLED_DRAFT_FEATURE_FLAGS:tM}}async hasFeature(e){if(!this._initialized){let e="ModuleConfig not initialized";throw this._appConfig?.categoryLogger()?.error("AppConfig","ModuleConfig",e),Error(e)}return"boolean"==typeof this.moduleSpecificFeatures[e]?this.moduleSpecificFeatures[e]:"boolean"==typeof this.featureOverrides[e]?this.featureOverrides[e]:this._appConfig.hasFeature(e)}whichEnginesEnabled(){return{experimentation:this._isExperimentationEnabled,personalization:this._isPersonalizationEnabled}}async attach(e){for(let t of Object.keys(e))e[t].attach(this),this._attachedConfigInterface.add(e[t]);return this.initialized()}detachConfiguration(){[...this._attachedConfigInterface].forEach(e=>{e.attach(this._appConfig)})}_getFeatureEnabled(e,t){if(!this._initialized){let e="ModuleConfig not initialized";throw this._appConfig?.categoryLogger()?.error("AppConfig","ModuleConfig",e),Error(e)}let i=this._appConfig._getBrowserFlag(e);if(void 0!==i)return this.tryToLogFeatureFlag(e,il.browserFlags,i),i;if("boolean"==typeof this.moduleSpecificFeatures[e])return this._appConfig.tryToLogFeatureFlag(e,il.moduleConfig,this.moduleSpecificFeatures[e]),this.moduleSpecificFeatures[e];let r=this.getFeatureValueFromExperiments(e);if(void 0!==r)return this._appConfig.tryToLogFeatureFlag(e,il.expClient,r),r;let s=this.getFeatureValueFromRolloutConfigurations(e);return void 0!==s?(this._appConfig.tryToLogFeatureFlag(e,il.rollout,s),s):"boolean"==typeof this.featureOverrides[e]?(this._appConfig.tryToLogFeatureFlag(e,il.moduleConfig,this.featureOverrides[e]),this.featureOverrides[e]):this._appConfig._getFeatureEnabled(e,t)}_getSettingValue(e){if(!this._initialized){let e="ModuleConfig not initialized";throw this._appConfig?.categoryLogger()?.error("AppConfig","ModuleConfig",e),Error(e)}let t=this._getEnvValue(this.moduleSpecificEnvSettings[e]);return void 0!==t?t:void 0!==this.moduleSpecificSettings[e]?this.moduleSpecificSettings[e]:void 0!==this.settingOverrides[e]?this.settingOverrides[e]:this._appConfig._getSettingValue(e)}async getFeaturesFromExperiments(){return this._appConfig.getFeaturesFromExperiments()}async getFeaturesOverrides(){return this.featureOverrides}async getEnabledFeaturesFromFloodgate(e){return this._appConfig.getEnabledFeaturesFromFloodgate(e)}resolvePendingExperimentFeatureFlags(){this._appConfig.resolvePendingExperimentFeatureFlags()}resolvePendingRolloutFeatureFlags(){this._appConfig.resolvePendingRolloutFeatureFlags()}getBrowserLocalConfig(){return this._appConfig.getBrowserLocalConfig()}async adoptDraftModelFlags(e){return this._appConfig.adoptDraftModelFlags(e)}async getAppDraftModelFlags(){return this._appConfig.getAppDraftModelFlags()}async getFeatures(e){return{...await this._appConfig.getFeatures(e),...this.featureOverrides,...this.moduleSpecificFeatures}}getSettings(){return this._appConfig.getSettings()}hasDraftFeature(e){return this._appConfig.hasDraftFeature(e)}updateFeaturesFromExperiments(e,t=!0){this._appConfig.updateFeaturesFromExperiments(e,t)}updateRolloutFeatures(e,t=!0){this._appConfig.updateRolloutFeatures(e,t)}_resetBrowserFlags(){let e="Method not implemented";throw this._appConfig?.categoryLogger()?.error("AppConfig","ModuleConfig",e),Error(e)}_setBrowserFlag(e,t,i,r){this._appConfig._setBrowserFlag(e,t,i,r)}_setBrowserSetting(e,t){this._appConfig._setBrowserSetting(e,t)}getLocalConfig(){return this._appConfig.getLocalConfig()}setLocalConfig(e){this._appConfig.setLocalConfig(e)}_setBrowserFlagList(e,t,i){this._appConfig._setBrowserFlagList(e,t,i)}setExperimentOverrides(e,t){this._appConfig.setExperimentOverrides(e,t)}setRolloutOverrides(e,t){this._appConfig.setRolloutOverrides(e,t)}registerListener(e,t){this._appConfig.registerListener(e,t)}isPendingExperimentResolution(e){return this._appConfig.isPendingExperimentResolution(e)}isPendingRolloutResolution(e){return this._appConfig.isPendingRolloutResolution(e)}_getEnvValue(e){return this._appConfig._getEnvValue(e)}getFloodgateKeyOrName(e){return this._appConfig.getFloodgateKeyOrName(e)}_getBrowserFlag(e){return this._appConfig._getBrowserFlag(e)}get _environment(){return this._appConfig._environment}async getHost(){return this._appConfig.getHost()}async getCurrentBuildState(){return this._appConfig.getCurrentBuildState()}getCurrentBuildStateSync(){return this._appConfig.getCurrentBuildStateSync()}addBuildStateObserver(e){return this._appConfig.addBuildStateObserver(e)}getFeatureOverrideValue(e){return this._appConfig.getFeatureOverrideValue(e)}getFeatureValueFromExperiments(e){return this._appConfig.getFeatureValueFromExperiments(e)}getFeatureValueFromRolloutConfigurations(e){return this._appConfig.getFeatureValueFromRolloutConfigurations(e)}getAccessTokenProvider(){return this._appConfig.getAccessTokenProvider()}setFactoryForAccessTokenProvider(e){this._appConfig.setFactoryForAccessTokenProvider(e)}syncWithFloodgate(){return this._appConfig.syncWithFloodgate()}persistAllBrowserFlags(){return this._appConfig.persistAllBrowserFlags()}isLazySetting(e){return this._appConfig.isLazySetting(e)}maybeRegisterSettingResolver(e,t){return this._appConfig.maybeRegisterSettingResolver(e,t)}getOtelServiceName(){return this._appConfig.getOtelServiceName()}getSettingUnsafe(e){return this._appConfig.getSettingUnsafe(e)}_setSettingValue(e,t){this._appConfig._setSettingValue(e,t)}setUrlParams(e){this._urlParams=e}getUrlParams(){return this._urlParams}async getExperimentsFeatureOverridesAsync(){return this._appConfig.getExperimentsFeatureOverridesAsync()}async getRolloutFeatureOverridesAsync(){return this._appConfig.getRolloutFeatureOverridesAsync()}constructor(e){super(),this._attachedConfigInterface=new Set,this._urlParams=new URLSearchParams,this.moduleSpecificFeatures={},this.moduleSpecificSettings={},this.moduleSpecificEnvSettings={},this._appConfig=e}};class iu{async ping(){return Promise.resolve("OK")}async getConfiguration(){let e=["/_rr_",this._rrEntryName,this._rrEntryConfigName,this._rrTrafficTargetName,this._bundleHash].join("/");return Promise.race([er(this._callRrApi.bind(this),{maxAttempts:iu.MAX_RETRIES,delay:iu.RETRY_DELAY})(e),new Promise((e,t)=>setTimeout(t,iu.TIMEOUT,"Timeout"))])}async _callRrApi(e){try{let t=await this._host.fetch(e);return await t.json()}catch(e){throw console.error(`Failed to get configuration from Request Router service. ${e}`),e}}constructor(e){this._host=e.host,this._bundleHash=e.bundleHash,this._rrEntryName=e.rrEntryName,this._rrEntryConfigName=e.rrEntryConfigName,this._rrTrafficTargetName=e.rrTrafficTargetName}}iu.MAX_RETRIES=3,iu.RETRY_DELAY=200,iu.TIMEOUT=3e3;class i_{static isConfigured(){return""!==t5.rrEntryName.value&&""!==t5.rrEntryConfigName.value&&""!==t5.rrTrafficTargetName.value&&""!==t5.rrBuildSha.value}async getDynamicConfig(){return await this._initializedPromise,this._rrsDynamicConfig}initAndScheduleSyncIfNeeded(){if(!i_.isConfigured())return void this._initializedPromiseResolver();setTimeout(async()=>{await this._setConfiguration(),this._initializedPromiseResolver(),this._scheduleDynamicConfigSync()},7e4)}async getBuildState(e){return await this._initializedPromise,this.getBuildStateSync(e)}getBuildStateSync(e){return void 0===this._rrsDynamicConfig||void 0===this._rrsDynamicConfig.builds||void 0===this._rrsDynamicConfig.builds[e]?tF.unknown:this._rrsDynamicConfig.builds[e].state}addBuildStateObserver(e,t){this._buildStateObservers.set(e,t),this._rrsDynamicConfig&&this._rrsDynamicConfig.builds[e]&&t(this._rrsDynamicConfig.builds[e].state)}_scheduleDynamicConfigSync(){setInterval(this._setConfiguration,60*t5.rrConfigSyncInterval.value*1e3)}constructor(e){if(this._buildStateObservers=new Map,this._setConfiguration=async()=>{try{let e=this._rrsDynamicConfig;for(let[t,i]of(this._rrsDynamicConfig=await this._rrApiClient.getConfiguration(),this._buildStateObservers.entries())){let r=this._rrsDynamicConfig?.builds[t]?.state;e?.builds[t]?.state!==r&&i(r)}}catch(e){console.error("AppConfig","RrsDynamicConfig","Error while syncing dynamic config",e)}},this._initializedPromise=new Promise(e=>{this._initializedPromiseResolver=e}),!i_.isConfigured()){console.info("AppConfig","RrsDynamicConfig","At least one of the required settings is missing. Skipping heartbeat initialization."),this._initializedPromiseResolver();return}this._host=e,this._rrApiClient=new iu({rrEntryName:t5.rrEntryName.value,rrEntryConfigName:t5.rrEntryConfigName.value,rrTrafficTargetName:t5.rrTrafficTargetName.value,bundleHash:t5.rrBuildSha.value,host:this._host})}}let id=class e extends ii{static singleton(){return e._singleton||(e._singleton=new e),e._singleton}static async createInitializeAttach(t,i,r,s,o,n,a,l,c){let u=new e;return await u.initialize(t,i,r,s,o,a,l,c),n&&u.attach(n),u}createModuleConfig(){return new ic(this)}registerListener(e,t){void 0===this._updateListeners[e]?this._updateListeners[e]=[t]:this._updateListeners[e]=[...this._updateListeners[e],t]}isPendingExperimentResolution(e){return void 0!==this._pendingExperimentsFeatureFlags[e]}isPendingRolloutResolution(e){return void 0!==this._pendingRolloutConfigurationsFeatureFlags[e]}async getFeaturesFromExperiments(){return await this.initialized(),this._featuresFromExperiments}async getFeaturesOverrides(){await Promise.allSettled([this.initialized(),this._experimentsInitialized(),this._rolloutConfigurationsInitialized()]);let e={},t=t7.getInstance(this);for(let i in this._compiledAppConfig.floodgateFeatureNames)e[i]=await t.getFeatureState(i);return{...e,...this.featureOverrides,...this.rolloutFeatureOverrides,...this.experimentFeatureOverrides}}getBrowserLocalConfig(){return this._browserLocalConfig}_getEnvValue(e){if(void 0!==e){if(!this._initializedEnv){let e="Checking environmental config can only be done after appConfig.initialized()";throw console.error("AppConfig",e),Error(e)}return void 0!==e.envOverrides[this._initializedEnv]?e.envOverrides[this._initializedEnv]:e.default}}_getSettingValue(e){if(!this._initialized)throw console.error("AppConfig","Checking setting config can only be done after appConfig.initialize(..)"),Error("Checking setting config can only be done after appConfig.initialize(..)");let t=this._localConfig.settings[e];if(void 0!==t)return t;if(void 0!==this.settingOverrides[e])return this.settingOverrides[e];let i=this._getEnvValue(this._compiledAppConfig.envSettings[e]);if(void 0!==i)return i;let r=this._compiledAppConfig.settingValues[e];if(void 0!==r)return r;throw Error("Static config not found: "+e)}_setSettingValue(e,t){this._lazySettings?.get(e)!==void 0&&this._lazySettings.delete(e),this.settingOverrides[e]=t,this._lazySettings?.get(e)!==void 0&&this._lazySettings.delete(e),this._requiredSettingsResolvers.has(e)&&(this._requiredSettingsResolvers.get(e)(t),this._requiredSettingsResolvers.delete(e))}_getBrowserFlag(e){return this._localConfig.features[e]}async getLocalConfig(){return await this.initialized(),this._localConfig}setLocalConfig(e){this._localConfig=e}getFeatureOverrideValue(e){return"boolean"==typeof this.featureOverrides[e]?this.featureOverrides[e]:void 0}getFeatureValueFromExperiments(e){return"boolean"==typeof this.experimentFeatureOverrides[e]?this.experimentFeatureOverrides[e]:void 0}getFeatureValueFromRolloutConfigurations(e){return"boolean"==typeof this.rolloutFeatureOverrides[e]?this.rolloutFeatureOverrides[e]:void 0}_getFeatureEnabled(e,t){if(!this._initialized){let e="Checking feature config can only be done after appConfig.initialize(..)";throw console.error("AppConfig",e),Error(e)}if("boolean"==typeof this._localConfig.features[e])return this.tryToLogFeatureFlag(e,il.browserFlags,this._localConfig.features[e]),this._localConfig.features[e];let i=this.getFeatureValueFromExperiments(e);if(void 0!==i)return this.tryToLogFeatureFlag(e,il.expClient,i),i;if("boolean"==typeof this.rolloutFeatureOverrides[e])return this.tryToLogFeatureFlag(e,il.rollout,this.rolloutFeatureOverrides[e]),this.rolloutFeatureOverrides[e];if("boolean"==typeof this.featureOverrides[e])return this.tryToLogFeatureFlag(e,il.releasePlane,this.featureOverrides[e]),this.featureOverrides[e];let r=t();return"boolean"==typeof r?(this.tryToLogFeatureFlag(e,il.floodgate,r),r):(this.tryToLogFeatureFlag(e,il.appConfig,!!this._compiledAppConfig.featureValues[e]),!!this._compiledAppConfig.featureValues[e])}async initialize(e,t,i,r,s,o,n,a,l=!0){if(this._initialized)return void console.warn("AppConfig","AppConfig is already initialized, not doing anything");this.attach(t5),this.buildInfo=e,this._host=t,void 0!==s?this._localConfig=s:this._host.sessionStorage()&&(this._browserLocalConfig=this._createBrowserLocalConfig(this._host.searchParams()??new URLSearchParams),this._localConfig=this._browserLocalConfig.localConfig),this._isExperimentationEnabled=this._localConfig.features["enable-experimentation"]||r.features["enable-experimentation"],this._isPersonalizationEnabled=this._localConfig.features["enable-personalization"]||r.features["enable-personalization"],this._compiledAppConfig=i,this._featuresFromExperiments=o||{},this._featuresFromRollouts=a||{},this._isPersonalizationEnabled&&(this._pendingRolloutConfigurationsFeatureFlags={...a}),0===Object.keys(this._featuresFromRollouts).length&&this.initResolveRolloutFeatureOverrides(),0===Object.keys(this._featuresFromExperiments).length&&this.initResolveExperimentFeatureOverrides(),void 0!==r.features["appconfig-wait-for-experiments"]&&(this._waitForExperimentsAndRollouts=r.features["appconfig-wait-for-experiments"]),0===Object.keys(this._featuresFromExperiments).length&&0===Object.keys(this._featuresFromRollouts).length&&(this._waitForExperimentsAndRollouts=!1),this._setStaticFeatureOverrides(r.features),this._configureExperimentsFeatureFlags(r,n),i.lazySettings.length>0&&(this._lazySettings=new Map,i.lazySettings.forEach(e=>{this._lazySettings.set(e,e)})),this._setStaticSettingOverrides(r.settings),await this.initialized(),l&&this._scheduleDynamicConfigSync()}isLazySetting(e){return this._lazySettings?.get(e)!==void 0}_createBrowserLocalConfig(e){return new ia(e)}_isExperimentsFeatureFlagResolutionEnabled(e){return void 0!==e.settings["experiments-feature-flag-strategy"]?e.settings["experiments-feature-flag-strategy"]!==tD.BASELINE:"string"!=typeof e.settings.env||e.settings.env!==tL.stage}_configureExperimentsFeatureFlags(e,t){if(this._isExperimentationEnabled&&(this._pendingExperimentsFeatureFlags={...this._featuresFromExperiments},t)){let i=this._isExperimentsFeatureFlagResolutionEnabled(e)?t():{};this.experimentFeatureOverrides={...this.experimentFeatureOverrides,...i}}}_scheduleDynamicConfigSync(){i_.isConfigured()&&(this._rrsDynamicConfig=new i_(this._host),this._rrsDynamicConfig.initAndScheduleSyncIfNeeded())}async initialized(){this._initialized||(await Promise.all([this.initPromiseFeatureOverrides,this.initPromiseSettingOverrides]),this._initialized=!0)}updateFeaturesFromExperiments(e,t=!0){for(let i of Object.keys(e))void 0!==this._featuresFromExperiments[i]&&(t&&(this.experimentFeatureOverrides[i]=e[i]),this._notifyFeatureFlagListeners(i,this._updateListeners[i]),delete this._pendingExperimentsFeatureFlags[i]);0===Object.keys(this._pendingExperimentsFeatureFlags).length&&this.initResolveExperimentFeatureOverrides()}updateRolloutFeatures(e,t=!0){for(let i of Object.keys(e))void 0!==this._pendingRolloutConfigurationsFeatureFlags[i]&&(t&&(this.rolloutFeatureOverrides[i]=e[i]),this._notifyFeatureFlagListeners(i,this._updateListeners[i]),delete this._pendingRolloutConfigurationsFeatureFlags[i]);0===Object.keys(this._pendingRolloutConfigurationsFeatureFlags).length&&this.initResolveRolloutFeatureOverrides()}resolvePendingRolloutFeatureFlags(){for(let e in this._pendingRolloutConfigurationsFeatureFlags)void 0!==this._pendingRolloutConfigurationsFeatureFlags[e]&&delete this.rolloutFeatureOverrides[e],delete this.rolloutFeatureOverrides[e],this._notifyFeatureFlagListeners(e,this._updateListeners[e]),delete this._pendingRolloutConfigurationsFeatureFlags[e];this.initResolveRolloutFeatureOverrides()}resolvePendingExperimentFeatureFlags(){for(let e in this._pendingExperimentsFeatureFlags)void 0!==this._pendingExperimentsFeatureFlags[e]&&delete this.experimentFeatureOverrides[e],this._notifyFeatureFlagListeners(e,this._updateListeners[e]),delete this._pendingExperimentsFeatureFlags[e];this.initResolveExperimentFeatureOverrides()}whichEnginesEnabled(){let e={experimentation:!1,personalization:!1};return this._waitForExperimentsAndRollouts&&(e.experimentation=this._isExperimentationEnabled,e.personalization=this._isPersonalizationEnabled),e}_experimentsInitialized(){return this.initPromiseExperimentFeatureOverrides}_rolloutConfigurationsInitialized(){return this.initPromiseRolloutFeatureOverrides}async getHost(){return this.initPromiseSettingOverrides.then(()=>this._host)}async getEnabledFeaturesFromFloodgate(e){return void 0===this._floodgateConnector&&(this._floodgateConnector=new t6(this)),this._floodgateConnector.getEnabledFeatures(e)}async syncWithFloodgate(){return await this.initialized(),t7.getInstance(this).syncNow()}setFactoryForAccessTokenProvider(e){this._atpFactoryResolver(e)}async getAccessTokenProvider(){return(await this._atpFactoryPromise)()}async attach(e){if(e[this._attachMarker])return this.initialized();for(let t of(e[this._attachMarker]=!0,Object.keys(e)))e[t].attach(this);return this.initialized()}setUrlParams(e){this._urlParams=e}getUrlParams(){return this._urlParams}maybeRegisterSettingResolver(e,t){return this._lazySettings?.get(e)!==void 0&&(this._requiredSettingsResolvers.set(e,t),!0)}get _environment(){if(!this._initializedEnv){let e="appConfig._environment can only be checked synchronously after awaiting appConfig.initialize()";throw console.error("AppConfig",e),Error(e)}return this._initializedEnv}_setStaticSettingOverrides(e){let t,i;if("string"==typeof e.env){if(t=e.env,!Object.keys(tL).includes(t))throw console.error("AppConfig",i=`Invalid AppConfig settings override.  Unsupported 'env' value provided = ${t}`),Error(i);this._initializedEnv=t}else throw console.error("AppConfig",i="Invalid AppConfig settings override does not include required 'env'."),Error(i);if("string"!=typeof e.envName)throw console.error("AppConfig",i="Invalid AppConfig settings override does not include required 'envName'."),Error(i);super.setStaticSettings(e)}async getSettings(){await this.initialized();let e={};for(let t of Object.keys(this._compiledAppConfig.settingValues))e[t]=this._compiledAppConfig.settingValues[t];for(let t of Object.keys(this._compiledAppConfig.envSettings)){let i=this._getEnvValue(this._compiledAppConfig.envSettings[t]);void 0!==i&&(e[t]=i)}for(let t of Object.keys(this.settingOverrides))e[t]=this.settingOverrides[t];for(let t of Object.keys(this._localConfig.settings))e[t]=this._localConfig.settings[t];return e}async hasDraftFeature(e){return await this.initialized(),this._localConfig.features[e]??tM.has(e)}async getFeatures(e=!0){if(await this.initialized(),!this._cachedFeaturesWithoutDraft){let e={};for(let t of Object.keys(this._compiledAppConfig.featureValues))e[t]=this._compiledAppConfig.featureValues[t];for(let t of Object.keys(this.featureOverrides))e[t]=this.featureOverrides[t];for(let t of Object.keys(this._localConfig.features))e[t]=this._localConfig.features[t];this._cachedFeaturesWithoutDraft=e}if(!1===e)return this._cachedFeaturesWithoutDraft;if(!this._cachedFeaturesWithDraft){let e={...this._cachedFeaturesWithoutDraft};for(let t of this._compiledAppConfig.draftDocModelFeatureNames)e[t]&&!this._localConfig.features[t]&&(e[t]=!1),void 0!==t&&tM.has(t)&&(e[t]=!0);this._cachedFeaturesWithDraft=e}return this._cachedFeaturesWithDraft}async getWorkerDataTransfer(){await this.initialized();let e=await this.getBasicWorkerDataTransfer();return this._waitForExperimentsAndRollouts&&(await Promise.all([this._experimentsInitialized(),this._rolloutConfigurationsInitialized()]),e.releasePlaneConfig.features={...this.featureOverrides,...this.rolloutFeatureOverrides,...this.experimentFeatureOverrides},e.featuresFromExperiments={},e.featuresFromRollouts={}),e}async getBasicWorkerDataTransfer(){return await this.initialized(),{sessionId:this.sessionId,buildInfo:JSON.parse(JSON.stringify(this.buildInfo)),compiledConfig:this._compiledAppConfig,releasePlaneConfig:{settings:this.settingOverrides,features:{...this.featureOverrides,...this.experimentFeatureOverrides}},featuresFromExperiments:this._featuresFromExperiments,featuresFromRollouts:this._featuresFromRollouts,localConfig:this._localConfig,ENABLED_DRAFT_FEATURE_FLAGS:tM}}_setStaticFeatureOverrides(e){super.setStaticFeatureFlags(e)}async hasFeature(e){return!!(await this.getFeatures())[e]}async _resetBrowserFlags(){this._browserLocalConfig?.clearSessionStorage()}_setBrowserFlag(e,t,i=!1,r=!1){this._browserLocalConfig?.setFeature(e,t,"session"),i&&(this._localConfig=this._browserLocalConfig?.localConfig??this._localConfig),r&&(this._cachedFeaturesWithDraft=void 0,this._cachedFeaturesWithoutDraft=void 0),this.categoryLoggerInstance?.info("Success - flag set locally in this browser.")}_setBrowserFlagList(e,t,i=!1){this._browserLocalConfig?.setFeaturesToValue(e,t,"session"),i&&(this._cachedFeaturesWithDraft=void 0,this._cachedFeaturesWithoutDraft=void 0),this.categoryLoggerInstance?.info("Success - flag set locally in this browser.")}async _setBrowserSetting(e,t){this._browserLocalConfig?.setSetting(e,t,"session"),this.categoryLoggerInstance?.info("Success - setting set locally in this browser.")}setExperimentOverrides(e,t=!1){this.experimentFeatureOverrides={...this.experimentFeatureOverrides,...e},t&&(this._cachedFeaturesWithDraft=void 0,this._cachedFeaturesWithoutDraft=void 0)}setRolloutOverrides(e,t=!1){this.rolloutFeatureOverrides={...this.rolloutFeatureOverrides,...e},t&&(this._cachedFeaturesWithDraft=void 0,this._cachedFeaturesWithoutDraft=void 0)}getFloodgateKeyOrName(e){if(!this._initialized)throw Error("Checking feature values can only be done after appConfig.initialize(..)");return this._compiledAppConfig.floodgateFeatureNames[e]??void 0}async getAppDraftModelFlags(){await this.initialized();let e=this._localConfig.features;return Object.values(tP).filter(t=>e[t]??tM.has(t))}async adoptDraftModelFlags(e){if(!this._browserLocalConfig)return!1;let t={};for(let i of e)t[i]=!0;for(let i of(await this.getAppDraftModelFlags()))e.includes(i)||(t[i]=!1);return this._browserLocalConfig.setFeatures(t,"session"),!0}async persistAllBrowserFlags(){await this.initialized(),this._browserLocalConfig?.persistURLConfigToSessionStorage()}async getCurrentBuildState(){return(await this.initialized(),void 0===this._rrsDynamicConfig)?tF.unknown:this._rrsDynamicConfig.getBuildState(t5.rrBuildSha.value)}getCurrentBuildStateSync(){return void 0===this._rrsDynamicConfig?tF.unknown:this._rrsDynamicConfig.getBuildStateSync(t5.rrBuildSha.value)}addBuildStateObserver(e){this._rrsDynamicConfig?.addBuildStateObserver(t5.rrBuildSha.value,e)}getOtelServiceName(){return this.getSettingUnsafe("serviceName")}getSettingUnsafe(e){if(this._initialized)try{return this._getSettingValue(e)}catch(e){return}}getExperimentsFeatureOverrides(){return this.experimentFeatureOverrides}async getExperimentsFeatureOverridesAsync(){return await this._experimentsInitialized(),this.getExperimentsFeatureOverrides()}getRolloutFeatureOverrides(){return this.rolloutFeatureOverrides}async getRolloutFeatureOverridesAsync(){return await this._rolloutConfigurationsInitialized(),this.getRolloutFeatureOverrides()}constructor(){super(),this._urlParams=new URLSearchParams,this._requiredSettingsResolvers=new Map,this._pendingExperimentsFeatureFlags={},this._pendingRolloutConfigurationsFeatureFlags={},this._updateListeners={},this._waitForExperimentsAndRollouts=!0,this._localConfig={features:{},settings:{}},this._browserLocalConfig=void 0,this._cachedFeaturesWithDraft=void 0,this._cachedFeaturesWithoutDraft=void 0,this._atpFactoryPromise=new Promise(e=>{this._atpFactoryResolver=e}),this._attachMarker=Symbol("app-config-attach-marker"),"undefined"!=typeof window&&window&&this.setUrlParams(new URLSearchParams(window.location.search))}};class ih{async shutdown(){await this._initializedPromise,clearInterval(this._queueIntervalHandle),this._queueIntervalHandle=void 0,await this._processQueueAsync()}async start(e){this._initializedPromise=this._processOnceInitialized(e),await this._initializedPromise}async _processOnceInitialized(e){this._isInitialized=!0,this._queueIntervalHandle=setInterval(()=>{this._processQueue()},e),this._processQueue()}async initialized(){return this._initializedPromise}_isLowPriority(e){return e[k.LOG_LEVEL]!==F.LOG_LEVEL_ERROR}_isOverflow(){return this._events.length>this._maxQueueLength}_handleOverflow(){this._overflowedEventsCount++;let e=!1;for(let t=0;t<this._events.length;t++)if(this._isLowPriority(this._events[t])){e=!0,console.warn("EventQueue overflow with High Priority Event, dropping log event below error level."),this._events.splice(t,1);break}e||(console.error("EventQueue overflow, dropping important event."),this._events.shift())}queueEventData(e){this._events.push(e),this._isOverflow()&&this._handleOverflow(),this._isInitialized&&this._events.length>=this._batchSize&&this._processQueue()}async _processQueueAsync(){if(this._queueIsSending)return this._queueIsSending.promise;if(this._events.length){for(this._queueIsSending=new tx;this._events.length>0;)try{let e=this._events.slice(0,Math.min(this._events.length,this._batchSize));await this._eventDeliveryFunction(e),this._events.splice(0,Math.min(e.length,this._batchSize))}catch(e){console.error("EventQueue: encountered an error trying to send events to Ingest",e);break}this._queueIsSending.resolve(),this._queueIsSending=void 0}}_processQueue(){this._queueIsSending||this._processQueueAsync()}get maxQueueLength(){return this._maxQueueLength}set maxQueueLength(e){this._maxQueueLength=e}get batchSize(){return this._batchSize}set batchSize(e){this._batchSize=e}get overflowedEventsCount(){return this._overflowedEventsCount}get queueIsSendingPromise(){return this._queueIsSending?.promise}get queueLength(){return this._events.length}constructor(e){this._eventDeliveryFunction=e,this._maxQueueLength=500,this._batchSize=10,this._isInitialized=!1,this._overflowedEventsCount=0,this._events=[]}}var ig=function(e){return e[e.offline=0]="offline",e[e.online=1]="online",e}({});class iE{_updateNetworkState(e){this._currentState!==e&&(this._currentState=e,this._networkStateCallback?.(this.onLine))}get onLine(){return 1===this._currentState}setNetworkStateCallback(e){this._networkStateCallback=e}constructor(){this._currentState=1}}class ip{async shutdown(e=!0){this._waitForQueueToFlush=e,await this._initializedPromise,await this._eventQueue.shutdown(),await this._ingestService.shutdown(),this._waitForQueueToFlush=!0}async _processOnceInitialized(){await this._ingestService.initialized();let e=await this._configPromise;this._eventQueue.maxQueueLength=e.analyticsBufferLimit,await this._eventQueue.start(e.ingestProcessingInterval)}async initialized(){return this._initializedPromise}queueEventData(e){this._eventQueue.queueEventData(e)}async _eventQueueDeliveryFunction(e){let t=e=>!!this._waitForQueueToFlush&&(e instanceof tb&&e.network&&this._callback(ig.offline),!(e instanceof tb)||!1!==e.retryable),i={maxAttempts:this._waitForQueueToFlush?3:1,shouldRetry:t,delay:500},r=er(this._ingestService.sendEventData,i);this._waitForQueueToFlush?await r(e):this._ingestService.sendEventData(e),this._callback(ig.online)}constructor(e,t,i){this._callback=i,this._waitForQueueToFlush=!0,this._configPromise=t,this._ingestService=tU.createInstance(e,t.then(e=>e.ingestConfig)),this._eventQueue=new ih(this._eventQueueDeliveryFunction.bind(this)),this._initializedPromise=this._processOnceInitialized()}}var im=function(e){return e.Windows="Windows",e.ChromeOS="ChromeOS",e.Linux="Linux",e.Mac="Mac",e.iOS="iOS",e.iPadOS="iPadOS",e.Android="Android",e.Unknown="Unknown",e}({}),iT=function(e){return e.Chrome="Chrome",e.Firefox="Firefox",e.Edge="Edge",e.Safari="Safari",e.Samsung="Samsung",e.WebKitBased="WebKitBased",e.WebView="NA",e.Unknown="Unknown",e}({}),iO=function(e){return e.low="low",e.medium="medium",e.high="high",e}({}),iS=function(e){return e.MobileWeb="mobile-web",e.DesktopWeb="desktop-web",e.iOSApp="ios-app",e.iPadOSApp="ipad-app",e.ChromeOSApp="chrome-app",e.AndroidApp="android-app",e}({}),iC=function(e){return e.DesktopWeb="desktop-web-browser",e.DesktopPWA="desktop-web-pwa",e.MobileWebAndroid="mobile-web-android",e.MobileWebIOS="mobile-web-iOS",e.MobileWebIPadOS="mobile-web-ipadOS",e.iOSApp="mobile-app-iOS",e.iPadOSApp="mobile-app-ipadOS",e.AndroidApp="mobile-app-android",e.DesktopShell="desktop-shell",e}({});let iv={[iT.Edge]:/(?:Edge|Edg(?:A|iOS)?)\/(\d+\.[\d.]+)/,[iT.Firefox]:/(?:Firefox|FxiOS)\/(\d+(\.\d+)?)/,[iT.Chrome]:/(?:Chrome|CriOS)\/(\d+\.[\d.]+)/,[iT.Safari]:/version\/(\d+(\.?_?\d+)+)/i,[iT.Samsung]:/(?:SamsungBrowser)\/(\d+\.[\d.]+)/},iy={[im.Windows]:/Windows NT (\d+\.\d+)/,[im.Mac]:/Mac OS X (\d+([._]\d+)*)/,[im.iOS]:/OS (\d+([._]\d+)*)/,[im.iPadOS]:/OS (\d+([._]\d+)*)/,[im.Android]:/Android (\d+(\.\d+)*)/,[im.ChromeOS]:/CrOS(?: [a-z0-9-_.]+)? (\d+(\.\d+)*)/};class iR{get deviceOs(){return this._deviceOs??(this._deviceOs=this._getDeviceOS())}get deviceModel(){return this._deviceModel??(this._deviceModel=this._getDeviceModel())}get deviceOsVersion(){return this._deviceOsVersion??(this._deviceOsVersion=this._getDeviceOSVersion())}async deviceOsVersionNumber(){let e=await this._navigator.userAgentData?.getHighEntropyValues?.(["platformVersion"]);return e?.platformVersion||this.deviceOsVersion}get webBrowser(){return this._webBrowser??(this._webBrowser=this._getWebBrowser())}get webBrowserVersion(){return this._webBrowserVersion??(this._webBrowserVersion=this._getWebBrowserVersion())}get platformIsMacLike(){return this.deviceOs===im.Mac||this.deviceOs===im.iOS}get isMacDevice(){return this.deviceOs===im.Mac}get isAndroidDevice(){return this.deviceOs===im.Android}get isLinuxDevice(){return this.deviceOs===im.Linux}get isIOSDevice(){return this.deviceOs===im.iOS}get isIPadOSDevice(){return this.deviceOs===im.iPadOS}get isChromeOSDevice(){return this.deviceOs===im.ChromeOS}get isMobile(){return this.isIOSDevice||this.isAndroidDevice}get isChromeBrowser(){return this.webBrowser===iT.Chrome}get isFirefoxBrowser(){return this.webBrowser===iT.Firefox}get isEdgeBrowser(){return this.webBrowser===iT.Edge}get isSafariBrowser(){return this.webBrowser===iT.Safari}get isSamsungBrowser(){return this.webBrowser===iT.Samsung}get isWebKitBrowser(){return this.webBrowser===iT.Safari||this.webBrowser===iT.WebKitBased}get isMobileWeb(){return this.isMobile&&!this.isMobileWebView}get isMsftPWA(){return this._getMsftPWA()}get isNonMsftPWA(){return this._getNonMsftPWA()}get isDesktopShellApp(){return this._getDesktopShellApp()}get PWAInstallationSource(){return this._getWithinExpressPWAInstallation()?"within-express":this.isMsftPWA?"msstore":this.isNonMsftPWA?"browser":"NA"}isWindowAvailable(){return"undefined"!=typeof window&&void 0!==window.location}get isEmbed(){return!!this.isWindowAvailable()&&"true"===new URL(window.location.href).searchParams.get("embed")}get isEmbedVideo(){return!!this.isWindowAvailable()&&"true"===new URL(window.location.href).searchParams.get("embedVideo")}get isEmbedDesktop(){return!!this.isEmbed&&"desktop"===new URL(window.location.href).searchParams.get("platform")}get isEmbedWeb(){return!!this.isEmbed&&"web"===new URL(window.location.href).searchParams.get("platform")}get isMobileWebView(){return this.webBrowser===iT.WebView}get isIOSApp(){return this.isIOSDevice&&!!this._window?.webkit?.messageHandlers?.hzMobile?.postMessage}get isIPadApp(){return this.isIPadOSDevice&&!!this._window?.webkit?.messageHandlers?.hzMobile?.postMessage}get isAndroidApp(){return!!this._window?.hzMobile?.postMessage}get isChromeOSWeb(){return this.isChromeOSDevice&&!this.isAndroidApp}get isEmbedIosWebView(){return this.isEmbed&&!!window?.webkit?.messageHandlers?.IOSBridge?.postMessage}get isEmbedAndroidWebView(){return this.isEmbed&&!!window?.AndroidBridge?.receiveMessage}get isEmbedMobileWebView(){return this.isEmbedAndroidWebView||this.isEmbedIosWebView}get maxTouchPoints(){return this._navigator.maxTouchPoints}get _window(){return"undefined"!=typeof window?window:void 0}async isBraveBrowser(){let e=this._navigator;return void 0===this._isBraveBrowser&&(this._isBraveBrowser=await e.brave?.isBrave?.()??!1),this._isBraveBrowser}_getDeviceOS(){let e=this._navigator?.userAgent??"",t=this._navigator?.maxTouchPoints??0;return/\bwindows nt\b/i.test(e)?im.Windows:/\bMacintosh\b/.test(e)?t>0?im.iPadOS:im.Mac:/\biPad\b/.test(e)?im.iPadOS:/\biPhone|iPod\b/.test(e)?im.iOS:/\bAndroid\b/.test(e)?im.Android:/\bCrOS\b/.test(e)?im.ChromeOS:/\bLinux\b/.test(e)?im.Linux:im.Unknown}_getDeviceOSVersion(){let e=iy[/\bMacintosh\b/.test(this._navigator?.userAgent??"")?im.Mac:this.deviceOs];if(e){let t=this._navigator.userAgent.match(e);if(Array.isArray(t)&&"string"==typeof t[1])return t[1].replace(/_/g,".")}return""}_getWebBrowser(){let e=this._navigator?.userAgent;return this.isAndroidApp||this.isIOSApp||this.isIPadApp?iT.WebView:/SamsungBrowser/.test(e)?iT.Samsung:/Chrome|CriOS/.test(e)&&!/Edg|OPR|Opera|OPiOS|Vivaldi|YaBrowser|Avast|VivoBrowser|GSA/.test(e)?iT.Chrome:/Firefox|FxiOS/.test(e)?iT.Firefox:/Edg[eA]?/.test(e)?iT.Edge:/Safari/.test(e)&&!/Chrome|CriOS|FxiOS|Edg|OPR|Opera|OPiOS|Vivaldi|YaBrowser|Avast|VivoBrowser|GSA/.test(e)?iT.Safari:/AppleWebKit/i.test(e)&&!/Edg|OPR|Opera|OPiOS|Vivaldi|YaBrowser|Avast|VivoBrowser|GSA/.test(e)?iT.WebKitBased:iT.Unknown}_getWebBrowserVersion(){let e=iv[this.webBrowser];if(e){let t=this._navigator.userAgent.match(e);if(Array.isArray(t)&&t.length>=2&&"string"==typeof t[1])return t[1]}return""}_parseModelFromUserAgent(e){let t=e.match(/iPhone(\d+,\d+)/);if(t)return`iPhone ${t[1]}`;let i=e.match(/iPad(\d+,\d+)/);if(i)return`iPad ${i[1]}`;let r=e.match(/SM-[A-Z]\d{3,4}[A-Z]?/);if(r)return r[0];let s=e.match(/Pixel (\d+)(?: XL| Pro)?/i);if(s)return s[0];let o=e.match(/;\s*([^;)]+(?:(?!Build\/)\S)*)/);if(o)return o[1].trim();let n=e.match(/\(([^)]+)\)/);return n?n[1].trim():e}async _getDeviceModel(){let e=await this._navigator.userAgentData?.getHighEntropyValues?.(["model"]);return e?.model??this._parseModelFromUserAgent(this._navigator?.userAgent)}_isRunningInPWAMode(){return!!new URL(document.location.href).searchParams.get("running_pwa_mode")}detectAndSetPWAStatusInStorage(){let e=sessionStorage;e&&("app-info://platform/microsoft-store"===document.referrer?e.setItem("msftPWA","true"):!e.getItem("msftPWA")&&(window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: minimal-ui)").matches||this._isRunningInPWAMode())&&e.setItem("otherPWA","true"))}_getMsftPWA(){return!!sessionStorage&&(this.detectAndSetPWAStatusInStorage(),!!sessionStorage.getItem("msftPWA"))}_getNonMsftPWA(){return!!sessionStorage&&(this.detectAndSetPWAStatusInStorage(),!!sessionStorage.getItem("otherPWA"))}_getDesktopShellApp(){return"shell-app"===this._getLocalStorageItem("externalAppType")}_getWithinExpressPWAInstallation(){return!!localStorage&&(this.detectAndSetPWAStatusInStorage(),"true"===this._getLocalStorageItem("withinExpressPWAInstall"))}_getLocalStorageItem(e){try{return localStorage?.getItem(e)||null}catch(e){return null}}constructor(e){this._navigator=e}}class iA extends EventTarget{get deviceOs(){return this.browserOSUtils.deviceOs}get deviceModel(){return this.browserOSUtils.deviceModel}get deviceOsVersion(){return this.browserOSUtils.deviceOsVersion}get webBrowser(){return this.browserOSUtils.webBrowser}get platformIsMacLike(){return this.browserOSUtils.platformIsMacLike}get isMacDevice(){return this.browserOSUtils.isMacDevice}get isAndroidDevice(){return this.browserOSUtils.isAndroidDevice}get isLinuxDevice(){return this.browserOSUtils.isLinuxDevice}get isDesktopShellApp(){return this.browserOSUtils.isDesktopShellApp}get isIOSDevice(){return this.browserOSUtils.isIOSDevice}get isIPadOSDevice(){return this.browserOSUtils.isIPadOSDevice}get webBrowserVersion(){return this.browserOSUtils.webBrowserVersion}get webBrowserInfo(){return{browser:this.webBrowser,version:this.webBrowserVersion}}get isChromeOSDevice(){return this.browserOSUtils.isChromeOSDevice}get hasCoarsePointer(){return this._coarsePointerQuery?.matches??!1}get hasFinePointer(){return this._finePointerQuery?.matches??!1}get isTouchable(){return this.hasCoarsePointer}get isDeviceTouchOnly(){return this.isTouchable&&!this.hasFinePointer}get isDeviceFinePointerOnly(){return this.hasFinePointer&&!this.isTouchable}get isChromeBrowser(){return this.browserOSUtils.isChromeBrowser}get isFirefoxBrowser(){return this.browserOSUtils.isFirefoxBrowser}get isEdgeBrowser(){return this.browserOSUtils.isEdgeBrowser}get isSafariBrowser(){return this.browserOSUtils.isSafariBrowser}get isSamsungBrowser(){return this.browserOSUtils.isSamsungBrowser}isBraveBrowser(){return this.browserOSUtils.isBraveBrowser()}get isMobileWebView(){return this.browserOSUtils.isMobileWebView}get isAndroidApp(){return this.browserOSUtils.isAndroidApp}get isIOSApp(){return this.browserOSUtils.isIOSApp}get isIPadApp(){return this.browserOSUtils.isIPadApp}get isChromeOSWeb(){return this.browserOSUtils.isChromeOSWeb}get isMsftPWA(){return this.browserOSUtils.isMsftPWA}get isNonMsftPWA(){return this.browserOSUtils.isNonMsftPWA}get PWAInstallationSource(){return this.browserOSUtils.PWAInstallationSource}get isMobileWeb(){return this.browserOSUtils.isMobileWeb}get isEmbedDesktop(){return this.browserOSUtils.isEmbedDesktop}get isEmbedWeb(){return this.browserOSUtils.isEmbedWeb}get isEmbedVideo(){return this.browserOSUtils.isEmbedVideo}get isEmbed(){return this.browserOSUtils.isEmbed}get deviceMemoryCategory(){let e=this.browserOSUtils.deviceOs;return e===im.Mac||e===im.Windows||e===im.Linux?iO.high:e===im.ChromeOS?iO.medium:iO.low}get platformType(){if(this.isIOSApp)return iS.iOSApp;if(this.isIPadApp)return iS.iPadOSApp;if(this.isAndroidApp)return iS.AndroidApp;if(this.isChromeOSWeb)return iS.ChromeOSApp;if(this.isMobileWeb)return iS.MobileWeb;else return iS.DesktopWeb}get platformTypeDetail(){if(this.isIOSApp||this.browserOSUtils.isEmbedIosWebView)return iC.iOSApp;if(this.isIPadApp)return iC.iPadOSApp;if(this.isAndroidApp||this.browserOSUtils.isEmbedAndroidWebView)return iC.AndroidApp;if(this.isDesktopShellApp)return iC.DesktopShell;if(this.isMsftPWA||this.isNonMsftPWA)return iC.DesktopPWA;else if(this.isChromeOSWeb);else if(this.isIPadOSDevice)return iC.MobileWebIPadOS;else if(this.isMobileWeb){if(this.isAndroidDevice)return iC.MobileWebAndroid;else if(this.isIOSDevice)return iC.MobileWebIOS}return iC.DesktopWeb}get isEmbedMobileWebView(){return this.browserOSUtils.isEmbedMobileWebView}get isEmbedIosWebView(){return this.browserOSUtils.isEmbedIosWebView}get isEmbedAndroidWebView(){return this.browserOSUtils.isEmbedAndroidWebView}get maxTouchPoints(){return this.browserOSUtils.maxTouchPoints}deviceOsVersionNumber(){return this.browserOSUtils.deviceOsVersionNumber()}async xmpAgentName(e,t,i,r=!1){return`${e.startsWith("Adobe ")?e:"Adobe "+e} ${t} (${this.deviceOs} ${await this.deviceOsVersionNumber()};${this.webBrowser} ${this.webBrowserVersion};${this.platformTypeDetail};sha:${i}${r?";adobe":""})`}constructor(e,t){super(),this._matchMedia=t,this._coarsePointerQuery=this._matchMedia("(any-pointer: coarse)"),this._finePointerQuery=this._matchMedia("(pointer: fine)"),this.browserOSUtils=new iR(e)}}let iw=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var iI="object"==typeof global&&global&&global.Object===Object&&global,iN="object"==typeof self&&self&&self.Object===Object&&self,ib=iI||iN||Function("return this")();let iU=function(){return ib.Date.now()};var iD=/\s/;let iL=function(e){for(var t=e.length;t--&&iD.test(e.charAt(t)););return t};var iP=/^\s+/,iM=ib.Symbol,iF=Object.prototype,ix=iF.hasOwnProperty,ik=iF.toString,iV=iM?iM.toStringTag:void 0;let iB=function(e){var t=ix.call(e,iV),i=e[iV];try{e[iV]=void 0;var r=!0}catch(e){}var s=ik.call(e);return r&&(t?e[iV]=i:delete e[iV]),s};var iG=Object.prototype.toString,iW=iM?iM.toStringTag:void 0;let iz=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":iW&&iW in Object(e)?iB(e):iG.call(e)},ij=function(e){return"symbol"==typeof e||null!=e&&"object"==typeof e&&"[object Symbol]"==iz(e)};var iH=0/0,iK=/^[-+]0x[0-9a-f]+$/i,iY=/^0b[01]+$/i,iX=/^0o[0-7]+$/i,iq=parseInt;let i$=function(e){if("number"==typeof e)return e;if(ij(e))return iH;if(iw(e)){var t,i="function"==typeof e.valueOf?e.valueOf():e;e=iw(i)?i+"":i}if("string"!=typeof e)return 0===e?e:+e;e=(t=e)?t.slice(0,iL(t)+1).replace(iP,""):t;var r=iY.test(e);return r||iX.test(e)?iq(e.slice(2),r?2:8):iK.test(e)?iH:+e};var iQ=Math.max,iJ=Math.min;let iZ=function(e,t,i){var r,s,o,n,a,l,c=0,u=!1,d=!1,h=!0;if("function"!=typeof e)throw TypeError("Expected a function");function g(t){var i=r,o=s;return r=s=void 0,c=t,n=e.apply(o,i)}function E(e){var i=e-l,r=e-c;return void 0===l||i>=t||i<0||d&&r>=o}function p(){var e,i,r,s=iU();if(E(s))return f(s);a=setTimeout(p,(e=s-l,i=s-c,r=t-e,d?iJ(r,o-i):r))}function f(e){return(a=void 0,h&&r)?g(e):(r=s=void 0,n)}function m(){var e,i=iU(),o=E(i);if(r=arguments,s=this,l=i,o){if(void 0===a)return c=e=l,a=setTimeout(p,t),u?g(e):n;if(d)return clearTimeout(a),a=setTimeout(p,t),g(l)}return void 0===a&&(a=setTimeout(p,t)),n}return t=i$(t)||0,iw(i)&&(u=!!i.leading,o=(d="maxWait"in i)?iQ(i$(i.maxWait)||0,t):o,h="trailing"in i?!!i.trailing:h),m.cancel=function(){void 0!==a&&clearTimeout(a),c=0,r=l=s=a=void 0},m.flush=function(){return void 0===a?n:f(iU())},m};function i0(){return"undefined"!=typeof window&&!!window.webkit?.messageHandlers?.hzMobile?.postMessage}function i1(){return"undefined"!=typeof window&&!!window.hzMobile?.postMessage}function i3(e){if(e===el.Browser)return i0()||i1()}let i2=/access_token=[0-9A-Za-z-._%&=]+/,i5="horizon_app_access_country",i4=k.DEVICE_NAME,i9=k.PLATFORM_TYPE,i6=k.EVENT_USER_AGENT,i7=k.EVENT_THREAD,i8=k.EVENT_ENVIRONMENT,re=k.EVENT_ENVIRONMENT_TYPE,rt=k.MOBILE_ID,ri=k.MOBILE_INSTALL_DATE,rr=k.DEVICE_HEIGHT,rs=k.DEVICE_WIDTH,ro=k.EVENT_BUILD,rn=k.EVENT_BUILD_BRANCH,ra=k.EVENT_BUNDLE_HASH,rl=k.EVENT_OVERRIDES_CONFIGURATION_HASH,rc=k.EVENT_SOURCE_CLIENT_ID,ru=k.EVENT_SOURCE_NAME,r_=k.EVENT_SOURCE_VERSION,rd=k.EVENT_MOBILE_APP_VERSION,rh=k.EVENT_NETWORK_TYPE,rg=k.CONTEXT_WEBVIEW_ROLE,rE=k.EVENT_MOBILE_BUILD_TYPE,rp=k.EVENT_REFERRER,rf=k.EVENT_URL,rm=k.EVENT_LOCALE,rT=k.DISPLAYED_LANGUAGE,rO=k.PROFILE_COUNTRY,rS=k.ACCESS_COUNTRY,rC=k.ENTITLEMENT_TYPE,rv=k.GEN_AI_TOTAL_CREDITS,ry=k.USER_COMPLIMENTARY_PREMIUM,rR=k.EVENT_SESSION_ID,rA=k.IS_NEW_USER,rw=k.USER_FIRST_ACCESS_TIME,rI=k.CUSTOM_USER_ADMIN_ROLE,rN=k.EVENT_MCID_GUID,rb=k.SESSION_RECORDING_URL,rU=k.EVENT_CONTEXT_GUID,rD=k.EVENT_USER_GUID,rL=k.EVENT_PROFILE_GUID,rP=k.USER_SERVICE_CODE,rM=k.USER_SERVICE_LEVEL,rF=k.USER_ACCOUNT_TYPE,rx=k.IS_EDU_USER,rk=k.CUSTOM_USER_ID_TYPE,rV=k.CUSTOM_USER_OFFERING,rB=k.EVENT_GUID,rG=k.EVENT_CATEGORY,rW=k.ORG_ID,rz=k.EVENT_APE_GUID,rj=k.EVENT_APE_STATUS,rH=k.EVENT_APE_DURATION,rK=k.EVENT_APE_TIME_SINCE_LAST_EVENT,rY=k.APE_START_TIME,rX=k.APE_LAST_EVENT_TIME,rq=k.CONTEXT_USER_ROLE,r$=k.CONTEXT_GUID,rQ=k.CONTENT_SCHEMA_VERSION,rJ=k.EXPERIMENTS_ASSIGNED,rZ=k.EXPERIMENTS_EXPOSED,r0=k.FEATURE_ROLLOUTS_ASSIGNED,r1=k.CUSTOM_REFERRER_APP,r3=k.CUSTOM_REFERRER_ACTION,r2=k.CUSTOM_REFERRER_ASSET_ID,r5=k.CUSTOM_REFERRER_INTENT,r4=k.CUSTOM_REFERRER_LANDING_TAB,r9=k.EVENT_SOURCE_OS_VERSION,r6=k.EVENT_SOURCE_OS_NAME,r7=k.EVENT_SOURCE_DEVICE_MODEL,r8=k.EVENT_SOURCE_BROWSER_NAME,se=k.EVENT_SOURCE_BROWSER_VERSION,st=k.EVENT_SOURCE_PLATFORM_TYPE_DETAIL,si=k.CUSTOM_FOCUS_MODE_TYPE,sr=[i6,ro,rn,ra,rl,r$,rp,rf,rm,rS,rO,rC,re,i8,rN,rb,rR,rD,rF,rA,rI,rx,rk,rV,rJ,rZ,r0,rP,rM,rc,i9,rh,rg,i4,rr,rs,r1,r3,r2,r5,r4,r6,r9,r7,r8,st,rT,rW,rz,rY,rX],ss=[r9,rt,ri];class so{async _initAccessCountry(){await this._accessCountryPromise}async _initIMSUserData(){await this._IMSUserData}async _initIMSIdData(){await this._IMSIdData}_createInitTimeout(){return new Promise((e,t)=>{this._initTimeoutId=setTimeout(()=>{e()},3e3)})}async _initDataFromBrowserService(){(await this._hostPromise).executionEnvironment()===el.Browser&&(this._browserService??(this._browserService=new iA(window.navigator,window.matchMedia.bind(window))),this._data[r6]=this._browserService.deviceOs,this._data[se]=this._browserService.webBrowserVersion,this._data[st]=this._browserService.platformTypeDetail,this._data[r8]=this._browserService.webBrowser,this._data[r7]=await this._browserService.deviceModel,this._data[r9]=await this._browserService.deviceOsVersionNumber())}reinitPlatformTypeDetailAfterPWAInstall(){this._data[st]=this._browserService.platformTypeDetail,this._broadcastUpdate([st])}async _initDeviceContext(){let e=await this._hostPromise,t=e.deviceAgent();switch(this._data[i6]=t,this._data[rh]=this._getNetworkTypeForAnalytics(e),e.executionEnvironment()){case el.Browser:{this._data[i7]="main";let e=t.match(/(iPad)|(iPhone)|(iPod)|(android)|(webOS)/i),i=t.match(/(Macintosh)/i),r=window?.navigator?.maxTouchPoints>0;e?(this._browserService??(this._browserService=new iA(window.navigator,window.matchMedia.bind(window))),this._browserService.isEmbedAndroidWebView?this._data[i9]="android":this._browserService.isEmbedIosWebView?this._data[i9]="iOS":!1===i3(el.Browser)?this._data[i9]="mobile-web":(i1()&&(this._data[i9]="android"),i0()&&(this._data[i9]="iOS"))):i&&r?this._data[i9]="mobile-web":this._data[i9]="desktop-web",this._data[i4]=this.extractDeviceName(t),window?.addEventListener("resize",this._windowResizeHandler),this._windowResizeHandlerLoaded=!0,this.extractDeviceDimensions(window);break}case el.Node:this._data[i7]="main";break;case el.Worker:this._data[i7]="worker-thread"}}_getNetworkTypeForAnalytics(e){let t=e.connection()?.effectiveType,i=e.connection()?.type;return void 0===t?F.NOT_SPECIFIED:void 0===i?t:`${t}/${i}`}async _initAppContext(){let e=await this._configPromise;this._data[ro]=`${e.includeIngestBuildPrefix?"prod"===e.envName?"prod:":"stage:":""}${e.buildInfo.sha}`,this._data[rn]=e.buildInfo.branch,this._data[ra]=e.bundleHash,this._data[rG]=e.ingestAppCategory,this._data[i8]=e.envName,this._data[re]=e.env,this._data[ru]=e.appSAPCode,this._data[r_]=e.appVersion}async _initPageContext(){if((await this._hostPromise).executionEnvironment()===el.Browser){let e=this._documentHref();this._data[rf]=e.replace(i2,""),this._data[rp]=document.referrer}}_documentHref(){return document.location.href}async _initMcidGuidContext(){let e=await this._hostPromise,t=e.deviceLanguage();this._data[rm]=t;let i=(await this._configPromise).useExperienceEdge;e.executionEnvironment()===el.Browser&&i&&(this.mcidGuid=await this._marketingTechService.mcidGuid())}_setAndResolveAccessCountry(e){e&&""!==e.trim()&&(this._data[rS]=e,this._broadcastUpdate([rS]),this._resolveAccessCountry&&this._resolveAccessCountry())}async fetchGeo2location(){return await er(async()=>{let e=await fetch("https://geo2.adobe.com/json/");if(!e.ok)throw Error(`HTTP ${e.status}: ${e.statusText}`);return await e.text()},{delay:100,progressMessagePrefix:"[AnalyticsContext:fetchGeo2location]"})()}async extractAccessCountry(){if((await this._hostPromise).executionEnvironment()===el.Browser){let e=sessionStorage.getItem(i5);if(e)this._setAndResolveAccessCountry(e);else try{let e=await this.fetchGeo2location();if(e){let t=JSON.parse(e),i=String(t.country);sessionStorage.setItem(i5,i),this._setAndResolveAccessCountry(i)}else this._setAndResolveAccessCountry("")}catch(e){console.error("Failed to get location data from geo2.adobe.com",e),this._setAndResolveAccessCountry("")}}}_initDocContext(){this._data[r$]="",this._data[rQ]="",this._data[rq]=""}async userIdInitialized(){await this._initIMSUserData()}async initialized(){this._initialized||(await this._initPromise,clearTimeout(this._initTimeoutId),this._initialized=!0)}isInitialized(){return this._initialized}shutdown(){clearTimeout(this._initTimeoutId),this._windowResizeHandlerLoaded&&window?.removeEventListener("resize",this._windowResizeHandler)}updateShellAppContext(e){e&&0!==Object.keys(e).length&&!0===i3(el.Browser)&&(this.updateFromPayload(e),this._broadcastUpdate(Object.keys(e)))}startNewApeSession(e,t){this.apeGuid=$(),this.apeStartTime=t,this.apeLastEventTime=t,e[rj]="start",e[rz]=this.apeGuid,e[rH]=0,e[rK]=0}processApeMetrics(e){let t=e?.[rj]==="active",i=new Date;if(this.apeGuid){let r=(i.getTime()-this.apeLastEventTime.getTime())/1e3;if(r<=1200){if(e[rz]=this.apeGuid,t){this.apeLastEventTime=i;let t=(i.getTime()-this.apeStartTime.getTime())/1e3;e[rK]=r,e[rH]=t}}else t?this.startNewApeSession(e,i):(this.apeGuid="",e[rz]=M)}else t?this.startNewApeSession(e,i):e[rz]=M}adornEventData(e){Object.keys(this._data).forEach(t=>{e[t]||(e[t]=this._data[t])});try{this.processApeMetrics(e)}catch(e){console.warn("Error processing APE metrics",e)}delete e[rX],delete e[rY],e[rB]=e[rB]||$(),!e[r$]&&this.currentAssetId&&(e[r$]=this.currentAssetId),e[k.EVENT_TIME_START]||(e[k.EVENT_TIME_START]=new Date().toISOString()),e[k.EVENT_COUNT]||e[k.EVENT_WORKFLOW]===F.WORKFLOW_DEBUG||(e[k.EVENT_COUNT]=1);let t=function(){if("undefined"!=typeof window&&window.FS)return window.FS("getSession",{format:"url.now"})}();t&&(e[k.SESSION_RECORDING_URL]=t)}addListener(e){this._listeners.add(e)}deleteListener(e){this._listeners.delete(e)}_callListeners(e){this._listeners.forEach(t=>{t(e)})}generateInitPayload(){let e=[...sr,...Object.values(V).filter(e=>!!this._data[e])];if(!0===i3(el.Browser)){let t=Object.values(ss).filter(e=>!!this._data[e]);e.push(...t)}return this._embedParams.length&&e.push(...this._embedParams),this._generatePayload(e)}_generatePayload(e){let t={};return e.forEach(e=>{e in this._data?t[e]=this._data[e]:t[e]=void 0}),t}_broadcastUpdate(e){this._callListeners(this._generatePayload(e))}async updateFromPayload(e){await this.initialized(),Object.keys(e).forEach(t=>{void 0===e[t]?delete this._data[t]:this._data[t]=e[t]})}addContextGUID(e){this._data[rU]=e}removeContextGUID(){delete this._data[rU]}set imsProfile(e){let t,i=e.account_type,r=[];if(this._data[rD]=String(e.userId),this._data[rF]=String(i),e.profileId&&(this._data[rL]=String(e.profileId),r.push(rL)),e.countryCode&&(this._data[rO]=String(e.countryCode),r.push(rO)),e.serviceAccounts&&(t=e.serviceAccounts.find(e=>"creative_cloud"===e.serviceCode)),this._data[rM]=t?t.serviceLevel:"",this._data[rP]=t?t.serviceCode:"",e.email){let t=e.email.toLowerCase();(t.endsWith("@adobe.com")||t.endsWith("@adobetest.com"))&&(this._data[rP]+="_adobe")}e.ownerOrg&&(this._data[rW]=e.ownerOrg,r.push(rW)),this._broadcastUpdate([rD,rF,rM,rP,...r]),this._resolveIMSUserData&&this._resolveIMSUserData()}set imsIdData(e){let t=e.client_id||"no-client-id";this._data[rc]=t,this._broadcastUpdate([rc]),this._resolveIMSIdData&&this._resolveIMSIdData()}set pageURL(e){this._data[rf]=e.replace(i2,""),this._broadcastUpdate([rf])}get isInternalUser(){return String(this._data[rP]).endsWith("_adobe")}set accessCountry(e){this._setAndResolveAccessCountry(e)}get accessCountry(){return this._data[rS]}set threadName(e){this._data[i7]=e}get threadName(){return this._data[i7]}get deviceName(){return this._data[i9]}set mcidGuid(e){this._data[rN]=e,this._broadcastUpdate([rN])}get mcidGuid(){return this._data[rN]}set apeGuid(e){this._data[rz]=e,this._broadcastUpdate([rz])}get apeGuid(){return this._data[rz]}set apeStartTime(e){this._data[rY]=e.toISOString(),this._broadcastUpdate([rY])}get apeStartTime(){return new Date(this._data[rY])}set apeLastEventTime(e){this._data[rX]=e.toISOString(),this._broadcastUpdate([rX])}get apeLastEventTime(){return new Date(this._data[rX])}set expressEntitlementType(e){this._data[rC]=e,this._broadcastUpdate([rC])}get expressEntitlementType(){return this._data[rC]}set genAITotalCredits(e){this._data[rv]=String(e),this._broadcastUpdate([rv])}get genAITotalCredits(){return Number(this._data[rv])}set userComplimentaryPremium(e){this._data[ry]=e,this._broadcastUpdate([ry])}get userComplimentaryPremium(){return this._data[ry]}set sessionRecordingUrl(e){this._data[rb]=e,this._broadcastUpdate([rb])}get sessionRecordingUrl(){return this._data[rb]}set sessionId(e){this._data[rR]=e,this._broadcastUpdate([rR])}get sessionId(){return this._data[rR]}get newUserStatus(){return this._data[rA]}get userFirstAccessTime(){return this._data[rw]}set newUserStatus(e){this._data[rA]=e,this._broadcastUpdate([rA])}set userFirstAccessTime(e){this._data[rw]=e,this._broadcastUpdate([rw])}get customUserAdminRole(){return this._data[rI]}set customUserAdminRole(e){this._data[rI]=e,this._broadcastUpdate([rI])}get eduUserStatus(){return this._data[rx]}set eduUserStatus(e){this._data[rx]=e,this._broadcastUpdate([rx])}get eduUserIdTypeStatus(){return this._data[rk]}set eduUserIdTypeStatus(e){this._data[rk]=e,this._broadcastUpdate([rk])}get userOffering(){return this._data[rV]}set userOffering(e){this._data[rV]=e,this._broadcastUpdate([rV])}get displayedLanguage(){return this._data[rT]}set displayedLanguage(e){this._data[rT]=e,this._broadcastUpdate([rT])}set userHasEditRights(e){e?this._data[rq]="editor":this._data[rq]="viewer",this._broadcastUpdate([rq])}set currentAssetId(e){this._data[r$]=e,this._broadcastUpdate([r$])}async setEmbedContextAndParams(e){this._embedParams=Object.keys(e),await this.updateFromPayload(e),this._broadcastUpdate(Object.keys(e))}async setFocusMode(e){await this.initialized(),e?this._data[si]=e:delete this._data[si],this._broadcastUpdate([si])}set currentDocumentVersion(e){this._data[rQ]=e,this._broadcastUpdate([rQ])}async experimentsMetadata(){return this._loadExperimentsDeferred.promise}async featureRolloutsMetadata(){return this._loadFeatureRolloutsDeferred.promise}set assignedExperiments(e){""!==e&&this._loadExperimentsDeferred.resolve(e),this._data[rJ]=e,this._broadcastUpdate([rJ])}set exposedExperiments(e){this._data[rZ]=e,this._broadcastUpdate([rZ])}set featureRollouts(e){this._loadFeatureRolloutsDeferred.resolve(e),this._data[r0]=e,this._broadcastUpdate([r0])}get exposedExperiments(){return this._data[rZ]}set assignedOverridesConfigurationHash(e){this._data[rl]=e,this._broadcastUpdate([rl])}extractDeviceDimensions(e){let t=e?.outerHeight,i=e?.outerWidth;this._data[rr]&&0===t||(this._data[rr]=String(t),this._data[rs]=String(i),this._broadcastUpdate([rr,rs]))}extractDeviceName(e){let t=e.match("\\(([^)]+)\\)");return t?t[1]:e}get osVersion(){return this._data[r9]}get appVersion(){return this._data[r_]}get appName(){return this._data[ru]}get userId(){return this._data[rD]}get mobileAppVersion(){return this._data[rd]}addCampaignProperties(e){if(e&&Object.keys(e).length>0)for(let t in e)this._data[t]=e[t]}get customReferrerApp(){return this._data[r1]}get customCampaingReferrerApp(){return this._data[V.MV2]}get customCampaignSDID(){return this._data[V.SDID]}get customReferrerIntent(){return this._data[r5]}set mobileBuildType(e){this._data[rE]=e}get mobileBuildType(){return this._data[rE]}set referrerAction(e){this._data[r3]=e,this._setItemInSessionStorage(r3,e)}_extractAndSetReferrerAction(){let e=this._getItemFromSessionStorage(r3);e&&(this._data[r3]=e)}_setItemInSessionStorage(e,t){"undefined"!=typeof sessionStorage&&sessionStorage.setItem(e,t)}_getItemFromSessionStorage(e){return"undefined"==typeof sessionStorage?null:sessionStorage.getItem(e)}constructor(e,t,i,r){this._initTimeoutId=0,this._embedParams=[],this._initAttributesPromises=[],this._loadExperimentsDeferred=new tx,this._loadFeatureRolloutsDeferred=new tx,this._accessCountryPromise=new Promise((e,t)=>{this._resolveAccessCountry=()=>{this._resolveAccessCountry=void 0,e()}}),this._IMSUserData=new Promise((e,t)=>{this._resolveIMSUserData=()=>{this._resolveIMSUserData=void 0,e()}}),this._IMSIdData=new Promise((e,t)=>{this._resolveIMSIdData=()=>{this._resolveIMSIdData=void 0,e()}}),this._windowResizeHandler=iZ(()=>this.extractDeviceDimensions(window),1e3),this._windowResizeHandlerLoaded=!1,this._initialized=!1,this._data={},this._listeners=new Set,this._hostPromise=e,this._configPromise=i,this._marketingTechService=r,this._data[rR]=t,this.assignedExperiments="",this.exposedExperiments="",this.assignedOverridesConfigurationHash="",this._initAttributesPromises=[this._hostPromise,this._configPromise,this._initDeviceContext(),this._initMcidGuidContext(),this._initAppContext(),this._initPageContext(),this._initAccessCountry(),this._initIMSUserData(),this._initDataFromBrowserService(),this._initIMSIdData()];let s=this._createInitTimeout(),o=Promise.allSettled(this._initAttributesPromises);this._initPromise=Promise.race([o,s]),this._initDocContext(),this.extractAccessCountry(),this._extractAndSetReferrerAction()}}let sn=new tG("env"),sa=new tG("envName"),sl=new tG("ingestApiKey"),sc=new tV("aaTrackingServer","stats.adobe.com"),su=new tV("aaSecureTrackingServer","sstats.adobe.com"),s_=new tV("bundleHash",""),sd=new tV("ingestAppCategory","WEB"),sh=new tG("appVersion"),sg=new tG("appSAPCode"),sE=new tG("ingestProject"),sp=new tB("ingestHost","https://cc-api-data-stage.adobe.io",{prod:"https://cc-api-data.adobe.io"}),sf=new tB("ingestHostAlwaysProd","https://cc-api-data.adobe.io",{}),sm=new it("ingest-host-always-prod-enabled",!1),sT=new tV("ingestProcessingInterval",3e3),sO=new tV("analyticsBufferLimit",500),sS=new it("use-experience-edge",!1),sC=new it("enable-aep-analytics",!1),sv=new it("enableAnalytics",!0),sy=new tB("launchUrl","https://assets.adobedtm.com/d4d114c60e50/a0e989131fd5/launch-2c94beadc94f-development.js",{stage:"https://assets.adobedtm.com/d4d114c60e50/a0e989131fd5/launch-5dd5dd2177e6.js",prod:"https://assets.adobedtm.com/d4d114c60e50/a0e989131fd5/launch-5dd5dd2177e6.min.js"}),sR=new tB("marketingTechUrl","https://www.adobe.com/marketingtech/main.standard.qa.js",{stage:"https://www.adobe.com/marketingtech/main.standard.js",prod:"https://www.adobe.com/marketingtech/main.standard.min.js"}),sA=new tB("experience-edge-config-id","2a892ed7-c50f-4acf-8726-d41bd770ddbd",{prod:"28baacdc-56e1-4191-a72d-2b4086448495"}),sw=new it("include-ingest-build-prefix",!0),sI=new tB("otDomainId","7a5eb705-95ed-4cc4-a11d-0cc5760e93db-test",{prod:"7a5eb705-95ed-4cc4-a11d-0cc5760e93db"}),sN=new tB("privacyUrl","https://www.stage.adobe.com/etc.clientlibs/globalnav/clientlibs/base/privacy-standalone.js",{local:"https://www.stage.adobe.com/etc.clientlibs/globalnav/clientlibs/base/privacy-standalone.js",prod:"https://www.adobe.com/etc.clientlibs/globalnav/clientlibs/base/privacy-standalone.js"}),sb=new tV("footerLinkSelector",""),sU={env:sn,envName:sa,enableAnalytics:sv,ingestAPIKey:sl,ingestAppCategory:sd,appVersion:sh,appSAPCode:sg,ingestProject:sE,ingestHost:sp,ingestHostAlwaysProd:sf,ingestHostAlwaysProdEnabled:sm,aaTrackingServer:sc,aaSecureTrackingServer:su,bundleHash:s_,ingestProcessingInterval:sT,analyticsBufferLimit:sO,aepConfigId:sA,useExperienceEdge:sS,enableAEPAnalytics:sC,includeIngestBuildPrefix:sw,otDomainId:sI,privacyURL:sN,footerLinkSelector:sb,ingestWaitForAppStartup:new it("ingest-wait-for-app-startup",!0),sendPreConsentEvent:new it("send-pre-consent-event",!0),launchURL:sy,marketingTechURL:sR},sD=["adobePrivacy:PrivacyConsent","adobePrivacy:PrivacyCustom","adobePrivacy:PrivacyReject"],sL="PrivacyServiceError: Failed to load";class sP{addConsentChangeListener(e,t){this.load().then(()=>{if(i3(el.Browser))return Promise.resolve();if(this._host.executionEnvironment()===el.Browser){if(this._browserService??(this._browserService=new iA(window.navigator,window.matchMedia.bind(window))),this._browserService.isEmbedDesktop)return Promise.resolve();this._addPrivacyListener(e),e()}}).catch(e=>{console.error(e),t([{[k.EVENT_WORKFLOW]:"Debug",[k.EVENT_SUBTYPE]:"log",[k.EVENT_TYPE]:"failure",error:e}])})}_addPrivacyListener(e,t=!1){let i=t?()=>{e(),sD.forEach(e=>{window.removeEventListener(e,i)})}:e;sD.forEach(e=>{window.addEventListener(e,i)})}_registerLoadListeners(){this._addPrivacyListener(this._onLoadHandler.bind(this),!0)}_registerConfigs(){let{otDomainId:e,footerLinkSelector:t,documentLanguage:i}=this._config,r={otDomainId:e};t&&(r.footerLinkSelector=t),i&&(r.documentLanguage=i),window.fedsConfig=window.fedsConfig||{privacy:r}}async _loadPrivacy(){if(this._host.executionEnvironment()===el.Browser){this._registerConfigs(),this._registerLoadListeners();let e=document.createElement("script");e.src=this._config.privacyUrl,e.async=!0,e.addEventListener("error",()=>{this._loadPromise?.isSettled||this._loadPromise?.reject(sL)}),document.head.appendChild(e)}else{this._loadPromise?.isSettled||this._loadPromise?.resolve();return}}async load(){return this._loadPromise?this._loadPromise.promise:(this._loadPromise=new tx,i3(el.Browser)||(await this._hostConfigPromises,this._host.executionEnvironment()===el.Browser&&(this._browserService??(this._browserService=new iA(window.navigator,window.matchMedia.bind(window))),this._browserService.isEmbedDesktop||this._browserService.isEmbedVideo)))?this._loadPromise?.promise:(this._loadPrivacy().catch(()=>{this._loadPromise?.isSettled||this._loadPromise?.reject(sL)}),this._loadPromise?.promise)}resolvePrivacyLoadInNativeAppShell(){this._loadPromise?.resolve()}rejectLoadPromise(){this._loadPromise?.reject(sL)}constructor(e,t){this._onLoadHandler=()=>{this._loadPromise?.isSettled||(window.adobePrivacy?this._loadPromise?.resolve():this._loadPromise?.reject("PrivacyServiceError: window.adobePrivacy API is not available after load event."))},this._hostConfigPromises=Promise.all([e,t]).then(([e,t])=>{this._config=t,this._host=e})}}class sM{static get defaultInstance(){if(sM._defaultInstance)return sM._defaultInstance;let e=id.singleton(),t=e.attach(sU).then(()=>({useExperienceEdge:sU.useExperienceEdge.isEnabled(),enableAEPAnalytics:sU.enableAEPAnalytics.isEnabled(),aepConfigId:sU.aepConfigId.value,launchURL:sU.launchURL.value,marketingTechURL:sU.marketingTechURL.value}));return sM._defaultInstance=new sM(e.getHost(),t),sM._defaultInstance}static _resetInstance(){sM._defaultInstance=void 0}async _initialized(){try{if(await this._initPromise,this._useExperienceEdge&&this._host.executionEnvironment()===el.Browser){window.alloy_load={data:{},...window.alloy_load},window.alloy_all={data:{_adobe_corpnew:{digitalData:{page:{pageInfo:{}}}}},...window.alloy_all};let e=this._config.launchURL,t=this._config.aepConfigId;window.marketingtech={adobe:{launch:{url:e,controlPageLoad:!0},alloy:{edgeConfigId:t},target:!1,audienceManager:!1,sophia:!1,marketingTags:{disableGlobalTags:!1,disableContentsquare:!0}}};try{let e=document.createElement("script");e.textContent='!function(){"use strict";var e=window,t=document,n=Object.defineProperty,a="replace",o=function(e){return e=e[a](/%2523access_token%253D.*?%2526/gim,"%2526")[a](/%23access_token%3D.*?%26/gim,"%26")[a](/#access_token=.*?&/gim,"&")[a](/information=[^&]+/,"")[a](/puser=[^&]+/,"")[a](/fnuser=[^&]+/,"")[a](/lnuser=[^&]+/,"")};function i(){try{var e="referrer",a=t[e],i=o(a);i!==a&&n(t,e,{configurable:!0,value:i})}catch(e){}}var r=t.head,l=e.marketingtech,c=decodeURIComponent;function d(e){var n,a,o,i;for(a=0,o=(n=t.cookie?t.cookie.split("; "):[]).length;a<o;a++)if(i=n[a],c(i.substr(0,i.indexOf("=")))===e)return c(i.substr(i.indexOf("=")+1))}function s(){var n,a,o,i="alloy-prehiding",c="@keyframes alloyShow{from {opacity: 0.01;} to {opacity: 1;}}body,.personalization-container{opacity:0.01 !important;animation: 0s 3s forwards alloyShow}",s=3e3;if(t.getElementById("feds-script")&&(i="manual-prehiding"),a=t.getElementById(i),o=function(e){try{e&&e.parentNode&&e.parentNode.removeChild(e)}catch(e){}},!(r&&l&&l.adobe&&l.adobe.target)||e.targetGlobalSettings&&!e.targetGlobalSettings.bodyHidingEnabled||-1!==e.location.href.indexOf("mboxEdit")||-1!==e.location.search.indexOf("mboxDisable=1")||-1!==e.location.search.indexOf("adobe_authoring_enabled")||-1!==t.cookie.indexOf("adobe_optout")||d("OptanonChoice")&&(n=d("OptanonConsent"))&&-1!==n.indexOf("C0002:0"))o(a);else{if(!a){(a=t.createElement("style")).id=i,a.innerHTML=c;try{r.appendChild(a)}catch(e){}}setTimeout((function(){o(a)}),s)}}const f="9E1005A551ED61CA0A490D45@AdobeOrg";function u(){e.alloy_getIdentity=new Promise((function(t){let n,a,o,i,r;if(n=new URLSearchParams(e.location.search).get("adobe_mc"))try{if(a=n.split("|").reduce(((e,t)=>{const[n,a]=t.split("=");return e[n]=a,e}),{}),o=parseInt(a.TS,10),i=a.MCMID,r=decodeURIComponent(a.MCORGID),i&&r===f&&Date.now()/1e3<=o+300)return t({edge:{},identity:{ECID:i}})}catch(e){}if(n=d("AMCV_"+f)){a=n.split("|");for(let e=0,n=a.length;e<n;e++){if("MCMID"===a[e])return t({edge:{},identity:{ECID:a[e+1]}})}}let l=function(){e.removeEventListener("alloy_sendEvent",l),e.alloy("getIdentity").then(t)};e.addEventListener("alloy_sendEvent",l)}))}function p(){return e.alloy_events=e.alloy_events||[]}var y=function(e,t){for(var n=t.split("."),a=e,o=0,i=n.length-1;o<i;o++){var r=n[o];if(!a[r])return;a=a[r]}return a[n[o]]},h=function(e,t,n){for(var a=t.split("."),o=e,i=0,r=a.length-1;i<r;i++){var l=a[i];o[l]=o[l]||{},o=o[l]}return o[a[i]]=n,e};function m(){var t=e.alloy_all=e.alloy_all||{};return t.promises=t.promises||[],t.xdm=t.xdm||{},t.data=t.data||{},t.get=function(e){return y(t,e)},t.set=function(e,n){return h(t,e,n)},t}var g=Promise;function _(){var t=e.alloy_load=e.alloy_load||{};return t.i=!1,t.sent=new g((function(e,n){t.r=e,t.j=n})),t.promises=t.promises||[],t.xdm=t.xdm||{},t.data=t.data||{},t.get=function(e){return y(t,e)},t.set=function(e,n){return h(t,e,n)},t}function v(){var t=e.alloy_unload=e.alloy_unload||{};return t.i=!1,t.sent=new g((function(e,n){t.r=e,t.j=n})),t.xdm=t.xdm||{},t.data=t.data||{},t.get=function(e){return y(t,e)},t.set=function(e,n){return h(t,e,n)},t}function b(){u(),p(),m(),_(),v()}function C(e){throw Error(e)}function x(e,n){var a=t.createElement("script"),o=!1;a.src=e,a.async=!0,n&&(a.onload=a.onreadystatechange=function(e){var t=this.readyState;o||t&&"complete"!==t&&"loaded"!==t||(o=!0,n(e))}),r?r.appendChild(a):t.body?t.body.appendChild(a):C("no script parent")}function k(){var t,n,a,o,i,r,c,d=[];t=function(t){o?t(e._satellite):d.push(t)},n=new g((function(e){t(e)})),e.__satelliteLoadedCallback=t,e.__satelliteLoadedPromise=n,a=function(){var t,n,a;for(o=!0,t=0,n=d.length;t<n;t++){a=d[t];try{a(e._satellite)}catch(e){}}},l&&(i=l.adobe)&&(r=i.launch)&&(c=r.url)&&x(c,a)}function D(){var t=[];e._satellite=e._satellite||{},e._satellite.track=function(e,n){(n=n||{})._beforeSatelliteLoaded=!0,t.push([e,n])},e.__satelliteLoadedCallback((function(){var n,a,o;for(n=0,a=t.length;n<a;n++)o=t[n],e._satellite.track(o[0],o[1])})),_satellite.track("pageView")}function E(){var t={_set:function(t,n){0!==t.indexOf("digitalData")&&(t="digitalData."+t),"object"!=typeof n&&"function"!=typeof n||!n.then||"function"!=typeof n.then||(n=n.unresolved||void 0),h(e.alloy_all,"data._adobe_corpnew."+t,n)}};e.digitalData=e.digitalData||t}-1===e.location.search.indexOf("marketingtech=off")&&(i(),s(),b(),k(),D(),E()),e.alloy_all&&e.alloy_all.set("data.marketingtech.bootstrap.version","0.28.1")}();',e.onerror=e=>{this._loadPromise?.reject(e),console.error("Failed to execute MarketingTech script",e)},document.head.appendChild(e),setTimeout(()=>{this._loadPromise?.resolve(),console.log("MarketingTech loaded successfully")},100)}catch(e){this._loadPromise?.reject(e),console.error("Failed to create or execute MarketingTech script",e)}}else this._loadPromise?.isSettled||this._loadPromise?.resolve();this._isInitialized=!0}catch(e){this._loadPromise?.isSettled||this._loadPromise?.reject(e),console.error("Failed to initialized marketingTech",e)}return this._loadPromise?.promise}_generatePayload(e){return{eventType:"web.webinteraction.linkClicks",xdm:{web:{webPageDetails:{isErrorPage:!1,isHomePage:!1,name:window.location.host,server:window.location.href,siteSection:window.location.href},webReferrer:{URL:e[k.EVENT_REFERRER]||""},webInteraction:{name:e[k.EVENT_PAGENAME]||"",linkClicks:{value:1},type:"other"}}},data:{_adobe_corpnew:{digitalData:{},sdm:this._unflatten(e)},marketingtech:{adobe:{alloy:{approach:"optimized",edgeConfigId:this._config.aepConfigId}}}}}}_setProp(e,t,i){let r=t.indexOf("."),s=t.substring(0,r),o=t.substring(r+1);e[s]=e[s]||{};let n=e[s];o.includes(".")?this._setProp(n,o,i):n[o]=i}_unflatten(e){let t={};for(let i of Object.keys(e))i!==k.APP_CONFIG_OVERRIDES&&(i.includes(".")?this._setProp(t,i,e[i]):t[i]=e[i]);return t}_sendEvent(e){try{if(!this._useExperienceEdge||!this._enableAEPAnalytics)return;window._satellite.track("event",e)}catch(e){console.warn("MarketingTechService encountered an unexpected error sending events to AEP",e)}}sendEvent(e){let t=this._generatePayload(e);if(!this._isInitialized)return void this._initialized().then(()=>{this._sendEvent(t)});this._sendEvent(t)}async mcidGuid(){if(this._isInitialized||await this._initialized(),!this._useExperienceEdge)return"";try{let e=await window.alloy_getIdentity;return e.identity?.ECID??W}catch(e){return console.warn("Could not get ECID. Mostly adBlocker is blocking calls to AEP",e),W}}trackProposition(e,t){let i=()=>{"undefined"!=typeof window&&window._satellite&&window._satellite?.track(e,t)};if(!this._isInitialized)return void this._initialized().then(i);i()}constructor(e,t){this.sendEvent=this.sendEvent.bind(this),this.mcidGuid=this.mcidGuid.bind(this),this._isInitialized=!1,this._useExperienceEdge=!1,this._enableAEPAnalytics=!1,this._loadPromise=new tx,this._initPromise=Promise.all([e,t,t.then(e=>e.useExperienceEdge),t.then(e=>e.enableAEPAnalytics)]).then(([e,t,i,r])=>{this._host=e,this._config=t,this._useExperienceEdge=i,this._enableAEPAnalytics=r})}}let sF={maxAttempts:3,shouldRetry:e=>!(e instanceof tb)||!1!==e.retryable,delay:500},sx={eventName:k.EVENT_PAGENAME,type:k.EVENT_TYPE,subType:k.EVENT_SUBTYPE,workflow:k.EVENT_WORKFLOW,subCategory:k.EVENT_SUBCATEGORY},sk=new Set(Object.values(k)),sV=class{trigger(e){if(!this._analyticsClient)throw Error("AnalyticsEvent instance without AnalyticsClient detected. Please register the event with AnalyticsClient.");let t={};for(let[e,i]of Object.entries(sx))t[i]=this._spec[e];if(e){let i,r;x.TIME_START in e&&(i=new Date(e[x.TIME_START]),e[k.EVENT_TIME_START]=i.toISOString(),delete e[x.TIME_START]),x.TIME_END in e&&(r=new Date(e[x.TIME_END]),e[k.EVENT_TIME_END]=r.toISOString(),delete e[x.TIME_END]),i&&r&&(e[k.EVENT_VALUE]=r.getTime()-i.getTime());let s=e[x.IS_FAILURE];for(let i of(void 0!==s&&(s&&(e[k.EVENT_TYPE]="error"),delete e[x.IS_FAILURE]),Object.keys(e)))sk.has(i)||0===i.indexOf("custom.")||console.warn("Unrecognized AnalyticsPropertyName",{invalidName:i}),t[i]=e[i]}this._analyticsClient._sendEvent(t)}set name(e){this._spec.eventName=e}get name(){return`${this._spec.eventName}`}get type(){return this._spec.type}get subType(){return this._spec.subType}set client(e){this._analyticsClient=e}get client(){return this._analyticsClient}set contextGuid(e){if(!K(e))throw Error("Invalid UUID for contextGuid");this._eventMetaData=this._eventMetaData||{contextGuid:""},this._eventMetaData.contextGuid=e}constructor(e,t){this._spec=e,t&&(this._analyticsClient=t,this._analyticsClient._registerEvent(this))}},sB=class e extends iE{static get defaultInstance(){if(!e._defaultInstance){let t=id.singleton(),i=t.attach(sU),r=sM.defaultInstance,s=i.then(()=>({otDomainId:sU.otDomainId.value,privacyUrl:sU.privacyURL.value})),o=new sP(t.getHost(),s),n=i.then(()=>({env:sU.env.value,envName:sU.envName.value,includeIngestBuildPrefix:sU.includeIngestBuildPrefix.enabled,appSAPCode:sU.appSAPCode.value,appVersion:sU.appVersion.value,ingestAppCategory:sU.ingestAppCategory.value,aaTrackingServer:sU.aaTrackingServer.value,aaSecureTrackingServer:sU.aaSecureTrackingServer.value,buildInfo:t.buildInfo,bundleHash:sU.bundleHash.value,useExperienceEdge:sU.useExperienceEdge.enabled,aepConfigId:sU.aepConfigId.value,launchURL:sU.launchURL.value,marketingTechURL:sU.marketingTechURL.value})),a=new so(t.getHost(),t.sessionId,n,r),l=i.then(()=>({ingestProcessingInterval:sU.ingestProcessingInterval.value,analyticsBufferLimit:sU.analyticsBufferLimit.value,ingestConfig:{ingestApiKey:sU.ingestAPIKey.value,ingestAppCategory:sU.ingestAppCategory.value,ingestProject:sU.ingestProject.value,envName:sU.ingestHostAlwaysProdEnabled.enabled?F.ENVIRONMENT_PROD:sU.envName.value,ingestHost:sU.ingestHostAlwaysProdEnabled.enabled?sU.ingestHostAlwaysProd.value:sU.ingestHost.value,token:"",ingestWaitForAppStartup:sU.ingestWaitForAppStartup.enabled}})),c=new ip(t.getHost(),l,t=>e._defaultInstance._updateNetworkState(t)),u=tU.createInstance(t.getHost(),l.then(e=>e.ingestConfig));e._defaultInstance=new e(t,c,a,r,o,u);let d=e._defaultInstance,h=d._setUserConsentCb(),g=d._sendDataToIngestCb();d._privacyService.addConsentChangeListener(h,g),d._setExecutionEnvironment(),i.then(()=>{if(d.setAnalyticsFlag(sU.enableAnalytics.enabled),sU.sendPreConsentEvent.enabled){let e=["/preload","/edit-image-preload"],t=async()=>{!("object"==typeof window.location&&e.includes(window?.location?.pathname?.toLowerCase()??""))&&await d._waitForConsentSystemModalWithTimeout()&&d.userConsent===G.UNINITIALIZED&&d.trigger(sG,{})};d._executionEnvironment===el.Browser&&"undefined"!=typeof document&&"undefined"!=typeof window&&t()}})}return e._defaultInstance}async shutdown(e=!0,t=600){let i=this._eventDataTransport.shutdown(e);if(e)await i;else{let e=new Promise(e=>setTimeout(e,t));await Promise.race([i,e])}this.context?.shutdown()}get appConfig(){return this._appConfig}get context(){return this._analyticsContext}get transport(){return this._eventDataTransport}trigger(e,t){this._registerEvent(e),e.client=this,e.trigger(t)}_processOrQueueEvent(e){if(e[k.EVENT_PAGENAME]===sG.name)return void this._processAnalyticsEvents([e],!1,!0);this.userConsent===G.ALLOWED&&this._processAnalyticsEvents([e]),this.userConsent===G.UNINITIALIZED&&this._eventQueue.queueEventData(e)}_sendEvent(e){if(!1===this._enableAnalytics||this.userConsent===G.DENIED)return;let t=e[k.EVENT_PAGENAME];this._addToEventsHistory(t,e),this._analyticsContext.isInitialized()?(this._analyticsContext.adornEventData(e),this._processOrQueueEvent(e)):this._analyticsContext.initialized().then(()=>{this._analyticsContext.adornEventData(e),this._processOrQueueEvent(e)})}async _setExecutionEnvironment(){let e=id.singleton();await e.attach(sU);let t=await e.getHost();this._executionEnvironment=t.executionEnvironment()}async _eventQueueDeliveryFunction(e){this._enableAnalytics&&this.userConsent===G.ALLOWED&&await this._processAnalyticsEvents(e,!0)}async _sendToDunamis(e){let t=er(this._ingestService.sendEventData,sF);await t(e).catch(e=>{console.warn("Analytics encountered an unexpected error while sending data to Ingest: ",e)})}async _processAnalyticsEvents(e,t=!1,i=!1){!0===t?await this._sendToDunamis(e):this._sendToDunamis(e),i||e.forEach(e=>{switch(this._executionEnvironment){case el.Worker:postMessage({type:F.PAYLOAD_FROM_WORKER,payload:e});break;case el.Browser:this.notifyListeners(e),this._marketingTechService.sendEvent(e);break;default:console.log(`The execution environment ${this._executionEnvironment} does not support callbacks.`)}})}notifyListeners(e){this._callListeners(e)}_registerEvent(e){this._events[e.name]=e}addEventListener(e){this._listeners.add(e)}removeEventListener(e){this._listeners.delete(e)}_callListeners(e){this._listeners.forEach(t=>{try{t(e)}catch(e){console.warn("Error occurred while calling Analytics event listener: ",e)}})}setAnalyticsFlag(e){this._enableAnalytics=e}addConsentListener(e){this._consentListeners.add(e),this._broadcastUserConsentUpdate()}deleteConsentListener(e){this._consentListeners.delete(e)}addNonCrossThreadConsentListener(e){this._consentListeners.add(e)}ensureUserConsentIsAvailable(){return this._privacyService.load()}get privacyServiceInstance(){return this._privacyService}_parseCookieGroup(){return this._executionEnvironment===el.Browser&&(window?.adobePrivacy?.activeCookieGroups()||[]).includes("C0002")?G.ALLOWED:G.DENIED}_waitForConsentSystemModalWithTimeout(){return new Promise(e=>{let t=setInterval(()=>{let e=window?.adobePrivacy?.activeCookieGroups()?.includes("C0001")??!1,t="undefined"!=typeof document?document.getElementById("onetrust-banner-sdk"):null,i=!1;if(t){let e="undefined"!=typeof window&&"function"==typeof window.getComputedStyle?window.getComputedStyle(t):null;i="none"!==(e?.display??t.style?.display??"")}e&&i&&r(!0)},100),i=setTimeout(()=>{r(!1)},1e4);function r(r){clearInterval(t),clearTimeout(i),e(r)}})}_updateUserConsentCb(){this.userConsent=this._parseCookieGroup()}_broadcastUserConsentUpdate(){if(0===this._consentListeners.size||this._userConsentFromCookies===G.UNINITIALIZED)return;let e={userConsent:this._userConsentFromCookies};this._consentListeners.forEach(t=>{t(e)})}set userConsent(e){this._userConsentFromCookies=e,this._userConsentFromCookies===G.ALLOWED&&(this._eventQueueShutdownPromise=this._eventQueue?.shutdown()),this._broadcastUserConsentUpdate()}get userConsent(){return this._userConsentFromCookies}set crashLogsConsent(e){this._crashLogsConsent=e}get crashLogsConsent(){return this._crashLogsConsent}_sendDataToIngestCb(){return this._ingestService.sendEventData.bind(this)}_setUserConsentCb(){return this._updateUserConsentCb.bind(this)}_addToEventsHistory(e,t){if(this._eventsHistory.size>=this._maxEventHistorySize){let e=this._eventsHistory.keys().next().value;e&&this._eventsHistory.delete(e)}this._eventsHistory.set(e,t)}getEventDataFromHistory(e){return this._eventsHistory.get(e)}constructor(e,t,i,r,s,o){super(),this._appConfig=e,this._analyticsContext=i,this._eventDataTransport=t,this._marketingTechService=r,this._privacyService=s,this._events={},this._listeners=new Set,this._consentListeners=new Set,this._executionEnvironment=el.Browser,this._enableAnalytics=!0,this._userConsentFromCookies=G.UNINITIALIZED,this._crashLogsConsent=!1,this._ingestService=o,this._eventQueue=new ih(this._eventQueueDeliveryFunction.bind(this)),this._eventQueue.maxQueueLength=20,this._eventQueue.batchSize=10,this._eventsHistory=new Map,this._maxEventHistorySize=20}},sG=new sV({eventName:"preconsent-app-load",workflow:"lifecycle",subCategory:"operations",type:"load",subType:"app-page"});async function sW(e){if((await e.appConfig.getHost()).executionEnvironment()!==el.Browser)return{};let t=null;if("undefined"!=typeof window&&window.location?.href){let e=window.location.href.match(/(\d+)\.prenv\./);e&&(t=`${e[1]}-prenv`)}let i=e.appConfig.whichEnginesEnabled();if(!i.experimentation&&!i.personalization)return{};let r=[];if(i.experimentation){let t=e.context.experimentsMetadata(),[i,s]=sz(),o=Promise.race([t,s]).then(e=>(clearTimeout(i),e)).catch(()=>"");r.push(o)}else r.push(Promise.resolve(""));if(i.personalization){let t=e.context.featureRolloutsMetadata(),[i,s]=sz(),o=Promise.race([t,s]).then(e=>(clearTimeout(i),e)).catch(()=>"");r.push(o)}else r.push(Promise.resolve(""));let s=await Promise.all(r),o={};o.experiments=s[0],o.featureRollouts=s[1],t&&(o.environment=t),o.hasCohortData=o.experiments.length>0||o.featureRollouts.length>0;let n=void 0!==globalThis.window?new URLSearchParams(window?.location.search):new URLSearchParams;if(n.get("traceparent")){let e=n.get("testId"),t=n.get("suiteId");e&&(o.testId=e),t&&(o.suiteId=t)}return o}function sz(){let e,t=new Promise((t,i)=>{e=setTimeout(()=>{i(Error("Timed out after 5000ms"))},5e3)});return[e,t]}var sj=function(e){return e[e.traceflow=1]="traceflow",e[e.debug=2]="debug",e[e.info=3]="info",e[e.warn=4]="warn",e[e.error=5]="error",e[e.none=6]="none",e}(sj||{});let sH="global",sK={debug:"debug",info:"info",error:"failure",warn:"failure",traceflow:"debug"};var sY=function(e){return e[e.EVENT_TYPE=k.EVENT_TYPE]="EVENT_TYPE",e[e.EVENT_SUBTYPE=k.EVENT_SUBTYPE]="EVENT_SUBTYPE",e[e.EVENT_SUBCATEGORY=k.EVENT_SUBCATEGORY]="EVENT_SUBCATEGORY",e[e.EVENT_WORKFLOW=k.EVENT_WORKFLOW]="EVENT_WORKFLOW",e[e.TRACEFLOW_CATEGORY=k.LOG_TRACEFLOW_CATEGORY]="TRACEFLOW_CATEGORY",e[e.TRACE_ID=k.LOG_TRACE_ID]="TRACE_ID",e[e.SPAN_ID=k.LOG_SPAN_ID]="SPAN_ID",e[e.LOG_MESSAGE=k.LOG_MESSAGE]="LOG_MESSAGE",e[e.LOG_LEVEL=k.LOG_LEVEL]="LOG_LEVEL",e[e.METADATA=k.LOG_METADATA]="METADATA",e[e.ERROR_UUID=k.ERROR_UUID]="ERROR_UUID",e[e.ERROR_MESSAGE=k.ERROR_MESSAGE]="ERROR_MESSAGE",e[e.ERROR_CODE=k.ERROR_CODE]="ERROR_CODE",e[e.ERROR_FULL_STACK=k.ERROR_FULL_STACK]="ERROR_FULL_STACK",e[e.ERROR_FULL_MESSAGE_WITH_CODE=k.ERROR_FULL_MESSAGE_WITH_CODE]="ERROR_FULL_MESSAGE_WITH_CODE",e[e.ERROR_CATEGORY=k.ERROR_CATEGORY]="ERROR_CATEGORY",e[e.ERROR_IS_EXPECTED=k.ERROR_IS_EXPECTED]="ERROR_IS_EXPECTED",e[e.ERROR_LOG_METADATA=k.ERROR_LOG_METADATA]="ERROR_LOG_METADATA",e[e.ERROR_CLIENT_FATAL=k.ERROR_CLIENT_FATAL]="ERROR_CLIENT_FATAL",e.UNDEFINED_MESSAGE_STACK="custom.undefinedMessageStack",e}(sY||{});let sX=function(){},sq=class e{set traceflowOverrides(e){this._traceflowOverrides=e,this._categoryLoggers.forEach(t=>{t._traceflowOverrides=e,t._initLogLevelsFromConfig()})}get traceflowOverrides(){return this._traceflowOverrides}static _captureConsole(){e._originalConsoles[1]=console.debug,e._originalConsoles[2]=console.debug,e._originalConsoles[3]=console.info,e._originalConsoles[4]=console.warn,e._originalConsoles[5]=console.error}static hijackConsole(t){e._singleton._consoleHijacked&&e._restoreConsole(),console.info("Logger taking over console"),t._consoleHijacked=!0,console.debug=(...e)=>t.debug(...e),console.log=(...e)=>t.info(...e),console.info=(...e)=>t.info(...e),console.warn=(...e)=>t.warn(...e),console.error=(...e)=>t.error(...e)}static _restoreConsole(){e._singleton._consoleHijacked&&(console.debug=e._originalConsoles[2],console.info=e._originalConsoles[3],console.warn=e._originalConsoles[4],console.error=e._originalConsoles[5],console.log=e._originalConsoles[1],e._singleton._consoleHijacked=!1)}static singleton(){return!e._singleton&&(e._singleton=new e(sB.defaultInstance),e._singleton._destroySingleton=()=>{e._restoreConsole(),delete e._singleton},e._captureConsole(),e.HijackConsole&&e.hijackConsole(e._singleton)),e._singleton}get _sendProcessedLogsToConsole(){return!!this._rawFeatures["processed-logs-to-console"]}get _suppressLogsToIngest(){return!!this._rawFeatures["suppress-logs-to-ingest"]}async _initFromConfig(e){let t=await e.getSettings(),i=await e.getFeatures();this._initFromConfigSync(i,t),this._categoryLoggers.forEach(e=>{e._initFromConfigSync(this._rawFeatures,this._rawSettings)})}_initFromConfigSync(e,t){this._rawFeatures=e,this._rawSettings=t,this._initLogLevelsFromConfig()}_initLogLevelsFromConfig(){let e=this._rawSettings;if(e.enabledLogLevel&&(this._enabledLogLevel=sj[e.enabledLogLevel]),e.consoleLogLevel&&(this._consoleLogLevel=sj[e.consoleLogLevel]),this._category){let e=`consoleLogLevel-${this._category}`,t=this._rawSettings[e];void 0!==t&&(this._consoleLogLevel=sj[t]),e=`enabledLogLevel-${this._category}`,void 0!==(t=this._rawSettings[e])&&(this._enabledLogLevel=sj[t]),this._isTraceflowFeatureEnabled(this._category)&&(this._enabledLogLevel=1),this._isTraceflowConsoleFeatureEnabled(this._category)&&(this._consoleLogLevel=1)}this._initialized=!0}async shutdown(t=!0){await this._analyticsClient.shutdown(t),e.singleton()._destroySingleton()}async initialized(){return this._initializedPromise}async _doneBuffering(){return this._doneBufferingPromise}getBuffer(){return this._logBuffer}get enabledLogLevel(){return this._enabledLogLevel}get consoleLogLevel(){return this._consoleLogLevel}get category(){return this._category}getFeaturesAndSettingsProvider(){return{getSettings:async()=>(await this.initialized(),this._rawSettings),getFeatures:async()=>(await this.initialized(),this._rawFeatures)}}static get(t){return e.singleton().get(t)}get(e){if(this._category===e)return this;let t=this._categoryLoggers.get(e);return t||(t=this.createCategoryLogger(e),this._categoryLoggers.set(e,t)),t}createCategoryLogger(t){return new e(this._analyticsClient,this,t)}createRequestLogger(e){return new sQ(this._analyticsClient,e,this)}async createInitializeRequestLogger(e){let t=new sQ(this._analyticsClient,e,this);return await t.initialized(),t}_isErrorMeta(e){return"error"in e}_extractErrorMeta(e){return this._isErrorMeta(e)?e.error:null}_processArgs(e,t){let i,r,s=t[0];"string"!=typeof s&&(t.length>1&&"string"==typeof t[1]?(s=t[1],t[1]=t[0],t[0]=s):(s=this._getMessageFromUnknownObject(t[0]),t.unshift(s)));let o=null;if(2===t.length)(r=t[1])instanceof et||r instanceof Error?(o=r,i={}):null!==r&&"object"==typeof r?(o=this._extractErrorMeta(r),i=J(r)):i={unknown:J(r)};else if(t.length>2){i=[];for(let e=1;e<t.length;e++)r=t[e],null===o&&r instanceof Error?o=r:i.push(J(r))}else i={};if("undefined-message"===s&&(i["custom.undefinedMessageStack"]=Error("Undefined message stack").stack),this._hasKnownMetaKeys(i)?this._normalizeMetaKeys(i):i={[sY.METADATA]:i},o)if(o instanceof et){i[sY.ERROR_UUID]=o.uuid,i[sY.ERROR_MESSAGE]=o.message,i[sY.ERROR_CODE]=o.code,i[sY.ERROR_FULL_STACK]=o.fullStack.replace(/[\s]{2,}/g," "),i[sY.ERROR_FULL_MESSAGE_WITH_CODE]=o.fullMessageWithCode,o.category&&(i[sY.ERROR_CATEGORY]=o.category),o.isExpected&&(i[sY.ERROR_IS_EXPECTED]=o.isExpected);let e=o.fullLogMetadata;e&&(i[sY.ERROR_LOG_METADATA]=J(e))}else{i[sY.ERROR_MESSAGE]=o.toString();let e=o.stack||"Unknown";i[sY.ERROR_FULL_STACK]=e.replace(/[\s]{2,}/g," ")}return{level:sj[e],msg:s,meta:i}}_getMessageFromUnknownObject(e){if(null==e)return"undefined-message";if(e instanceof Error)return e.message;let t=Z(e);if(!t)try{return e.toString()}catch(e){return"_getMessageFromUnknownObject: toString failed"}return t.substring(0,1e3)}_hasKnownMetaKeys(e){let t;if(e&&"object"==typeof e){for(let i of Object.keys(e))if((t=i.indexOf("."))>0&&i.substr(0,t)in B)return!0}return!1}_normalizeMetaKeys(e){let t;for(let[i,r]of Object.entries(e))(t=i.indexOf("."))<0?(e["custom."+i]=r,delete e[i]):i.substr(0,t)in B||(e["custom."+i]=r,delete e[i])}error(...e){this._logWithLevel("error",e)}static error(...t){e.singleton().error(...t)}warn(...e){this._logWithLevel("warn",e)}static warn(...t){e.singleton().warn(...t)}info(...e){this._logWithLevel("info",e)}_logWithLevel(e,t){try{let i=sj[e];if(this._shouldMirrorToConsole(i)){let r=t;this._category&&(r=["traceflow"===e?`[TRACEFLOW: ${this._category}]`:`[${this._category}]`,...t]),this._mirrorOriginalConsole(i,r)}if(this._initialized&&!this._shouldSendLog(i))return;let r=this._processArgs(e,t);this._filteredPush(r)}catch(i){console.error(`Logger.${e}(): An error was thrown while logging`,i,...t)}}static info(...t){e.singleton().info(...t)}debug(...e){this._logWithLevel("debug",e)}static debug(...t){e.singleton().debug(...t)}traceflow(e,...t){if(this._category!==e)return void this.get(e).trace(...t);this.trace(...t)}trace(...e){if(!this._category)return void this.get(sH).trace(...e);this._logWithLevel("traceflow",e)}static traceflow(t,...i){e.singleton().traceflow(t,...i)}_isTraceflowCategoryEnabled(e){return this._traceflowOverrides?.[e]!==void 0?this._traceflowOverrides[e]:!!this._rawFeatures[e]}_isTraceflowFeatureEnabled(e){return this._isTraceflowCategoryEnabled("traceflow-all")||this._isTraceflowCategoryEnabled(`traceflow-${e}`)}_isTraceflowConsoleFeatureEnabled(e){return this._isTraceflowFeatureEnabled("console-all")||this._isTraceflowFeatureEnabled(`console-${e}`)}isTraceflowEnabled(e){let t=e||this._category;return void 0!==t&&this.get(t).enabledLogLevel<=1}isTraceflowConsoleEnabled(e){let t=e||this._category;return void 0!==t&&this.get(t).consoleLogLevel<=1}static isTraceflowEnabled(t){return e.singleton().isTraceflowEnabled(t)}_adornWithContext(e){let t=tw.trace.getSpanContext(tw.context.active());t&&tm(t)&&(e.meta[sY.TRACE_ID]=t.traceId,e.meta[sY.SPAN_ID]=t.spanId),e.meta[sY.EVENT_TYPE]=sK[sj[e.level]],e.meta[sY.EVENT_SUBTYPE]="log",e.meta[sY.EVENT_WORKFLOW]=F.WORKFLOW_DEBUG,e.meta[sY.EVENT_SUBCATEGORY]=this._category||sH}_mirrorOriginalConsole(t,i){if(this._initialized)e._originalConsoles[t].apply(console,i);else try{let r=JSON.stringify(i);e._originalConsoles[t].apply(console,[r])}catch(e){console.error("Failed to stringify args",i)}}_echoProcessedLogToConsole(t){let i=t;try{1===i.level&&((i={...t}).level=3);let r=JSON.stringify(i);e._originalConsoles[2].apply(console,[r])}catch(e){console.error("Failed to stringify logEntry",i)}}_shouldSendLog(e){return this._enabledLogLevel<=e}_shouldMirrorToConsole(e){return this._consoleLogLevel<=e}_filteredPush(e){if(this._shouldBuffer){this._adornWithContext(e),this._logBuffer.push(e);return}this._shouldSendLog(e.level)&&(this._adornWithContext(e),this._category&&1===e.level&&(e.meta["custom.traceflow"]=this._category),this._pushMetric(e),this._pushLog(e))}_adornLogEventWithContext(e){this._analyticsClient.context.adornEventData(e.meta)}async _pushMetric(e){if(5!==e.level)return;let{appName:t,attributes:i}=function(e){let t=e.getOtelServiceName()?.replaceAll("-","_")||"unknown_app",i=e._environment||"local",r=e.buildInfo?.sha??"unknown";return"local"===i&&(r="local"),{appName:t,attributes:{buildSha:r}}}(this._analyticsClient.appConfig);i.category=this._category;let r=await sW(this._analyticsClient);r.hasCohortData&&Object.assign(i,r),tw.metrics.getMeter(`${t}_logger_init`).createCounter(`hz_${t}_logger_error_count`).add(1,i),i.expected=!0===e.meta[sY.ERROR_IS_EXPECTED]&&e.meta[sY.ERROR_IS_EXPECTED],!0===e.meta[sY.ERROR_CLIENT_FATAL]&&tw.metrics.getMeter(`${t}_logger_init`).createCounter(`hz_${t}_fatal_crash_error_count`).add(1,i)}_pushLog(e){if(e.meta[sY.LOG_MESSAGE]=e.msg,e.meta[sY.LOG_LEVEL]=sj[e.level],this._adornLogEventWithContext(e),this._sendProcessedLogsToConsole&&this._echoProcessedLogToConsole(e),this._suppressLogsToIngest)return;let t=!!e?.meta[sY.ERROR_CLIENT_FATAL];t&&this._analyticsClient.userConsent!==G.ALLOWED&&(delete e.meta["event.mcid_guid"],delete e.meta["event.user_guid"]),(t||this._analyticsClient.userConsent===G.ALLOWED)&&this._analyticsClient.transport.queueEventData(e.meta)}constructor(e,t,i){this._category=void 0,this._logBuffer=[],this._shouldBuffer=!0,this._rawFeatures={},this._rawSettings={},this._categoryLoggers=new Map,this._consoleHijacked=!1,this._initialized=!1,this._analyticsClient=e,this._category=i,this._consoleLogLevel=3,this._enabledLogLevel=3,t?(this._traceflowOverrides=t._traceflowOverrides,t._initialized?(this._initFromConfigSync(t._rawFeatures,t._rawSettings),this._initializedPromise=Promise.resolve()):this._initializedPromise=this._initFromConfig(t.getFeaturesAndSettingsProvider())):this._initializedPromise=this._initFromConfig(this._analyticsClient.appConfig);let r=Promise.resolve();e.userConsent===G.UNINITIALIZED&&(r=this._analyticsClient.ensureUserConsentIsAvailable()),this._doneBufferingPromise=Promise.all([this._initializedPromise,r]).then(()=>{for(let e of(this._shouldBuffer=!1,this._logBuffer))this._filteredPush(e);this._logBuffer=[]}).catch(e=>{this._shouldBuffer=!1,this._logBuffer=[],console.error("Logger: initialization failed. One or more promises rejected",e)})}};sq._originalConsoles={6:sX,1:sX,2:sX,3:sX,4:sX,5:sX},sq.HijackConsole=!1;let s$={sessionId:k.EVENT_SESSION_ID,requestId:"custom.requestId",statusCode:"custom.statusCode",url:"custom.url",method:"custom.method",referrer:k.EVENT_REFERRER,startTime:k.EVENT_TIME_START,userId:k.EVENT_USER_GUID,traceId:"custom.traceId"},sQ=class e extends sq{createCategoryLogger(t){return new e(this._analyticsClient,this.requestContext,this,t)}_adornLogEventWithContext(e){for(let[t,i]of(this._analyticsClient.context.adornEventData(e.meta),Object.entries(this.requestContext)))s$[t]?e.meta[s$[t]]=i:e.meta[t]=i}_mirrorOriginalConsole(e,t){let i=[this.requestContext].concat(t);return super._mirrorOriginalConsole(e,i)}constructor(e,t,i,r){super(e,i,r),this.requestContext=t}};class sJ{get isResourceObserverEnabled(){return this._isResourceObserverEnabled}startObserving(e){if(this._isResourceObserverEnabled){if(null!==this._observer)return void sq.warn("ResourceObserver: Performance observer already started");this._observer=new PerformanceObserver(t=>{let i=t.getEntries();this._performanceObserverHandler(i),e?.(i)}),this._observer.observe({type:"resource",buffered:!0})}}stopObserving(){this._isResourceObserverEnabled&&(this._observer?.disconnect(),this._observer=null,this._storageInfoList.clear(),this._timingInfoList.clear())}getStorageInfoList(e){if(!e)return this._storageInfoList;let t=new Map;for(let[i,r]of this._timingInfoList)r.startTime>=e.startTime&&r.endTime<=e.endTime&&t.set(i,this._storageInfoList.get(i));return t}getTimingInfoList(){return this._timingInfoList}_performanceObserverHandler(e){e.forEach(e=>{this._shouldDiscardEntry(e.name)||(this._storageInfoList.set(e.name,{transferSize:e.transferSize,decodedBodySize:e.decodedBodySize,encodedBodySize:e.encodedBodySize}),this._timingInfoList.set(e.name,{startTime:performance.timeOrigin+e.startTime,endTime:performance.timeOrigin+e.startTime+e.duration}))})}_shouldDiscardEntry(e){let t=new URL(e);return!(t.origin===this._origin&&t.pathname.startsWith("/static/"))||!this._inclusionList.some(e=>t.pathname.endsWith(e))}_isMobileWebView(){if("undefined"==typeof navigator)return!1;let e=navigator.userAgent,t=/Android.*wv\)|WebView|; wv\)|Android.*Chrome.*Mobile/.test(e),i=/iPhone|iPad|iPod/.test(e)&&!/Safari/.test(e),r=/AdobeExpress|ProjectX/.test(e);return t||i||r}constructor(){this._inclusionList=["js","json","wasm","data"],this._origin=self.location.origin,this._observer=null,this._storageInfoList=new Map,this._timingInfoList=new Map,this._isResourceObserverEnabled=!1,this._isResourceObserverEnabled=!this._isMobileWebView()}}let sZ={TRANSFER_SIZE:"X-SW-Transfer-Size",DECODED_SIZE:"X-SW-Decoded-Size",ENCODED_SIZE:"X-SW-Encoded-Size"};class s0{get shouldAddPlugin(){return this._resourceObserver.isResourceObserverEnabled}startObserving(){this._resourceObserver.startObserving(e=>this._resourceObserverCallback(e))}stopObserving(){this._resourceObserver.stopObserving()}get storageInfoList(){return this._storageInfoList}async cacheWillUpdate({request:e,response:t}){let i=this._resourceObserver.getStorageInfoList().get(e.url);return i?this._putStorageInfoIntoHeaders(i,t):new Promise(t=>{let i=setTimeout(()=>this._timeoutFallback(e.url,t),2e3);this._pendingEntriesToStorageInfoMap.set(e.url,{resolve:t,timeout:i})}).then(e=>null!==e?this._putStorageInfoIntoHeaders(e,t):t)}async cachedResponseWillBeUsed({request:e,cachedResponse:t}){if(!t)return t;let i=this._getStorageInfoFromHeaders(e.url,t);return i&&this._storageInfoList.set(e.url,i),t}_getStorageInfoFromHeaders(e,t){let i=t.headers.get(sZ.TRANSFER_SIZE),r=t.headers.get(sZ.DECODED_SIZE),s=t.headers.get(sZ.ENCODED_SIZE);if(null!==i&&null!==r&&null!==s)return{transferSize:0,decodedBodySize:parseInt(r),encodedBodySize:parseInt(s)}}_putStorageInfoIntoHeaders(e,t){let i=this._convertStorageInfoToHeaders(e),r=new Headers(t.headers);return Object.entries(i).forEach(([e,t])=>{r.set(e,t)}),new Response(t.body,{status:t.status,statusText:t.statusText,headers:r})}_convertStorageInfoToHeaders(e){return{[sZ.TRANSFER_SIZE]:e.transferSize.toString(),[sZ.DECODED_SIZE]:e.decodedBodySize.toString(),[sZ.ENCODED_SIZE]:e.encodedBodySize.toString()}}constructor(){this._storageInfoList=new Map,this._pendingEntriesToStorageInfoMap=new Map,this._resourceObserverCallback=e=>{e.forEach(({name:e,transferSize:t,decodedBodySize:i,encodedBodySize:r})=>{let s=this._pendingEntriesToStorageInfoMap.get(e);s&&(clearTimeout(s.timeout),s.resolve({transferSize:t,decodedBodySize:i,encodedBodySize:r}),this._pendingEntriesToStorageInfoMap.delete(e))})},this._timeoutFallback=(e,t)=>{this._pendingEntriesToStorageInfoMap.has(e)&&(this._pendingEntriesToStorageInfoMap.delete(e),console.warn(`ServiceWorkerResourceCollector: cacheWillUpdate: Timeout waiting for resource observer for url: ${e}`),t(null))},this._resourceObserver=new sJ}}async function s1(e){console.debug("service-worker.js: SW Install event fired."),self.skipWaiting()}function s3(e){console.debug("service-worker.js: SW Activate event fired."),self.clients.claim();let t=setInterval(()=>{"activated"===self.serviceWorker.state?(console.debug("service-worker.js: Checking for SW update."),self.registration.update().then(()=>{self.registration.installing?console.debug("service-worker.js: SW update found! Installing new SW."):console.debug("service-worker.js: No SW update found.")}).catch(e=>{console.warn("service-worker.js: Update check failed with error: ",e)})):t&&(console.debug("service-worker.js no longer active."),clearInterval(t))},36e5);if(!self.resourceCollector)return void console.error("service-worker.js: _handleActivate: Object of ServiceWorkerResourceCollector not found");console.debug("service-worker.js: stopping performance observer"),self.resourceCollector?.stopObserving()}let s2=[401,403,407];async function s5(e,t){let i=await fetch(e);if(s2.indexOf(i.status)>-1){console.warn("service-worker.js: Authentication failure detected: ",e.url,i.status);let r=i.clone(),s="";try{s=await r.text()}catch(e){console.warn("service-worker.js: Failed to read response body:",e),s="Failed to read response body"}self.clients.get(t).then(t=>{t?.postMessage({msg:"AUTHENTICATION_FAILURE",url:e.url,status:i.status,message:s})})}return i}function s4(e){(function({method:e,url:t}){let i=new URL(t),r=i.pathname.endsWith(".js"),s=i.origin===self.location.origin&&i.pathname.startsWith("/static/");return"GET"===e&&!r&&!s&&!P.some(e=>i.hostname.match(e))})(e.request)&&e.respondWith(s5(e.request,e.clientId))}function s9(e){if(e.data&&e.data.msg===L.RESOURCE_INFO_REQUEST){if(!self.resourceCollector)return void console.error("service-worker.js: _handleMessage: Object of ServiceWorkerResourceCollector not found");if(!e.source)return void console.error("service-worker.js: _handleMessage: Source of event not found");e.source.postMessage({msg:L.RESOURCE_INFO_REPLY,storageInfoList:self.resourceCollector.storageInfoList,requestId:e.data.requestId})}}!function(e){var t,i,o;e.additionalScripts?.forEach(e=>{self.importScripts(e)}),t={prefix:e.cacheKey},l.updateDetails(t),self.addEventListener("activate",()=>self.clients.claim()),self.addEventListener("activate",e=>{let t=l.getPrecacheName();e.waitUntil(b(t).then(e=>{}))}),self.resourceCollector||(self.resourceCollector=new s0,self.resourceCollector.startObserving(),console.debug("service-worker.js: started resource observer")),self.resourceCollector?.shouldAddPlugin&&(i=[self.resourceCollector],v().strategy.plugins.push(...i)),o=function(e){let t=new URL(self.location.href).searchParams.get("cdnPath"),i=e.manifest??[];if(t){let e=new URL(t).origin;i.forEach(t=>{"string"!=typeof t&&(t.url=e+"/"+t.url)})}return i}(e),v().precache(o),function(e,t,i){let o;if("string"==typeof e){let t=new URL(e,location.href);o=new R(({url:e})=>e.href===t.href,void 0,void 0)}else if(e instanceof RegExp)o=new A(e,void 0,void 0);else if("function"==typeof e)o=new R(e,t,i);else if(e instanceof R)o=e;else throw new s("unsupported-route-type",{moduleName:"workbox-routing",funcName:"registerRoute",paramName:"capture"});(!r&&((r=new w).addFetchListener(),r.addCacheListener()),r).registerRoute(o)}(new I(v(),void 0)),self.addEventListener("install",s1),self.addEventListener("activate",s3),self.addEventListener("fetch",s4),self.addEventListener("message",s9),console.debug("service-worker.js loaded.")}({...{cacheKey:"qa-standalone-webapp"},manifest:[{'revision':null,'url':'/static/AIDE.e5b2641fa3ec2670.wasm'},{'revision':null,'url':'/static/MediaInfoModule.23ce215fc860db19.wasm'},{'revision':null,'url':'/static/chimera.5564f8232c347d06.data'},{'revision':null,'url':'/static/chimera.f1a87767774d9b86.wasm'},{'revision':null,'url':'/static/chimera_webgpu.5564f8232c347d06.data'},{'revision':null,'url':'/static/chimera_webgpu.742e97a55a64ecfb.wasm'},{'revision':null,'url':'/static/compiled-app-config.88a4e19033b38d4f.js'},{'revision':null,'url':'/static/embed-logged-out-welcome-modal.31e84568a371f8c9.js'},{'revision':null,'url':'/static/hz-authoring-actions-canvas-export.a8d3a649886876ab.js'},{'revision':null,'url':'/static/hz-authoring-actions-page-margins.7e477846d7285fea.js'},{'revision':null,'url':'/static/hz-authoring-actions-tus.4115033967329390.js'},{'revision':null,'url':'/static/hz-authoring-agc-importer.12dcf4a292acc318.js'},{'revision':null,'url':'/static/hz-authoring-tus-refresh-utils.7ef924d9ba73f6ad.js'},{'revision':null,'url':'/static/hz-authoring-tus-resource-utils.e59bc75a0e4b0616.js'},{'revision':null,'url':'/static/hz-authoring-video-exporter.56840e732d3ee1f4.js'},{'revision':null,'url':'/static/hz-community-report-custom-elements.f4631fd655f44a97.js'},{'revision':null,'url':'/static/hz-gen-image-models-selector.87ca1a35a649c8bd.js'},{'revision':null,'url':'/static/hz-localization-hz-language-switcher.58e2308e56d9c78f.js'},{'revision':null,'url':'/static/hz-logged-out-gen-ai-susi-modal.e52654d591b76dd4.js'},{'revision':null,'url':'/static/hz-neural-shape-ui.dd0e475cae9f0d0f.js'},{'revision':null,'url':'/static/hz-neural-text-ui.3cad6414eb5ba606.js'},{'revision':null,'url':'/static/hz-online-local-document-actions.edbc79018a4a58c8.js'},{'revision':null,'url':'/static/hz-refine-cutout-ui-v2-desktop-panel.6a8c9592aa3bb440.js'},{'revision':null,'url':'/static/hz-refine-cutout-ui-v2-mobile-brush-setting.deb990c7ea3830b5.js'},{'revision':null,'url':'/static/hz-refine-cutout-ui-v2-mobile-erase-control-panel.5f61cccdd252f67e.js'},{'revision':null,'url':'/static/hz-refine-cutout-v2-cutout-section.ee492a689df38a13.js'},{'revision':null,'url':'/static/hz-refine-cutout-v2-erase-paywall-dialog.ed832e869b8c6a20.js'},{'revision':null,'url':'/static/hz-shared-icons-x-icon-arrow-down.71426b960f18fc6e.js'},{'revision':null,'url':'/static/hz-shared-icons-x-icon-arrow-left.49e2a3c15db95596.js'},{'revision':null,'url':'/static/hz-shared-icons-x-icon-arrow-right.7703de78b1854f9f.js'},{'revision':null,'url':'/static/hz-shared-icons-x-icon-arrow-up.9d5a2b726f86cccb.js'},{'revision':null,'url':'/static/hz-shared-icons-x-icon-flip-horizontal.305403a4426b7f5d.js'},{'revision':null,'url':'/static/hz-shared-icons-x-icon-flip-vertical.06321013c2d88190.js'},{'revision':null,'url':'/static/hz-shared-icons-x-icon-icon-nudge.1caa58c294b05f67.js'},{'revision':null,'url':'/static/hz-shared-icons-x-icon-rotate-cc-w.207b9d3772930945.js'},{'revision':null,'url':'/static/hz-shared-icons-x-icon-scale.ba34df8caf95a8a1.js'},{'revision':null,'url':'/static/hz-shared-icons-x-icon-transform.2765cbf1041b212b.js'},{'revision':null,'url':'/static/hz-startup-debug-handlers.cec8fdbe87edc3e4.js'},{'revision':null,'url':'/static/hz-startup-otel.00d3a30c71096258.js'},{'revision':null,'url':'/static/hz-startup-pathkit.04e76a86ebe2c8a3.js'},{'revision':null,'url':'/static/hz-startup-renderer-chimera-index-webgl.ef429d69742b2f0d.js'},{'revision':null,'url':'/static/hz-startup-renderer-chimera.38fef1bd7cce8234.js'},{'revision':null,'url':'/static/hz-startup-renderer-main.7761ae922b7c5137.js'},{'revision':null,'url':'/static/hz-startup-renderer-on-ui.828e95e6fb9a6f1b.js'},{'revision':null,'url':'/static/hz-startup-text-zce.059c90380979f203.js'},{'revision':null,'url':'/static/hz-theme-components.3a29d2500b072e21.js'},{'revision':null,'url':'/static/index.236ce01d8bdcefd6.js'},{'revision':null,'url':'/static/noether_side_module.33dfa722cf27f76a.wasm'},{'revision':null,'url':'/static/pathkit.c02a000a581f09e3.wasm'},{'revision':null,'url':'/static/pollux.944d558b2091e8a6.wasm'},{'revision':null,'url':'/static/qa-card-maker-authoring-bricks.15be05781940a069.js'},{'revision':null,'url':'/static/qa-card-maker-ui-startup-brick-registry.649637e516888e63.js'},{'revision':null,'url':'/static/qa-edit-image-application.358859f4356a7347.js'},{'revision':null,'url':'/static/qa-edit-image-authoring.16a3fb5e9142a6c8.js'},{'revision':null,'url':'/static/qa-edit-image-editor.da514705d6bc6906.js'},{'revision':null,'url':'/static/qa-edit-image-embedUI.678ce6ab8752141c.js'},{'revision':null,'url':'/static/qa-edit-image-onDemand_hz_adjustments_v2_feature_brick.ca0c7fdc5b8c0004.js'},{'revision':null,'url':'/static/qa-edit-image-onDemand_hz_appearance_section_v2_implementation_brick.599bfeee33a2fbde.js'},{'revision':null,'url':'/static/qa-edit-image-onDemand_hz_embed_welcome_modal_host_brick.83522073e66151a8.js'},{'revision':null,'url':'/static/qa-edit-image-onDemand_hz_neural_gen_fill_ui_registration_brick.ef4e5eec49acdc86.js'},{'revision':null,'url':'/static/qa-edit-image-onDemand_hz_refine_cutout_v2_implementation_brick.ed68cee4b8966f62.js'},{'revision':null,'url':'/static/qa-edit-image-onDemand_hz_welcome_modal_integration_brick.245cab9dbc33d714.js'},{'revision':null,'url':'/static/qa-edit-image-onDemand_hz_x_image_section_v2_feature_brick.9150a1bef9a26e33.js'},{'revision':null,'url':'/static/qa-edit-image-ui-startup-brick-registry.32afedfb43c06795.js'},{'revision':null,'url':'/static/qa-launch-edit-image.e5eeab3b003db2f5.js'},{'revision':null,'url':'/static/qa-qaStartup.5a559f6e1ed2d116.js'},{'revision':null,'url':'/static/qa-startup-app-component.0a750ddf017ba261.js'},{'revision':null,'url':'/static/qa-startup-authoring-main.1aed814dbca1918a.js'},{'revision':null,'url':'/static/qa-startup-initialization.94fd23fdc136d6f9.js'},{'revision':null,'url':'/static/qa-startup-shared.b514ee6e1b579a67.js'},{'revision':null,'url':'/static/qa-startup-ui-editor-main.f8496702f64a6d44.js'},{'revision':null,'url':'/static/qa-uiPostStartup.2791a74a645e12ec.js'},{'revision':null,'url':'/static/qa-uiStartup.e6d4a770ce2f58bf.js'},{'revision':null,'url':'/static/quick-actions-card-maker-authoring-worker.a5d3fdf0227cd0dd.js'},{'revision':null,'url':'/static/quick-actions-edit-image-authoring-worker.328be58aefb0319c.js'},{'revision':null,'url':'/static/schema-provider-startup-worker.d853c0c63341aded.js'},{'revision':null,'url':'/static/text.55edd5eba8be1c50.wasm'},{'revision':null,'url':'/static/text.9d1f30f137d2ffc1.data'},{'revision':null,'url':'/static/text_zce.6b16a46f9f651812.wasm'},{'revision':null,'url':'/static/text_zce.9d1f30f137d2ffc1.data'},{'revision':null,'url':'/static/vendor-authoring-animation.14921cdd238ac2fc.js'},{'revision':null,'url':'/static/vendor-authoring-common.a62c6de605ec8f70.js'},{'revision':null,'url':'/static/vendor-babylonjs.35928c0ebf33d4be.js'},{'revision':null,'url':'/static/vendor-common-animation.05c9ea58a1e93d4f.js'},{'revision':null,'url':'/static/vendor-coretech-scenegraph.be2bda752e059830.js'},{'revision':null,'url':'/static/vendor-exifr.c67cb0f871f93044.js'},{'revision':null,'url':'/static/vendor-neural.3f5c2054f0c349b9.js'},{'revision':null,'url':'/static/vendor-startup-dcx.d31d0dd4b85ef572.js'},{'revision':null,'url':'/static/vendor-startup-ims.117b677395bccd50.js'},{'revision':null,'url':'/static/vendor-startup-lodash.1bd619fbf8a0f538.js'},{'revision':null,'url':'/static/vendor-startup-spectrum-web-components.630bd6d2c3958784.js'},{'revision':null,'url':'/static/vendor-startup-ui.8a1113d5fb923f4c.js'},{'revision':null,'url':'/static/vendor-startup-uuid.702a99758a2f6adf.js'},{'revision':null,'url':'/static/vendor-walnut-types.e9dc77ceb048e2a3.js'},{'revision':null,'url':'/static/x-editor-wasms.3ce839a923dee24d.js'},{'revision':null,'url':'/static/x-fill-background-section.ca9e2d21a28b968e.js'},{'revision':null,'url':'/static/x-icon-corner-radius-single.5594ff2078076c9c.js'},{'revision':null,'url':'/static/x-icon-transparency.595373d5603b7694.js'},{'revision':null,'url':'/static/x-icons-x-icon-effects.6ce64e14fcc0802a.js'},{'revision':null,'url':'/static/x-startup-editor-text-foundation.c12f20ad5a29ce51.js'},{'revision':null,'url':'/static/x-susi-sentry.a61571259265f58e.js'}]})})()})();
//# sourceMappingURL=service-worker.js.map